(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendors~ecff2e3d"],{

/***/ "aWZo":
/*!***************************************************************************!*\
  !*** ./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js ***!
  \***************************************************************************/
/*! exports provided: TaskQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TaskQueue\", function() { return TaskQueue; });\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"xIXs\");\n\n\nconst stackSeparator = '\\nEnqueued in TaskQueue by:\\n';\nconst microStackSeparator = '\\nEnqueued in MicroTaskQueue by:\\n';\n\nfunction makeRequestFlushFromMutationObserver(flush) {\n  let observer = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"DOM\"].createMutationObserver(flush);\n  let val = 'a';\n  let node = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"DOM\"].createTextNode('a');\n  let values = Object.create(null);\n  values.a = 'b';\n  values.b = 'a';\n  observer.observe(node, { characterData: true });\n  return function requestFlush() {\n    node.data = val = values[val];\n  };\n}\n\nfunction makeRequestFlushFromTimer(flush) {\n  return function requestFlush() {\n    let timeoutHandle = setTimeout(handleFlushTimer, 0);\n\n    let intervalHandle = setInterval(handleFlushTimer, 50);\n    function handleFlushTimer() {\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      flush();\n    }\n  };\n}\n\nfunction onError(error, task, longStacks) {\n  if (longStacks && task.stack && typeof error === 'object' && error !== null) {\n    error.stack = filterFlushStack(error.stack) + task.stack;\n  }\n\n  if ('onError' in task) {\n    task.onError(error);\n  } else {\n    setTimeout(() => {\n      throw error;\n    }, 0);\n  }\n}\n\nlet TaskQueue = class TaskQueue {\n  constructor() {\n    this.flushing = false;\n    this.longStacks = false;\n\n    this.microTaskQueue = [];\n    this.microTaskQueueCapacity = 1024;\n    this.taskQueue = [];\n\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"FEATURE\"].mutationObserver) {\n      this.requestFlushMicroTaskQueue = makeRequestFlushFromMutationObserver(() => this.flushMicroTaskQueue());\n    } else {\n      this.requestFlushMicroTaskQueue = makeRequestFlushFromTimer(() => this.flushMicroTaskQueue());\n    }\n\n    this.requestFlushTaskQueue = makeRequestFlushFromTimer(() => this.flushTaskQueue());\n  }\n\n  _flushQueue(queue, capacity) {\n    let index = 0;\n    let task;\n\n    try {\n      this.flushing = true;\n      while (index < queue.length) {\n        task = queue[index];\n        if (this.longStacks) {\n          this.stack = typeof task.stack === 'string' ? task.stack : undefined;\n        }\n        task.call();\n        index++;\n\n        if (index > capacity) {\n          for (let scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n            queue[scan] = queue[scan + index];\n          }\n\n          queue.length -= index;\n          index = 0;\n        }\n      }\n    } catch (error) {\n      onError(error, task, this.longStacks);\n    } finally {\n      this.flushing = false;\n    }\n  }\n\n  queueMicroTask(task) {\n    if (this.microTaskQueue.length < 1) {\n      this.requestFlushMicroTaskQueue();\n    }\n\n    if (this.longStacks) {\n      task.stack = this.prepareQueueStack(microStackSeparator);\n    }\n\n    this.microTaskQueue.push(task);\n  }\n\n  queueTask(task) {\n    if (this.taskQueue.length < 1) {\n      this.requestFlushTaskQueue();\n    }\n\n    if (this.longStacks) {\n      task.stack = this.prepareQueueStack(stackSeparator);\n    }\n\n    this.taskQueue.push(task);\n  }\n\n  flushTaskQueue() {\n    let queue = this.taskQueue;\n    this.taskQueue = [];\n    this._flushQueue(queue, Number.MAX_VALUE);\n  }\n\n  flushMicroTaskQueue() {\n    let queue = this.microTaskQueue;\n    this._flushQueue(queue, this.microTaskQueueCapacity);\n    queue.length = 0;\n  }\n\n  prepareQueueStack(separator) {\n    let stack = separator + filterQueueStack(captureStack());\n\n    if (typeof this.stack === 'string') {\n      stack = filterFlushStack(stack) + this.stack;\n    }\n\n    return stack;\n  }\n};\n\nfunction captureStack() {\n  let error = new Error();\n\n  if (error.stack) {\n    return error.stack;\n  }\n\n  try {\n    throw error;\n  } catch (e) {\n    return e.stack;\n  }\n}\n\nfunction filterQueueStack(stack) {\n  return stack.replace(/^[\\s\\S]*?\\bqueue(Micro)?Task\\b[^\\n]*\\n/, '');\n}\n\nfunction filterFlushStack(stack) {\n  let index = stack.lastIndexOf('flushMicroTaskQueue');\n\n  if (index < 0) {\n    index = stack.lastIndexOf('flushTaskQueue');\n    if (index < 0) {\n      return stack;\n    }\n  }\n\n  index = stack.lastIndexOf('\\n', index);\n\n  return index < 0 ? stack : stack.substr(0, index);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYVdaby5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRhc2stcXVldWUvZGlzdC9lczIwMTUvYXVyZWxpYS10YXNrLXF1ZXVlLmpzPzY5NjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRE9NLCBGRUFUVVJFIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuXG5jb25zdCBzdGFja1NlcGFyYXRvciA9ICdcXG5FbnF1ZXVlZCBpbiBUYXNrUXVldWUgYnk6XFxuJztcbmNvbnN0IG1pY3JvU3RhY2tTZXBhcmF0b3IgPSAnXFxuRW5xdWV1ZWQgaW4gTWljcm9UYXNrUXVldWUgYnk6XFxuJztcblxuZnVuY3Rpb24gbWFrZVJlcXVlc3RGbHVzaEZyb21NdXRhdGlvbk9ic2VydmVyKGZsdXNoKSB7XG4gIGxldCBvYnNlcnZlciA9IERPTS5jcmVhdGVNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcbiAgbGV0IHZhbCA9ICdhJztcbiAgbGV0IG5vZGUgPSBET00uY3JlYXRlVGV4dE5vZGUoJ2EnKTtcbiAgbGV0IHZhbHVlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIHZhbHVlcy5hID0gJ2InO1xuICB2YWx1ZXMuYiA9ICdhJztcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7XG4gIHJldHVybiBmdW5jdGlvbiByZXF1ZXN0Rmx1c2goKSB7XG4gICAgbm9kZS5kYXRhID0gdmFsID0gdmFsdWVzW3ZhbF07XG4gIH07XG59XG5cbmZ1bmN0aW9uIG1ha2VSZXF1ZXN0Rmx1c2hGcm9tVGltZXIoZmx1c2gpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlcXVlc3RGbHVzaCgpIHtcbiAgICBsZXQgdGltZW91dEhhbmRsZSA9IHNldFRpbWVvdXQoaGFuZGxlRmx1c2hUaW1lciwgMCk7XG5cbiAgICBsZXQgaW50ZXJ2YWxIYW5kbGUgPSBzZXRJbnRlcnZhbChoYW5kbGVGbHVzaFRpbWVyLCA1MCk7XG4gICAgZnVuY3Rpb24gaGFuZGxlRmx1c2hUaW1lcigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SGFuZGxlKTtcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxIYW5kbGUpO1xuICAgICAgZmx1c2goKTtcbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIG9uRXJyb3IoZXJyb3IsIHRhc2ssIGxvbmdTdGFja3MpIHtcbiAgaWYgKGxvbmdTdGFja3MgJiYgdGFzay5zdGFjayAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmIGVycm9yICE9PSBudWxsKSB7XG4gICAgZXJyb3Iuc3RhY2sgPSBmaWx0ZXJGbHVzaFN0YWNrKGVycm9yLnN0YWNrKSArIHRhc2suc3RhY2s7XG4gIH1cblxuICBpZiAoJ29uRXJyb3InIGluIHRhc2spIHtcbiAgICB0YXNrLm9uRXJyb3IoZXJyb3IpO1xuICB9IGVsc2Uge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSwgMCk7XG4gIH1cbn1cblxuZXhwb3J0IGxldCBUYXNrUXVldWUgPSBjbGFzcyBUYXNrUXVldWUge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZsdXNoaW5nID0gZmFsc2U7XG4gICAgdGhpcy5sb25nU3RhY2tzID0gZmFsc2U7XG5cbiAgICB0aGlzLm1pY3JvVGFza1F1ZXVlID0gW107XG4gICAgdGhpcy5taWNyb1Rhc2tRdWV1ZUNhcGFjaXR5ID0gMTAyNDtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IFtdO1xuXG4gICAgaWYgKEZFQVRVUkUubXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgdGhpcy5yZXF1ZXN0Rmx1c2hNaWNyb1Rhc2tRdWV1ZSA9IG1ha2VSZXF1ZXN0Rmx1c2hGcm9tTXV0YXRpb25PYnNlcnZlcigoKSA9PiB0aGlzLmZsdXNoTWljcm9UYXNrUXVldWUoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVxdWVzdEZsdXNoTWljcm9UYXNrUXVldWUgPSBtYWtlUmVxdWVzdEZsdXNoRnJvbVRpbWVyKCgpID0+IHRoaXMuZmx1c2hNaWNyb1Rhc2tRdWV1ZSgpKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlcXVlc3RGbHVzaFRhc2tRdWV1ZSA9IG1ha2VSZXF1ZXN0Rmx1c2hGcm9tVGltZXIoKCkgPT4gdGhpcy5mbHVzaFRhc2tRdWV1ZSgpKTtcbiAgfVxuXG4gIF9mbHVzaFF1ZXVlKHF1ZXVlLCBjYXBhY2l0eSkge1xuICAgIGxldCBpbmRleCA9IDA7XG4gICAgbGV0IHRhc2s7XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5mbHVzaGluZyA9IHRydWU7XG4gICAgICB3aGlsZSAoaW5kZXggPCBxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGFzayA9IHF1ZXVlW2luZGV4XTtcbiAgICAgICAgaWYgKHRoaXMubG9uZ1N0YWNrcykge1xuICAgICAgICAgIHRoaXMuc3RhY2sgPSB0eXBlb2YgdGFzay5zdGFjayA9PT0gJ3N0cmluZycgPyB0YXNrLnN0YWNrIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRhc2suY2FsbCgpO1xuICAgICAgICBpbmRleCsrO1xuXG4gICAgICAgIGlmIChpbmRleCA+IGNhcGFjaXR5KSB7XG4gICAgICAgICAgZm9yIChsZXQgc2NhbiA9IDAsIG5ld0xlbmd0aCA9IHF1ZXVlLmxlbmd0aCAtIGluZGV4OyBzY2FuIDwgbmV3TGVuZ3RoOyBzY2FuKyspIHtcbiAgICAgICAgICAgIHF1ZXVlW3NjYW5dID0gcXVldWVbc2NhbiArIGluZGV4XTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBxdWV1ZS5sZW5ndGggLT0gaW5kZXg7XG4gICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIG9uRXJyb3IoZXJyb3IsIHRhc2ssIHRoaXMubG9uZ1N0YWNrcyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZmx1c2hpbmcgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBxdWV1ZU1pY3JvVGFzayh0YXNrKSB7XG4gICAgaWYgKHRoaXMubWljcm9UYXNrUXVldWUubGVuZ3RoIDwgMSkge1xuICAgICAgdGhpcy5yZXF1ZXN0Rmx1c2hNaWNyb1Rhc2tRdWV1ZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxvbmdTdGFja3MpIHtcbiAgICAgIHRhc2suc3RhY2sgPSB0aGlzLnByZXBhcmVRdWV1ZVN0YWNrKG1pY3JvU3RhY2tTZXBhcmF0b3IpO1xuICAgIH1cblxuICAgIHRoaXMubWljcm9UYXNrUXVldWUucHVzaCh0YXNrKTtcbiAgfVxuXG4gIHF1ZXVlVGFzayh0YXNrKSB7XG4gICAgaWYgKHRoaXMudGFza1F1ZXVlLmxlbmd0aCA8IDEpIHtcbiAgICAgIHRoaXMucmVxdWVzdEZsdXNoVGFza1F1ZXVlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubG9uZ1N0YWNrcykge1xuICAgICAgdGFzay5zdGFjayA9IHRoaXMucHJlcGFyZVF1ZXVlU3RhY2soc3RhY2tTZXBhcmF0b3IpO1xuICAgIH1cblxuICAgIHRoaXMudGFza1F1ZXVlLnB1c2godGFzayk7XG4gIH1cblxuICBmbHVzaFRhc2tRdWV1ZSgpIHtcbiAgICBsZXQgcXVldWUgPSB0aGlzLnRhc2tRdWV1ZTtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IFtdO1xuICAgIHRoaXMuX2ZsdXNoUXVldWUocXVldWUsIE51bWJlci5NQVhfVkFMVUUpO1xuICB9XG5cbiAgZmx1c2hNaWNyb1Rhc2tRdWV1ZSgpIHtcbiAgICBsZXQgcXVldWUgPSB0aGlzLm1pY3JvVGFza1F1ZXVlO1xuICAgIHRoaXMuX2ZsdXNoUXVldWUocXVldWUsIHRoaXMubWljcm9UYXNrUXVldWVDYXBhY2l0eSk7XG4gICAgcXVldWUubGVuZ3RoID0gMDtcbiAgfVxuXG4gIHByZXBhcmVRdWV1ZVN0YWNrKHNlcGFyYXRvcikge1xuICAgIGxldCBzdGFjayA9IHNlcGFyYXRvciArIGZpbHRlclF1ZXVlU3RhY2soY2FwdHVyZVN0YWNrKCkpO1xuXG4gICAgaWYgKHR5cGVvZiB0aGlzLnN0YWNrID09PSAnc3RyaW5nJykge1xuICAgICAgc3RhY2sgPSBmaWx0ZXJGbHVzaFN0YWNrKHN0YWNrKSArIHRoaXMuc3RhY2s7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YWNrO1xuICB9XG59O1xuXG5mdW5jdGlvbiBjYXB0dXJlU3RhY2soKSB7XG4gIGxldCBlcnJvciA9IG5ldyBFcnJvcigpO1xuXG4gIGlmIChlcnJvci5zdGFjaykge1xuICAgIHJldHVybiBlcnJvci5zdGFjaztcbiAgfVxuXG4gIHRyeSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZS5zdGFjaztcbiAgfVxufVxuXG5mdW5jdGlvbiBmaWx0ZXJRdWV1ZVN0YWNrKHN0YWNrKSB7XG4gIHJldHVybiBzdGFjay5yZXBsYWNlKC9eW1xcc1xcU10qP1xcYnF1ZXVlKE1pY3JvKT9UYXNrXFxiW15cXG5dKlxcbi8sICcnKTtcbn1cblxuZnVuY3Rpb24gZmlsdGVyRmx1c2hTdGFjayhzdGFjaykge1xuICBsZXQgaW5kZXggPSBzdGFjay5sYXN0SW5kZXhPZignZmx1c2hNaWNyb1Rhc2tRdWV1ZScpO1xuXG4gIGlmIChpbmRleCA8IDApIHtcbiAgICBpbmRleCA9IHN0YWNrLmxhc3RJbmRleE9mKCdmbHVzaFRhc2tRdWV1ZScpO1xuICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgIHJldHVybiBzdGFjaztcbiAgICB9XG4gIH1cblxuICBpbmRleCA9IHN0YWNrLmxhc3RJbmRleE9mKCdcXG4nLCBpbmRleCk7XG5cbiAgcmV0dXJuIGluZGV4IDwgMCA/IHN0YWNrIDogc3RhY2suc3Vic3RyKDAsIGluZGV4KTtcbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aWZo\n");

/***/ }),

/***/ "aurelia-templating-binding":
/*!*******************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-binding/dist/es2015/aurelia-templating-binding.js ***!
  \*******************************************************************************************/
/*! exports provided: AttributeMap, InterpolationBindingExpression, InterpolationBinding, ChildInterpolationBinding, LetExpression, LetBinding, LetInterpolationBindingExpression, LetInterpolationBinding, SyntaxInterpreter, TemplatingBindingLanguage, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttributeMap\", function() { return AttributeMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InterpolationBindingExpression\", function() { return InterpolationBindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InterpolationBinding\", function() { return InterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ChildInterpolationBinding\", function() { return ChildInterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetExpression\", function() { return LetExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetBinding\", function() { return LetBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetInterpolationBindingExpression\", function() { return LetInterpolationBindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetInterpolationBinding\", function() { return LetInterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SyntaxInterpreter\", function() { return SyntaxInterpreter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingBindingLanguage\", function() { return TemplatingBindingLanguage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"KKpb\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-binding */ \"NDtI\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-templating */ \"SkM8\");\nvar _class, _temp, _dec, _class2, _dec2, _class3, _class4, _temp2, _class5, _temp3;\n\n\n\n\n\nlet AttributeMap = (_temp = _class = class AttributeMap {\n\n  constructor(svg) {\n    this.elements = Object.create(null);\n    this.allElements = Object.create(null);\n\n    this.svg = svg;\n\n    this.registerUniversal('accesskey', 'accessKey');\n    this.registerUniversal('contenteditable', 'contentEditable');\n    this.registerUniversal('tabindex', 'tabIndex');\n    this.registerUniversal('textcontent', 'textContent');\n    this.registerUniversal('innerhtml', 'innerHTML');\n    this.registerUniversal('scrolltop', 'scrollTop');\n    this.registerUniversal('scrollleft', 'scrollLeft');\n    this.registerUniversal('readonly', 'readOnly');\n\n    this.register('label', 'for', 'htmlFor');\n\n    this.register('img', 'usemap', 'useMap');\n\n    this.register('input', 'maxlength', 'maxLength');\n    this.register('input', 'minlength', 'minLength');\n    this.register('input', 'formaction', 'formAction');\n    this.register('input', 'formenctype', 'formEncType');\n    this.register('input', 'formmethod', 'formMethod');\n    this.register('input', 'formnovalidate', 'formNoValidate');\n    this.register('input', 'formtarget', 'formTarget');\n\n    this.register('textarea', 'maxlength', 'maxLength');\n\n    this.register('td', 'rowspan', 'rowSpan');\n    this.register('td', 'colspan', 'colSpan');\n    this.register('th', 'rowspan', 'rowSpan');\n    this.register('th', 'colspan', 'colSpan');\n  }\n\n  register(elementName, attributeName, propertyName) {\n    elementName = elementName.toLowerCase();\n    attributeName = attributeName.toLowerCase();\n    const element = this.elements[elementName] = this.elements[elementName] || Object.create(null);\n    element[attributeName] = propertyName;\n  }\n\n  registerUniversal(attributeName, propertyName) {\n    attributeName = attributeName.toLowerCase();\n    this.allElements[attributeName] = propertyName;\n  }\n\n  map(elementName, attributeName) {\n    if (this.svg.isStandardSvgAttribute(elementName, attributeName)) {\n      return attributeName;\n    }\n    elementName = elementName.toLowerCase();\n    attributeName = attributeName.toLowerCase();\n    const element = this.elements[elementName];\n    if (element !== undefined && attributeName in element) {\n      return element[attributeName];\n    }\n    if (attributeName in this.allElements) {\n      return this.allElements[attributeName];\n    }\n\n    if (/(?:^data-)|(?:^aria-)|:/.test(attributeName)) {\n      return attributeName;\n    }\n    return Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(attributeName);\n  }\n}, _class.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"SVGAnalyzer\"]], _temp);\n\nlet InterpolationBindingExpression = class InterpolationBindingExpression {\n  constructor(observerLocator, targetProperty, parts, mode, lookupFunctions, attribute) {\n    this.observerLocator = observerLocator;\n    this.targetProperty = targetProperty;\n    this.parts = parts;\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n    this.attribute = this.attrToRemove = attribute;\n    this.discrete = false;\n  }\n\n  createBinding(target) {\n    if (this.parts.length === 3) {\n      return new ChildInterpolationBinding(target, this.observerLocator, this.parts[1], this.mode, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);\n    }\n    return new InterpolationBinding(this.observerLocator, this.parts, target, this.targetProperty, this.mode, this.lookupFunctions);\n  }\n};\n\nfunction validateTarget(target, propertyName) {\n  if (propertyName === 'style') {\n    aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding').info('Internet Explorer does not support interpolation in \"style\" attributes.  Use the style attribute\\'s alias, \"css\" instead.');\n  } else if (target.parentElement && target.parentElement.nodeName === 'TEXTAREA' && propertyName === 'textContent') {\n    throw new Error('Interpolation binding cannot be used in the content of a textarea element.  Use <textarea value.bind=\"expression\"></textarea> instead.');\n  }\n}\n\nlet InterpolationBinding = class InterpolationBinding {\n  constructor(observerLocator, parts, target, targetProperty, mode, lookupFunctions) {\n    validateTarget(target, targetProperty);\n    this.observerLocator = observerLocator;\n    this.parts = parts;\n    this.target = target;\n    this.targetProperty = targetProperty;\n    this.targetAccessor = observerLocator.getAccessor(target, targetProperty);\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  interpolate() {\n    if (this.isBound) {\n      let value = '';\n      let parts = this.parts;\n      for (let i = 0, ii = parts.length; i < ii; i++) {\n        value += i % 2 === 0 ? parts[i] : this[`childBinding${i}`].value;\n      }\n      this.targetAccessor.setValue(value, this.target, this.targetProperty);\n    }\n  }\n\n  updateOneTimeBindings() {\n    for (let i = 1, ii = this.parts.length; i < ii; i += 2) {\n      let child = this[`childBinding${i}`];\n      if (child.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\n        child.call();\n      }\n    }\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.source = source;\n\n    let parts = this.parts;\n    for (let i = 1, ii = parts.length; i < ii; i += 2) {\n      let binding = new ChildInterpolationBinding(this, this.observerLocator, parts[i], this.mode, this.lookupFunctions);\n      binding.bind(source);\n      this[`childBinding${i}`] = binding;\n    }\n\n    this.isBound = true;\n    this.interpolate();\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.source = null;\n    let parts = this.parts;\n    for (let i = 1, ii = parts.length; i < ii; i += 2) {\n      let name = `childBinding${i}`;\n      this[name].unbind();\n    }\n  }\n};\n\nlet ChildInterpolationBinding = (_dec = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"connectable\"])(), _dec(_class2 = class ChildInterpolationBinding {\n  constructor(target, observerLocator, sourceExpression, mode, lookupFunctions, targetProperty, left, right) {\n    if (target instanceof InterpolationBinding) {\n      this.parent = target;\n    } else {\n      validateTarget(target, targetProperty);\n      this.target = target;\n      this.targetProperty = targetProperty;\n      this.targetAccessor = observerLocator.getAccessor(target, targetProperty);\n    }\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n    this.left = left;\n    this.right = right;\n  }\n\n  updateTarget(value) {\n    value = value === null || value === undefined ? '' : value.toString();\n    if (value !== this.value) {\n      this.value = value;\n      if (this.parent) {\n        this.parent.interpolate();\n      } else {\n        this.targetAccessor.setValue(this.left + value + this.right, this.target, this.targetProperty);\n      }\n    }\n  }\n\n  call() {\n    if (!this.isBound) {\n      return;\n    }\n\n    this.rawValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n    this.updateTarget(this.rawValue);\n\n    if (this.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\n      this._version++;\n      this.sourceExpression.connect(this, this.source);\n      if (this.rawValue instanceof Array) {\n        this.observeArray(this.rawValue);\n      }\n      this.unobserve(false);\n    }\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.isBound = true;\n    this.source = source;\n\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.bind) {\n      sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n\n    this.rawValue = sourceExpression.evaluate(source, this.lookupFunctions);\n    this.updateTarget(this.rawValue);\n\n    if (this.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay) {\n      Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"enqueueBindingConnect\"])(this);\n    }\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.unbind) {\n      sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    this.value = null;\n    this.rawValue = null;\n    this.unobserve(true);\n  }\n\n  connect(evaluate) {\n    if (!this.isBound) {\n      return;\n    }\n    if (evaluate) {\n      this.rawValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n      this.updateTarget(this.rawValue);\n    }\n    this.sourceExpression.connect(this, this.source);\n    if (this.rawValue instanceof Array) {\n      this.observeArray(this.rawValue);\n    }\n  }\n}) || _class2);\n\nlet LetExpression = class LetExpression {\n  constructor(observerLocator, targetProperty, sourceExpression, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.targetProperty = targetProperty;\n    this.lookupFunctions = lookupFunctions;\n    this.toBindingContext = toBindingContext;\n  }\n\n  createBinding() {\n    return new LetBinding(this.observerLocator, this.sourceExpression, this.targetProperty, this.lookupFunctions, this.toBindingContext);\n  }\n};\n\nlet LetBinding = (_dec2 = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"connectable\"])(), _dec2(_class3 = class LetBinding {\n  constructor(observerLocator, sourceExpression, targetProperty, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.targetProperty = targetProperty;\n    this.lookupFunctions = lookupFunctions;\n    this.source = null;\n    this.target = null;\n    this.toBindingContext = toBindingContext;\n  }\n\n  updateTarget() {\n    const value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n    this.target[this.targetProperty] = value;\n  }\n\n  call(context) {\n    if (!this.isBound) {\n      return;\n    }\n    if (context === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"sourceContext\"]) {\n      this.updateTarget();\n      return;\n    }\n    throw new Error(`Unexpected call context ${context}`);\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.source = source;\n    this.target = this.toBindingContext ? source.bindingContext : source.overrideContext;\n\n    if (this.sourceExpression.bind) {\n      this.sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"enqueueBindingConnect\"])(this);\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    if (this.sourceExpression.unbind) {\n      this.sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    this.target = null;\n    this.unobserve(true);\n  }\n\n  connect() {\n    if (!this.isBound) {\n      return;\n    }\n    this.updateTarget();\n    this.sourceExpression.connect(this, this.source);\n  }\n}) || _class3);\n\nlet LetInterpolationBindingExpression = class LetInterpolationBindingExpression {\n  constructor(observerLocator, targetProperty, parts, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.targetProperty = targetProperty;\n    this.parts = parts;\n    this.lookupFunctions = lookupFunctions;\n    this.toBindingContext = toBindingContext;\n  }\n\n  createBinding() {\n    return new LetInterpolationBinding(this.observerLocator, this.targetProperty, this.parts, this.lookupFunctions, this.toBindingContext);\n  }\n};\n\nlet LetInterpolationBinding = class LetInterpolationBinding {\n  constructor(observerLocator, targetProperty, parts, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.parts = parts;\n    this.targetProperty = targetProperty;\n    this.lookupFunctions = lookupFunctions;\n    this.toBindingContext = toBindingContext;\n    this.target = null;\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.source = source;\n    this.target = this.toBindingContext ? source.bindingContext : source.overrideContext;\n\n    this.interpolationBinding = this.createInterpolationBinding();\n    this.interpolationBinding.bind(source);\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.source = null;\n    this.target = null;\n    this.interpolationBinding.unbind();\n    this.interpolationBinding = null;\n  }\n\n  createInterpolationBinding() {\n    if (this.parts.length === 3) {\n      return new ChildInterpolationBinding(this.target, this.observerLocator, this.parts[1], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);\n    }\n    return new InterpolationBinding(this.observerLocator, this.parts, this.target, this.targetProperty, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, this.lookupFunctions);\n  }\n};\n\nlet SyntaxInterpreter = (_temp2 = _class4 = class SyntaxInterpreter {\n\n  constructor(parser, observerLocator, eventManager, attributeMap) {\n    this.parser = parser;\n    this.observerLocator = observerLocator;\n    this.eventManager = eventManager;\n    this.attributeMap = attributeMap;\n  }\n\n  interpret(resources, element, info, existingInstruction, context) {\n    if (info.command in this) {\n      return this[info.command](resources, element, info, existingInstruction, context);\n    }\n\n    return this.handleUnknownCommand(resources, element, info, existingInstruction, context);\n  }\n\n  handleUnknownCommand(resources, element, info, existingInstruction, context) {\n    aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding').warn('Unknown binding command.', info);\n    return existingInstruction;\n  }\n\n  determineDefaultBindingMode(element, attrName, context) {\n    let tagName = element.tagName.toLowerCase();\n\n    if (tagName === 'input' && (attrName === 'value' || attrName === 'files') && element.type !== 'checkbox' && element.type !== 'radio' || tagName === 'input' && attrName === 'checked' && (element.type === 'checkbox' || element.type === 'radio') || (tagName === 'textarea' || tagName === 'select') && attrName === 'value' || (attrName === 'textcontent' || attrName === 'innerhtml') && element.contentEditable === 'true' || attrName === 'scrolltop' || attrName === 'scrollleft') {\n      return aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].twoWay;\n    }\n\n    if (context && attrName in context.attributes && context.attributes[attrName] && context.attributes[attrName].defaultBindingMode >= aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\n      return context.attributes[attrName].defaultBindingMode;\n    }\n\n    return aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay;\n  }\n\n  bind(resources, element, info, existingInstruction, context) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), info.defaultBindingMode === undefined || info.defaultBindingMode === null ? this.determineDefaultBindingMode(element, info.attrName, context) : info.defaultBindingMode, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  trigger(resources, element, info) {\n    return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].none, true, resources.lookupFunctions);\n  }\n\n  capture(resources, element, info) {\n    return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].capturing, true, resources.lookupFunctions);\n  }\n\n  delegate(resources, element, info) {\n    return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].bubbling, true, resources.lookupFunctions);\n  }\n\n  call(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"CallExpression\"](this.observerLocator, info.attrName, this.parser.parse(info.attrValue), resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  options(resources, element, info, existingInstruction, context) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n    let attrValue = info.attrValue;\n    let language = this.language;\n    let name = null;\n    let target = '';\n    let current;\n    let i;\n    let ii;\n    let inString = false;\n    let inEscape = false;\n    let foundName = false;\n\n    for (i = 0, ii = attrValue.length; i < ii; ++i) {\n      current = attrValue[i];\n\n      if (current === ';' && !inString) {\n        if (!foundName) {\n          name = this._getPrimaryPropertyName(resources, context);\n        }\n        info = language.inspectAttribute(resources, '?', name, target.trim());\n        language.createAttributeInstruction(resources, element, info, instruction, context);\n\n        if (!instruction.attributes[info.attrName]) {\n          instruction.attributes[info.attrName] = info.attrValue;\n        }\n\n        target = '';\n        name = null;\n      } else if (current === ':' && name === null) {\n        foundName = true;\n        name = target.trim();\n        target = '';\n      } else if (current === '\\\\') {\n        target += current;\n        inEscape = true;\n        continue;\n      } else {\n        target += current;\n\n        if (name !== null && inEscape === false && current === '\\'') {\n          inString = !inString;\n        }\n      }\n\n      inEscape = false;\n    }\n\n    if (!foundName) {\n      name = this._getPrimaryPropertyName(resources, context);\n    }\n\n    if (name !== null) {\n      info = language.inspectAttribute(resources, '?', name, target.trim());\n      language.createAttributeInstruction(resources, element, info, instruction, context);\n\n      if (!instruction.attributes[info.attrName]) {\n        instruction.attributes[info.attrName] = info.attrValue;\n      }\n    }\n\n    return instruction;\n  }\n\n  _getPrimaryPropertyName(resources, context) {\n    let type = resources.getAttribute(context.attributeName);\n    if (type && type.primaryProperty) {\n      return type.primaryProperty.attribute;\n    }\n    return null;\n  }\n\n  'for'(resources, element, info, existingInstruction) {\n    let parts;\n    let keyValue;\n    let instruction;\n    let attrValue;\n    let isDestructuring;\n\n    attrValue = info.attrValue;\n    isDestructuring = attrValue.match(/^ *[[].+[\\]]/);\n    parts = isDestructuring ? attrValue.split('of ') : attrValue.split(' of ');\n\n    if (parts.length !== 2) {\n      throw new Error('Incorrect syntax for \"for\". The form is: \"$local of $items\" or \"[$key, $value] of $items\".');\n    }\n\n    instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    if (isDestructuring) {\n      keyValue = parts[0].replace(/[[\\]]/g, '').replace(/,/g, ' ').replace(/\\s+/g, ' ').trim().split(' ');\n      instruction.attributes.key = keyValue[0];\n      instruction.attributes.value = keyValue[1];\n    } else {\n      instruction.attributes.local = parts[0];\n    }\n\n    instruction.attributes.items = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, 'items', this.parser.parse(parts[1]), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'two-way'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].twoWay, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'to-view'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'from-view'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].fromView, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'one-time'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime, resources.lookupFunctions);\n\n    return instruction;\n  }\n}, _class4.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"Parser\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ObserverLocator\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"EventManager\"], AttributeMap], _temp2);\n\nSyntaxInterpreter.prototype['one-way'] = SyntaxInterpreter.prototype['to-view'];\n\nlet info = {};\n\nlet TemplatingBindingLanguage = (_temp3 = _class5 = class TemplatingBindingLanguage extends aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BindingLanguage\"] {\n\n  constructor(parser, observerLocator, syntaxInterpreter, attributeMap) {\n    super();\n    this.parser = parser;\n    this.observerLocator = observerLocator;\n    this.syntaxInterpreter = syntaxInterpreter;\n    this.emptyStringExpression = this.parser.parse('\\'\\'');\n    syntaxInterpreter.language = this;\n    this.attributeMap = attributeMap;\n    this.toBindingContextAttr = 'to-binding-context';\n  }\n\n  inspectAttribute(resources, elementName, attrName, attrValue) {\n    let parts = attrName.split('.');\n\n    info.defaultBindingMode = null;\n\n    if (parts.length === 2) {\n      info.attrName = parts[0].trim();\n      info.attrValue = attrValue;\n      info.command = parts[1].trim();\n\n      if (info.command === 'ref') {\n        info.expression = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"NameExpression\"](this.parser.parse(attrValue), info.attrName, resources.lookupFunctions);\n        info.command = null;\n        info.attrName = 'ref';\n      } else {\n        info.expression = null;\n      }\n    } else if (attrName === 'ref') {\n      info.attrName = attrName;\n      info.attrValue = attrValue;\n      info.command = null;\n      info.expression = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"NameExpression\"](this.parser.parse(attrValue), 'element', resources.lookupFunctions);\n    } else {\n      info.attrName = attrName;\n      info.attrValue = attrValue;\n      info.command = null;\n      const interpolationParts = this.parseInterpolation(resources, attrValue);\n      if (interpolationParts === null) {\n        info.expression = null;\n      } else {\n        info.expression = new InterpolationBindingExpression(this.observerLocator, this.attributeMap.map(elementName, attrName), interpolationParts, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, resources.lookupFunctions, attrName);\n      }\n    }\n\n    return info;\n  }\n\n  createAttributeInstruction(resources, element, theInfo, existingInstruction, context) {\n    let instruction;\n\n    if (theInfo.expression) {\n      if (theInfo.attrName === 'ref') {\n        return theInfo.expression;\n      }\n\n      instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(theInfo.attrName);\n      instruction.attributes[theInfo.attrName] = theInfo.expression;\n    } else if (theInfo.command) {\n      instruction = this.syntaxInterpreter.interpret(resources, element, theInfo, existingInstruction, context);\n    }\n\n    return instruction;\n  }\n\n  createLetExpressions(resources, letElement) {\n    let expressions = [];\n    let attributes = letElement.attributes;\n\n    let attr;\n\n    let parts;\n    let attrName;\n    let attrValue;\n    let command;\n    let toBindingContextAttr = this.toBindingContextAttr;\n    let toBindingContext = letElement.hasAttribute(toBindingContextAttr);\n    for (let i = 0, ii = attributes.length; ii > i; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.nodeValue;\n      parts = attrName.split('.');\n\n      if (attrName === toBindingContextAttr) {\n        continue;\n      }\n\n      if (parts.length === 2) {\n        command = parts[1];\n        if (command !== 'bind') {\n          aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding-language').warn(`Detected invalid let command. Expected \"${parts[0]}.bind\", given \"${attrName}\"`);\n          continue;\n        }\n        expressions.push(new LetExpression(this.observerLocator, Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(parts[0]), this.parser.parse(attrValue), resources.lookupFunctions, toBindingContext));\n      } else {\n        attrName = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(attrName);\n        parts = this.parseInterpolation(resources, attrValue);\n        if (parts === null) {\n          aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding-language').warn(`Detected string literal in let bindings. Did you mean \"${attrName}.bind=${attrValue}\" or \"${attrName}=\\${${attrValue}}\" ?`);\n        }\n        if (parts) {\n          expressions.push(new LetInterpolationBindingExpression(this.observerLocator, attrName, parts, resources.lookupFunctions, toBindingContext));\n        } else {\n          expressions.push(new LetExpression(this.observerLocator, attrName, new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"LiteralString\"](attrValue), resources.lookupFunctions, toBindingContext));\n        }\n      }\n    }\n    return expressions;\n  }\n\n  inspectTextContent(resources, value) {\n    const parts = this.parseInterpolation(resources, value);\n    if (parts === null) {\n      return null;\n    }\n    return new InterpolationBindingExpression(this.observerLocator, 'textContent', parts, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, resources.lookupFunctions, 'textContent');\n  }\n\n  parseInterpolation(resources, value) {\n    let i = value.indexOf('${', 0);\n    let ii = value.length;\n    let char;\n    let pos = 0;\n    let open = 0;\n    let quote = null;\n    let interpolationStart;\n    let parts;\n    let partIndex = 0;\n\n    while (i >= 0 && i < ii - 2) {\n      open = 1;\n      interpolationStart = i;\n      i += 2;\n\n      do {\n        char = value[i];\n        i++;\n\n        if (char === \"'\" || char === '\"') {\n          if (quote === null) {\n            quote = char;\n          } else if (quote === char) {\n            quote = null;\n          }\n          continue;\n        }\n\n        if (char === '\\\\') {\n          i++;\n          continue;\n        }\n\n        if (quote !== null) {\n          continue;\n        }\n\n        if (char === '{') {\n          open++;\n        } else if (char === '}') {\n          open--;\n        }\n      } while (open > 0 && i < ii);\n\n      if (open === 0) {\n        parts = parts || [];\n        if (value[interpolationStart - 1] === '\\\\' && value[interpolationStart - 2] !== '\\\\') {\n          parts[partIndex] = value.substring(pos, interpolationStart - 1) + value.substring(interpolationStart, i);\n          partIndex++;\n          parts[partIndex] = this.emptyStringExpression;\n          partIndex++;\n        } else {\n          parts[partIndex] = value.substring(pos, interpolationStart);\n          partIndex++;\n          parts[partIndex] = this.parser.parse(value.substring(interpolationStart + 2, i - 1));\n          partIndex++;\n        }\n        pos = i;\n        i = value.indexOf('${', i);\n      } else {\n        break;\n      }\n    }\n\n    if (partIndex === 0) {\n      return null;\n    }\n\n    parts[partIndex] = value.substr(pos);\n    return parts;\n  }\n}, _class5.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"Parser\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ObserverLocator\"], SyntaxInterpreter, AttributeMap], _temp3);\n\nfunction configure(config) {\n  config.container.registerSingleton(aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BindingLanguage\"], TemplatingBindingLanguage);\n  config.container.registerAlias(aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BindingLanguage\"], TemplatingBindingLanguage);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcvZGlzdC9lczIwMTUvYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcuanM/NTcxNSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2NsYXNzLCBfdGVtcCwgX2RlYywgX2NsYXNzMiwgX2RlYzIsIF9jbGFzczMsIF9jbGFzczQsIF90ZW1wMiwgX2NsYXNzNSwgX3RlbXAzO1xuXG5pbXBvcnQgKiBhcyBMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5pbXBvcnQgeyBjYW1lbENhc2UsIFNWR0FuYWx5emVyLCBiaW5kaW5nTW9kZSwgY29ubmVjdGFibGUsIGVucXVldWVCaW5kaW5nQ29ubmVjdCwgc291cmNlQ29udGV4dCwgUGFyc2VyLCBPYnNlcnZlckxvY2F0b3IsIEV2ZW50TWFuYWdlciwgTGlzdGVuZXJFeHByZXNzaW9uLCBCaW5kaW5nRXhwcmVzc2lvbiwgQ2FsbEV4cHJlc3Npb24sIGRlbGVnYXRpb25TdHJhdGVneSwgTmFtZUV4cHJlc3Npb24sIExpdGVyYWxTdHJpbmcgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgQmVoYXZpb3JJbnN0cnVjdGlvbiwgQmluZGluZ0xhbmd1YWdlIH0gZnJvbSAnYXVyZWxpYS10ZW1wbGF0aW5nJztcblxuZXhwb3J0IGxldCBBdHRyaWJ1dGVNYXAgPSAoX3RlbXAgPSBfY2xhc3MgPSBjbGFzcyBBdHRyaWJ1dGVNYXAge1xuXG4gIGNvbnN0cnVjdG9yKHN2Zykge1xuICAgIHRoaXMuZWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMuYWxsRWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgdGhpcy5zdmcgPSBzdmc7XG5cbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdhY2Nlc3NrZXknLCAnYWNjZXNzS2V5Jyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnY29udGVudGVkaXRhYmxlJywgJ2NvbnRlbnRFZGl0YWJsZScpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3RhYmluZGV4JywgJ3RhYkluZGV4Jyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgndGV4dGNvbnRlbnQnLCAndGV4dENvbnRlbnQnKTtcbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdpbm5lcmh0bWwnLCAnaW5uZXJIVE1MJyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnc2Nyb2xsdG9wJywgJ3Njcm9sbFRvcCcpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3Njcm9sbGxlZnQnLCAnc2Nyb2xsTGVmdCcpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3JlYWRvbmx5JywgJ3JlYWRPbmx5Jyk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyKCdsYWJlbCcsICdmb3InLCAnaHRtbEZvcicpO1xuXG4gICAgdGhpcy5yZWdpc3RlcignaW1nJywgJ3VzZW1hcCcsICd1c2VNYXAnKTtcblxuICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ21heGxlbmd0aCcsICdtYXhMZW5ndGgnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdtaW5sZW5ndGgnLCAnbWluTGVuZ3RoJyk7XG4gICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybWFjdGlvbicsICdmb3JtQWN0aW9uJyk7XG4gICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybWVuY3R5cGUnLCAnZm9ybUVuY1R5cGUnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3JtbWV0aG9kJywgJ2Zvcm1NZXRob2QnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3Jtbm92YWxpZGF0ZScsICdmb3JtTm9WYWxpZGF0ZScpO1xuICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ2Zvcm10YXJnZXQnLCAnZm9ybVRhcmdldCcpO1xuXG4gICAgdGhpcy5yZWdpc3RlcigndGV4dGFyZWEnLCAnbWF4bGVuZ3RoJywgJ21heExlbmd0aCcpO1xuXG4gICAgdGhpcy5yZWdpc3RlcigndGQnLCAncm93c3BhbicsICdyb3dTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGQnLCAnY29sc3BhbicsICdjb2xTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGgnLCAncm93c3BhbicsICdyb3dTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGgnLCAnY29sc3BhbicsICdjb2xTcGFuJyk7XG4gIH1cblxuICByZWdpc3RlcihlbGVtZW50TmFtZSwgYXR0cmlidXRlTmFtZSwgcHJvcGVydHlOYW1lKSB7XG4gICAgZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudHNbZWxlbWVudE5hbWVdID0gdGhpcy5lbGVtZW50c1tlbGVtZW50TmFtZV0gfHwgT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICBlbGVtZW50W2F0dHJpYnV0ZU5hbWVdID0gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgcmVnaXN0ZXJVbml2ZXJzYWwoYXR0cmlidXRlTmFtZSwgcHJvcGVydHlOYW1lKSB7XG4gICAgYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB0aGlzLmFsbEVsZW1lbnRzW2F0dHJpYnV0ZU5hbWVdID0gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgbWFwKGVsZW1lbnROYW1lLCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgaWYgKHRoaXMuc3ZnLmlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUoZWxlbWVudE5hbWUsIGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgICByZXR1cm4gYXR0cmlidXRlTmFtZTtcbiAgICB9XG4gICAgZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudHNbZWxlbWVudE5hbWVdO1xuICAgIGlmIChlbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgYXR0cmlidXRlTmFtZSBpbiBlbGVtZW50KSB7XG4gICAgICByZXR1cm4gZWxlbWVudFthdHRyaWJ1dGVOYW1lXTtcbiAgICB9XG4gICAgaWYgKGF0dHJpYnV0ZU5hbWUgaW4gdGhpcy5hbGxFbGVtZW50cykge1xuICAgICAgcmV0dXJuIHRoaXMuYWxsRWxlbWVudHNbYXR0cmlidXRlTmFtZV07XG4gICAgfVxuXG4gICAgaWYgKC8oPzpeZGF0YS0pfCg/Ol5hcmlhLSl8Oi8udGVzdChhdHRyaWJ1dGVOYW1lKSkge1xuICAgICAgcmV0dXJuIGF0dHJpYnV0ZU5hbWU7XG4gICAgfVxuICAgIHJldHVybiBjYW1lbENhc2UoYXR0cmlidXRlTmFtZSk7XG4gIH1cbn0sIF9jbGFzcy5pbmplY3QgPSBbU1ZHQW5hbHl6ZXJdLCBfdGVtcCk7XG5cbmV4cG9ydCBsZXQgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uID0gY2xhc3MgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgcGFydHMsIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucywgYXR0cmlidXRlKSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xuICAgIHRoaXMucGFydHMgPSBwYXJ0cztcbiAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICAgIHRoaXMuYXR0cmlidXRlID0gdGhpcy5hdHRyVG9SZW1vdmUgPSBhdHRyaWJ1dGU7XG4gICAgdGhpcy5kaXNjcmV0ZSA9IGZhbHNlO1xuICB9XG5cbiAgY3JlYXRlQmluZGluZyh0YXJnZXQpIHtcbiAgICBpZiAodGhpcy5wYXJ0cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyh0YXJnZXQsIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnBhcnRzWzFdLCB0aGlzLm1vZGUsIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLnBhcnRzWzBdLCB0aGlzLnBhcnRzWzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0cywgdGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLm1vZGUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gdmFsaWRhdGVUYXJnZXQodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3N0eWxlJykge1xuICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmcnKS5pbmZvKCdJbnRlcm5ldCBFeHBsb3JlciBkb2VzIG5vdCBzdXBwb3J0IGludGVycG9sYXRpb24gaW4gXCJzdHlsZVwiIGF0dHJpYnV0ZXMuICBVc2UgdGhlIHN0eWxlIGF0dHJpYnV0ZVxcJ3MgYWxpYXMsIFwiY3NzXCIgaW5zdGVhZC4nKTtcbiAgfSBlbHNlIGlmICh0YXJnZXQucGFyZW50RWxlbWVudCAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyAmJiBwcm9wZXJ0eU5hbWUgPT09ICd0ZXh0Q29udGVudCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVycG9sYXRpb24gYmluZGluZyBjYW5ub3QgYmUgdXNlZCBpbiB0aGUgY29udGVudCBvZiBhIHRleHRhcmVhIGVsZW1lbnQuICBVc2UgPHRleHRhcmVhIHZhbHVlLmJpbmQ9XCJleHByZXNzaW9uXCI+PC90ZXh0YXJlYT4gaW5zdGVhZC4nKTtcbiAgfVxufVxuXG5leHBvcnQgbGV0IEludGVycG9sYXRpb25CaW5kaW5nID0gY2xhc3MgSW50ZXJwb2xhdGlvbkJpbmRpbmcge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHBhcnRzLCB0YXJnZXQsIHRhcmdldFByb3BlcnR5LCBtb2RlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB2YWxpZGF0ZVRhcmdldCh0YXJnZXQsIHRhcmdldFByb3BlcnR5KTtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnBhcnRzID0gcGFydHM7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xuICAgIHRoaXMudGFyZ2V0QWNjZXNzb3IgPSBvYnNlcnZlckxvY2F0b3IuZ2V0QWNjZXNzb3IodGFyZ2V0LCB0YXJnZXRQcm9wZXJ0eSk7XG4gICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgfVxuXG4gIGludGVycG9sYXRlKCkge1xuICAgIGlmICh0aGlzLmlzQm91bmQpIHtcbiAgICAgIGxldCB2YWx1ZSA9ICcnO1xuICAgICAgbGV0IHBhcnRzID0gdGhpcy5wYXJ0cztcbiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgdmFsdWUgKz0gaSAlIDIgPT09IDAgPyBwYXJ0c1tpXSA6IHRoaXNbYGNoaWxkQmluZGluZyR7aX1gXS52YWx1ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3Iuc2V0VmFsdWUodmFsdWUsIHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5KTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVPbmVUaW1lQmluZGluZ3MoKSB7XG4gICAgZm9yIChsZXQgaSA9IDEsIGlpID0gdGhpcy5wYXJ0cy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7XG4gICAgICBsZXQgY2hpbGQgPSB0aGlzW2BjaGlsZEJpbmRpbmcke2l9YF07XG4gICAgICBpZiAoY2hpbGQubW9kZSA9PT0gYmluZGluZ01vZGUub25lVGltZSkge1xuICAgICAgICBjaGlsZC5jYWxsKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblxuICAgIGxldCBwYXJ0cyA9IHRoaXMucGFydHM7XG4gICAgZm9yIChsZXQgaSA9IDEsIGlpID0gcGFydHMubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikge1xuICAgICAgbGV0IGJpbmRpbmcgPSBuZXcgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLCB0aGlzLm9ic2VydmVyTG9jYXRvciwgcGFydHNbaV0sIHRoaXMubW9kZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgICAgYmluZGluZy5iaW5kKHNvdXJjZSk7XG4gICAgICB0aGlzW2BjaGlsZEJpbmRpbmcke2l9YF0gPSBiaW5kaW5nO1xuICAgIH1cblxuICAgIHRoaXMuaXNCb3VuZCA9IHRydWU7XG4gICAgdGhpcy5pbnRlcnBvbGF0ZSgpO1xuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICBsZXQgcGFydHMgPSB0aGlzLnBhcnRzO1xuICAgIGZvciAobGV0IGkgPSAxLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHtcbiAgICAgIGxldCBuYW1lID0gYGNoaWxkQmluZGluZyR7aX1gO1xuICAgICAgdGhpc1tuYW1lXS51bmJpbmQoKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyA9IChfZGVjID0gY29ubmVjdGFibGUoKSwgX2RlYyhfY2xhc3MyID0gY2xhc3MgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldCwgb2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCBtb2RlLCBsb29rdXBGdW5jdGlvbnMsIHRhcmdldFByb3BlcnR5LCBsZWZ0LCByaWdodCkge1xuICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBJbnRlcnBvbGF0aW9uQmluZGluZykge1xuICAgICAgdGhpcy5wYXJlbnQgPSB0YXJnZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbGlkYXRlVGFyZ2V0KHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgICB0aGlzLnRhcmdldEFjY2Vzc29yID0gb2JzZXJ2ZXJMb2NhdG9yLmdldEFjY2Vzc29yKHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgIH1cbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMubW9kZSA9IG1vZGU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5sZWZ0ID0gbGVmdDtcbiAgICB0aGlzLnJpZ2h0ID0gcmlnaHQ7XG4gIH1cblxuICB1cGRhdGVUYXJnZXQodmFsdWUpIHtcbiAgICB2YWx1ZSA9IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyAnJyA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgaWYgKHZhbHVlICE9PSB0aGlzLnZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQuaW50ZXJwb2xhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3Iuc2V0VmFsdWUodGhpcy5sZWZ0ICsgdmFsdWUgKyB0aGlzLnJpZ2h0LCB0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY2FsbCgpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMucmF3VmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB0aGlzLnVwZGF0ZVRhcmdldCh0aGlzLnJhd1ZhbHVlKTtcblxuICAgIGlmICh0aGlzLm1vZGUgIT09IGJpbmRpbmdNb2RlLm9uZVRpbWUpIHtcbiAgICAgIHRoaXMuX3ZlcnNpb24rKztcbiAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICAgIGlmICh0aGlzLnJhd1ZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlQXJyYXkodGhpcy5yYXdWYWx1ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVub2JzZXJ2ZShmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgbGV0IHNvdXJjZUV4cHJlc3Npb24gPSB0aGlzLnNvdXJjZUV4cHJlc3Npb247XG4gICAgaWYgKHNvdXJjZUV4cHJlc3Npb24uYmluZCkge1xuICAgICAgc291cmNlRXhwcmVzc2lvbi5iaW5kKHRoaXMsIHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIH1cblxuICAgIHRoaXMucmF3VmFsdWUgPSBzb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIHRoaXMudXBkYXRlVGFyZ2V0KHRoaXMucmF3VmFsdWUpO1xuXG4gICAgaWYgKHRoaXMubW9kZSA9PT0gYmluZGluZ01vZGUub25lV2F5KSB7XG4gICAgICBlbnF1ZXVlQmluZGluZ0Nvbm5lY3QodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGxldCBzb3VyY2VFeHByZXNzaW9uID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uO1xuICAgIGlmIChzb3VyY2VFeHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgc291cmNlRXhwcmVzc2lvbi51bmJpbmQodGhpcywgdGhpcy5zb3VyY2UpO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy52YWx1ZSA9IG51bGw7XG4gICAgdGhpcy5yYXdWYWx1ZSA9IG51bGw7XG4gICAgdGhpcy51bm9ic2VydmUodHJ1ZSk7XG4gIH1cblxuICBjb25uZWN0KGV2YWx1YXRlKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2YWx1YXRlKSB7XG4gICAgICB0aGlzLnJhd1ZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgICB0aGlzLnVwZGF0ZVRhcmdldCh0aGlzLnJhd1ZhbHVlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zb3VyY2UpO1xuICAgIGlmICh0aGlzLnJhd1ZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZUFycmF5KHRoaXMucmF3VmFsdWUpO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzMik7XG5cbmV4cG9ydCBsZXQgTGV0RXhwcmVzc2lvbiA9IGNsYXNzIExldEV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBzb3VyY2VFeHByZXNzaW9uLCBsb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xuICB9XG5cbiAgY3JlYXRlQmluZGluZygpIHtcbiAgICByZXR1cm4gbmV3IExldEJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuc291cmNlRXhwcmVzc2lvbiwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5sb29rdXBGdW5jdGlvbnMsIHRoaXMudG9CaW5kaW5nQ29udGV4dCk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgTGV0QmluZGluZyA9IChfZGVjMiA9IGNvbm5lY3RhYmxlKCksIF9kZWMyKF9jbGFzczMgPSBjbGFzcyBMZXRCaW5kaW5nIHtcbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXRQcm9wZXJ0eSwgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gc291cmNlRXhwcmVzc2lvbjtcbiAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xuICB9XG5cbiAgdXBkYXRlVGFyZ2V0KCkge1xuICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgdGhpcy50YXJnZXRbdGhpcy50YXJnZXRQcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgfVxuXG4gIGNhbGwoY29udGV4dCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb250ZXh0ID09PSBzb3VyY2VDb250ZXh0KSB7XG4gICAgICB0aGlzLnVwZGF0ZVRhcmdldCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgY2FsbCBjb250ZXh0ICR7Y29udGV4dH1gKTtcbiAgfVxuXG4gIGJpbmQoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgIHRoaXMudGFyZ2V0ID0gdGhpcy50b0JpbmRpbmdDb250ZXh0ID8gc291cmNlLmJpbmRpbmdDb250ZXh0IDogc291cmNlLm92ZXJyaWRlQ29udGV4dDtcblxuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCkge1xuICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmJpbmQodGhpcywgc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuXG4gICAgZW5xdWV1ZUJpbmRpbmdDb25uZWN0KHRoaXMpO1xuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB0aGlzLnVub2JzZXJ2ZSh0cnVlKTtcbiAgfVxuXG4gIGNvbm5lY3QoKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVUYXJnZXQoKTtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uY29ubmVjdCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gIH1cbn0pIHx8IF9jbGFzczMpO1xuXG5leHBvcnQgbGV0IExldEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbiA9IGNsYXNzIExldEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG9ic2VydmVyTG9jYXRvciwgdGFyZ2V0UHJvcGVydHksIHBhcnRzLCBsb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgdGhpcy5wYXJ0cyA9IHBhcnRzO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICAgIHRoaXMudG9CaW5kaW5nQ29udGV4dCA9IHRvQmluZGluZ0NvbnRleHQ7XG4gIH1cblxuICBjcmVhdGVCaW5kaW5nKCkge1xuICAgIHJldHVybiBuZXcgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMudGFyZ2V0UHJvcGVydHksIHRoaXMucGFydHMsIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRvQmluZGluZ0NvbnRleHQpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IExldEludGVycG9sYXRpb25CaW5kaW5nID0gY2xhc3MgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmcge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBwYXJ0cywgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5wYXJ0cyA9IHBhcnRzO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgfVxuXG4gIGJpbmQoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgIHRoaXMudGFyZ2V0ID0gdGhpcy50b0JpbmRpbmdDb250ZXh0ID8gc291cmNlLmJpbmRpbmdDb250ZXh0IDogc291cmNlLm92ZXJyaWRlQ29udGV4dDtcblxuICAgIHRoaXMuaW50ZXJwb2xhdGlvbkJpbmRpbmcgPSB0aGlzLmNyZWF0ZUludGVycG9sYXRpb25CaW5kaW5nKCk7XG4gICAgdGhpcy5pbnRlcnBvbGF0aW9uQmluZGluZy5iaW5kKHNvdXJjZSk7XG4gIH1cblxuICB1bmJpbmQoKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB0aGlzLmludGVycG9sYXRpb25CaW5kaW5nLnVuYmluZCgpO1xuICAgIHRoaXMuaW50ZXJwb2xhdGlvbkJpbmRpbmcgPSBudWxsO1xuICB9XG5cbiAgY3JlYXRlSW50ZXJwb2xhdGlvbkJpbmRpbmcoKSB7XG4gICAgaWYgKHRoaXMucGFydHMubGVuZ3RoID09PSAzKSB7XG4gICAgICByZXR1cm4gbmV3IENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy50YXJnZXQsIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnBhcnRzWzFdLCBiaW5kaW5nTW9kZS5vbmVXYXksIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLnBhcnRzWzBdLCB0aGlzLnBhcnRzWzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0cywgdGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHksIGJpbmRpbmdNb2RlLm9uZVdheSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IFN5bnRheEludGVycHJldGVyID0gKF90ZW1wMiA9IF9jbGFzczQgPSBjbGFzcyBTeW50YXhJbnRlcnByZXRlciB7XG5cbiAgY29uc3RydWN0b3IocGFyc2VyLCBvYnNlcnZlckxvY2F0b3IsIGV2ZW50TWFuYWdlciwgYXR0cmlidXRlTWFwKSB7XG4gICAgdGhpcy5wYXJzZXIgPSBwYXJzZXI7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXI7XG4gICAgdGhpcy5hdHRyaWJ1dGVNYXAgPSBhdHRyaWJ1dGVNYXA7XG4gIH1cblxuICBpbnRlcnByZXQocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XG4gICAgaWYgKGluZm8uY29tbWFuZCBpbiB0aGlzKSB7XG4gICAgICByZXR1cm4gdGhpc1tpbmZvLmNvbW1hbmRdKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbiwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlVW5rbm93bkNvbW1hbmQocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgfVxuXG4gIGhhbmRsZVVua25vd25Db21tYW5kKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbiwgY29udGV4dCkge1xuICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmcnKS53YXJuKCdVbmtub3duIGJpbmRpbmcgY29tbWFuZC4nLCBpbmZvKTtcbiAgICByZXR1cm4gZXhpc3RpbmdJbnN0cnVjdGlvbjtcbiAgfVxuXG4gIGRldGVybWluZURlZmF1bHRCaW5kaW5nTW9kZShlbGVtZW50LCBhdHRyTmFtZSwgY29udGV4dCkge1xuICAgIGxldCB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAodGFnTmFtZSA9PT0gJ2lucHV0JyAmJiAoYXR0ck5hbWUgPT09ICd2YWx1ZScgfHwgYXR0ck5hbWUgPT09ICdmaWxlcycpICYmIGVsZW1lbnQudHlwZSAhPT0gJ2NoZWNrYm94JyAmJiBlbGVtZW50LnR5cGUgIT09ICdyYWRpbycgfHwgdGFnTmFtZSA9PT0gJ2lucHV0JyAmJiBhdHRyTmFtZSA9PT0gJ2NoZWNrZWQnICYmIChlbGVtZW50LnR5cGUgPT09ICdjaGVja2JveCcgfHwgZWxlbWVudC50eXBlID09PSAncmFkaW8nKSB8fCAodGFnTmFtZSA9PT0gJ3RleHRhcmVhJyB8fCB0YWdOYW1lID09PSAnc2VsZWN0JykgJiYgYXR0ck5hbWUgPT09ICd2YWx1ZScgfHwgKGF0dHJOYW1lID09PSAndGV4dGNvbnRlbnQnIHx8IGF0dHJOYW1lID09PSAnaW5uZXJodG1sJykgJiYgZWxlbWVudC5jb250ZW50RWRpdGFibGUgPT09ICd0cnVlJyB8fCBhdHRyTmFtZSA9PT0gJ3Njcm9sbHRvcCcgfHwgYXR0ck5hbWUgPT09ICdzY3JvbGxsZWZ0Jykge1xuICAgICAgcmV0dXJuIGJpbmRpbmdNb2RlLnR3b1dheTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCAmJiBhdHRyTmFtZSBpbiBjb250ZXh0LmF0dHJpYnV0ZXMgJiYgY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXSAmJiBjb250ZXh0LmF0dHJpYnV0ZXNbYXR0ck5hbWVdLmRlZmF1bHRCaW5kaW5nTW9kZSA+PSBiaW5kaW5nTW9kZS5vbmVUaW1lKSB7XG4gICAgICByZXR1cm4gY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXS5kZWZhdWx0QmluZGluZ01vZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJpbmRpbmdNb2RlLm9uZVdheTtcbiAgfVxuXG4gIGJpbmQocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID09PSB1bmRlZmluZWQgfHwgaW5mby5kZWZhdWx0QmluZGluZ01vZGUgPT09IG51bGwgPyB0aGlzLmRldGVybWluZURlZmF1bHRCaW5kaW5nTW9kZShlbGVtZW50LCBpbmZvLmF0dHJOYW1lLCBjb250ZXh0KSA6IGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcblxuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxuXG4gIHRyaWdnZXIocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvKSB7XG4gICAgcmV0dXJuIG5ldyBMaXN0ZW5lckV4cHJlc3Npb24odGhpcy5ldmVudE1hbmFnZXIsIGluZm8uYXR0ck5hbWUsIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgZGVsZWdhdGlvblN0cmF0ZWd5Lm5vbmUsIHRydWUsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9XG5cbiAgY2FwdHVyZShyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8pIHtcbiAgICByZXR1cm4gbmV3IExpc3RlbmVyRXhwcmVzc2lvbih0aGlzLmV2ZW50TWFuYWdlciwgaW5mby5hdHRyTmFtZSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBkZWxlZ2F0aW9uU3RyYXRlZ3kuY2FwdHVyaW5nLCB0cnVlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIGRlbGVnYXRlKHJlc291cmNlcywgZWxlbWVudCwgaW5mbykge1xuICAgIHJldHVybiBuZXcgTGlzdGVuZXJFeHByZXNzaW9uKHRoaXMuZXZlbnRNYW5hZ2VyLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGRlbGVnYXRpb25TdHJhdGVneS5idWJibGluZywgdHJ1ZSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBjYWxsKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IENhbGxFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgb3B0aW9ucyhyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcbiAgICBsZXQgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuICAgIGxldCBhdHRyVmFsdWUgPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICBsZXQgbGFuZ3VhZ2UgPSB0aGlzLmxhbmd1YWdlO1xuICAgIGxldCBuYW1lID0gbnVsbDtcbiAgICBsZXQgdGFyZ2V0ID0gJyc7XG4gICAgbGV0IGN1cnJlbnQ7XG4gICAgbGV0IGk7XG4gICAgbGV0IGlpO1xuICAgIGxldCBpblN0cmluZyA9IGZhbHNlO1xuICAgIGxldCBpbkVzY2FwZSA9IGZhbHNlO1xuICAgIGxldCBmb3VuZE5hbWUgPSBmYWxzZTtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gYXR0clZhbHVlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGN1cnJlbnQgPSBhdHRyVmFsdWVbaV07XG5cbiAgICAgIGlmIChjdXJyZW50ID09PSAnOycgJiYgIWluU3RyaW5nKSB7XG4gICAgICAgIGlmICghZm91bmROYW1lKSB7XG4gICAgICAgICAgbmFtZSA9IHRoaXMuX2dldFByaW1hcnlQcm9wZXJ0eU5hbWUocmVzb3VyY2VzLCBjb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvID0gbGFuZ3VhZ2UuaW5zcGVjdEF0dHJpYnV0ZShyZXNvdXJjZXMsICc/JywgbmFtZSwgdGFyZ2V0LnRyaW0oKSk7XG4gICAgICAgIGxhbmd1YWdlLmNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgaW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xuXG4gICAgICAgIGlmICghaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSkge1xuICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhcmdldCA9ICcnO1xuICAgICAgICBuYW1lID0gbnVsbDtcbiAgICAgIH0gZWxzZSBpZiAoY3VycmVudCA9PT0gJzonICYmIG5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgZm91bmROYW1lID0gdHJ1ZTtcbiAgICAgICAgbmFtZSA9IHRhcmdldC50cmltKCk7XG4gICAgICAgIHRhcmdldCA9ICcnO1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50ID09PSAnXFxcXCcpIHtcbiAgICAgICAgdGFyZ2V0ICs9IGN1cnJlbnQ7XG4gICAgICAgIGluRXNjYXBlID0gdHJ1ZTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXQgKz0gY3VycmVudDtcblxuICAgICAgICBpZiAobmFtZSAhPT0gbnVsbCAmJiBpbkVzY2FwZSA9PT0gZmFsc2UgJiYgY3VycmVudCA9PT0gJ1xcJycpIHtcbiAgICAgICAgICBpblN0cmluZyA9ICFpblN0cmluZztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpbkVzY2FwZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmICghZm91bmROYW1lKSB7XG4gICAgICBuYW1lID0gdGhpcy5fZ2V0UHJpbWFyeVByb3BlcnR5TmFtZShyZXNvdXJjZXMsIGNvbnRleHQpO1xuICAgIH1cblxuICAgIGlmIChuYW1lICE9PSBudWxsKSB7XG4gICAgICBpbmZvID0gbGFuZ3VhZ2UuaW5zcGVjdEF0dHJpYnV0ZShyZXNvdXJjZXMsICc/JywgbmFtZSwgdGFyZ2V0LnRyaW0oKSk7XG4gICAgICBsYW5ndWFnZS5jcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbihyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGluc3RydWN0aW9uLCBjb250ZXh0KTtcblxuICAgICAgaWYgKCFpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdKSB7XG4gICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBfZ2V0UHJpbWFyeVByb3BlcnR5TmFtZShyZXNvdXJjZXMsIGNvbnRleHQpIHtcbiAgICBsZXQgdHlwZSA9IHJlc291cmNlcy5nZXRBdHRyaWJ1dGUoY29udGV4dC5hdHRyaWJ1dGVOYW1lKTtcbiAgICBpZiAodHlwZSAmJiB0eXBlLnByaW1hcnlQcm9wZXJ0eSkge1xuICAgICAgcmV0dXJuIHR5cGUucHJpbWFyeVByb3BlcnR5LmF0dHJpYnV0ZTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAnZm9yJyhyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcbiAgICBsZXQgcGFydHM7XG4gICAgbGV0IGtleVZhbHVlO1xuICAgIGxldCBpbnN0cnVjdGlvbjtcbiAgICBsZXQgYXR0clZhbHVlO1xuICAgIGxldCBpc0Rlc3RydWN0dXJpbmc7XG5cbiAgICBhdHRyVmFsdWUgPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICBpc0Rlc3RydWN0dXJpbmcgPSBhdHRyVmFsdWUubWF0Y2goL14gKltbXS4rW1xcXV0vKTtcbiAgICBwYXJ0cyA9IGlzRGVzdHJ1Y3R1cmluZyA/IGF0dHJWYWx1ZS5zcGxpdCgnb2YgJykgOiBhdHRyVmFsdWUuc3BsaXQoJyBvZiAnKTtcblxuICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW5jb3JyZWN0IHN5bnRheCBmb3IgXCJmb3JcIi4gVGhlIGZvcm0gaXM6IFwiJGxvY2FsIG9mICRpdGVtc1wiIG9yIFwiWyRrZXksICR2YWx1ZV0gb2YgJGl0ZW1zXCIuJyk7XG4gICAgfVxuXG4gICAgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuXG4gICAgaWYgKGlzRGVzdHJ1Y3R1cmluZykge1xuICAgICAga2V5VmFsdWUgPSBwYXJ0c1swXS5yZXBsYWNlKC9bW1xcXV0vZywgJycpLnJlcGxhY2UoLywvZywgJyAnKS5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpLnNwbGl0KCcgJyk7XG4gICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzLmtleSA9IGtleVZhbHVlWzBdO1xuICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy52YWx1ZSA9IGtleVZhbHVlWzFdO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzLmxvY2FsID0gcGFydHNbMF07XG4gICAgfVxuXG4gICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy5pdGVtcyA9IG5ldyBCaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ2l0ZW1zJywgdGhpcy5wYXJzZXIucGFyc2UocGFydHNbMV0pLCBiaW5kaW5nTW9kZS5vbmVXYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgJ3R3by13YXknKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudC50YWdOYW1lLCBpbmZvLmF0dHJOYW1lKSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBiaW5kaW5nTW9kZS50d29XYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgJ3RvLXZpZXcnKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudC50YWdOYW1lLCBpbmZvLmF0dHJOYW1lKSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBiaW5kaW5nTW9kZS50b1ZpZXcsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgJ2Zyb20tdmlldycocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uKSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGJpbmRpbmdNb2RlLmZyb21WaWV3LCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcblxuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxuXG4gICdvbmUtdGltZScocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uKSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGJpbmRpbmdNb2RlLm9uZVRpbWUsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG59LCBfY2xhc3M0LmluamVjdCA9IFtQYXJzZXIsIE9ic2VydmVyTG9jYXRvciwgRXZlbnRNYW5hZ2VyLCBBdHRyaWJ1dGVNYXBdLCBfdGVtcDIpO1xuXG5TeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGVbJ29uZS13YXknXSA9IFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsndG8tdmlldyddO1xuXG5sZXQgaW5mbyA9IHt9O1xuXG5leHBvcnQgbGV0IFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgPSAoX3RlbXAzID0gX2NsYXNzNSA9IGNsYXNzIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgZXh0ZW5kcyBCaW5kaW5nTGFuZ3VhZ2Uge1xuXG4gIGNvbnN0cnVjdG9yKHBhcnNlciwgb2JzZXJ2ZXJMb2NhdG9yLCBzeW50YXhJbnRlcnByZXRlciwgYXR0cmlidXRlTWFwKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnBhcnNlciA9IHBhcnNlcjtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnN5bnRheEludGVycHJldGVyID0gc3ludGF4SW50ZXJwcmV0ZXI7XG4gICAgdGhpcy5lbXB0eVN0cmluZ0V4cHJlc3Npb24gPSB0aGlzLnBhcnNlci5wYXJzZSgnXFwnXFwnJyk7XG4gICAgc3ludGF4SW50ZXJwcmV0ZXIubGFuZ3VhZ2UgPSB0aGlzO1xuICAgIHRoaXMuYXR0cmlidXRlTWFwID0gYXR0cmlidXRlTWFwO1xuICAgIHRoaXMudG9CaW5kaW5nQ29udGV4dEF0dHIgPSAndG8tYmluZGluZy1jb250ZXh0JztcbiAgfVxuXG4gIGluc3BlY3RBdHRyaWJ1dGUocmVzb3VyY2VzLCBlbGVtZW50TmFtZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSkge1xuICAgIGxldCBwYXJ0cyA9IGF0dHJOYW1lLnNwbGl0KCcuJyk7XG5cbiAgICBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSA9IG51bGw7XG5cbiAgICBpZiAocGFydHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBpbmZvLmF0dHJOYW1lID0gcGFydHNbMF0udHJpbSgpO1xuICAgICAgaW5mby5hdHRyVmFsdWUgPSBhdHRyVmFsdWU7XG4gICAgICBpbmZvLmNvbW1hbmQgPSBwYXJ0c1sxXS50cmltKCk7XG5cbiAgICAgIGlmIChpbmZvLmNvbW1hbmQgPT09ICdyZWYnKSB7XG4gICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG5ldyBOYW1lRXhwcmVzc2lvbih0aGlzLnBhcnNlci5wYXJzZShhdHRyVmFsdWUpLCBpbmZvLmF0dHJOYW1lLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICAgICAgaW5mby5jb21tYW5kID0gbnVsbDtcbiAgICAgICAgaW5mby5hdHRyTmFtZSA9ICdyZWYnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5mby5leHByZXNzaW9uID0gbnVsbDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGF0dHJOYW1lID09PSAncmVmJykge1xuICAgICAgaW5mby5hdHRyTmFtZSA9IGF0dHJOYW1lO1xuICAgICAgaW5mby5hdHRyVmFsdWUgPSBhdHRyVmFsdWU7XG4gICAgICBpbmZvLmNvbW1hbmQgPSBudWxsO1xuICAgICAgaW5mby5leHByZXNzaW9uID0gbmV3IE5hbWVFeHByZXNzaW9uKHRoaXMucGFyc2VyLnBhcnNlKGF0dHJWYWx1ZSksICdlbGVtZW50JywgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGluZm8uYXR0ck5hbWUgPSBhdHRyTmFtZTtcbiAgICAgIGluZm8uYXR0clZhbHVlID0gYXR0clZhbHVlO1xuICAgICAgaW5mby5jb21tYW5kID0gbnVsbDtcbiAgICAgIGNvbnN0IGludGVycG9sYXRpb25QYXJ0cyA9IHRoaXMucGFyc2VJbnRlcnBvbGF0aW9uKHJlc291cmNlcywgYXR0clZhbHVlKTtcbiAgICAgIGlmIChpbnRlcnBvbGF0aW9uUGFydHMgPT09IG51bGwpIHtcbiAgICAgICAgaW5mby5leHByZXNzaW9uID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50TmFtZSwgYXR0ck5hbWUpLCBpbnRlcnBvbGF0aW9uUGFydHMsIGJpbmRpbmdNb2RlLm9uZVdheSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgYXR0ck5hbWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbmZvO1xuICB9XG5cbiAgY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24ocmVzb3VyY2VzLCBlbGVtZW50LCB0aGVJbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XG4gICAgbGV0IGluc3RydWN0aW9uO1xuXG4gICAgaWYgKHRoZUluZm8uZXhwcmVzc2lvbikge1xuICAgICAgaWYgKHRoZUluZm8uYXR0ck5hbWUgPT09ICdyZWYnKSB7XG4gICAgICAgIHJldHVybiB0aGVJbmZvLmV4cHJlc3Npb247XG4gICAgICB9XG5cbiAgICAgIGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZSh0aGVJbmZvLmF0dHJOYW1lKTtcbiAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbdGhlSW5mby5hdHRyTmFtZV0gPSB0aGVJbmZvLmV4cHJlc3Npb247XG4gICAgfSBlbHNlIGlmICh0aGVJbmZvLmNvbW1hbmQpIHtcbiAgICAgIGluc3RydWN0aW9uID0gdGhpcy5zeW50YXhJbnRlcnByZXRlci5pbnRlcnByZXQocmVzb3VyY2VzLCBlbGVtZW50LCB0aGVJbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBjcmVhdGVMZXRFeHByZXNzaW9ucyhyZXNvdXJjZXMsIGxldEVsZW1lbnQpIHtcbiAgICBsZXQgZXhwcmVzc2lvbnMgPSBbXTtcbiAgICBsZXQgYXR0cmlidXRlcyA9IGxldEVsZW1lbnQuYXR0cmlidXRlcztcblxuICAgIGxldCBhdHRyO1xuXG4gICAgbGV0IHBhcnRzO1xuICAgIGxldCBhdHRyTmFtZTtcbiAgICBsZXQgYXR0clZhbHVlO1xuICAgIGxldCBjb21tYW5kO1xuICAgIGxldCB0b0JpbmRpbmdDb250ZXh0QXR0ciA9IHRoaXMudG9CaW5kaW5nQ29udGV4dEF0dHI7XG4gICAgbGV0IHRvQmluZGluZ0NvbnRleHQgPSBsZXRFbGVtZW50Lmhhc0F0dHJpYnV0ZSh0b0JpbmRpbmdDb250ZXh0QXR0cik7XG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gYXR0cmlidXRlcy5sZW5ndGg7IGlpID4gaTsgKytpKSB7XG4gICAgICBhdHRyID0gYXR0cmlidXRlc1tpXTtcbiAgICAgIGF0dHJOYW1lID0gYXR0ci5uYW1lO1xuICAgICAgYXR0clZhbHVlID0gYXR0ci5ub2RlVmFsdWU7XG4gICAgICBwYXJ0cyA9IGF0dHJOYW1lLnNwbGl0KCcuJyk7XG5cbiAgICAgIGlmIChhdHRyTmFtZSA9PT0gdG9CaW5kaW5nQ29udGV4dEF0dHIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgY29tbWFuZCA9IHBhcnRzWzFdO1xuICAgICAgICBpZiAoY29tbWFuZCAhPT0gJ2JpbmQnKSB7XG4gICAgICAgICAgTG9nTWFuYWdlci5nZXRMb2dnZXIoJ3RlbXBsYXRpbmctYmluZGluZy1sYW5ndWFnZScpLndhcm4oYERldGVjdGVkIGludmFsaWQgbGV0IGNvbW1hbmQuIEV4cGVjdGVkIFwiJHtwYXJ0c1swXX0uYmluZFwiLCBnaXZlbiBcIiR7YXR0ck5hbWV9XCJgKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBleHByZXNzaW9ucy5wdXNoKG5ldyBMZXRFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBjYW1lbENhc2UocGFydHNbMF0pLCB0aGlzLnBhcnNlci5wYXJzZShhdHRyVmFsdWUpLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdHRyTmFtZSA9IGNhbWVsQ2FzZShhdHRyTmFtZSk7XG4gICAgICAgIHBhcnRzID0gdGhpcy5wYXJzZUludGVycG9sYXRpb24ocmVzb3VyY2VzLCBhdHRyVmFsdWUpO1xuICAgICAgICBpZiAocGFydHMgPT09IG51bGwpIHtcbiAgICAgICAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZy1iaW5kaW5nLWxhbmd1YWdlJykud2FybihgRGV0ZWN0ZWQgc3RyaW5nIGxpdGVyYWwgaW4gbGV0IGJpbmRpbmdzLiBEaWQgeW91IG1lYW4gXCIke2F0dHJOYW1lfS5iaW5kPSR7YXR0clZhbHVlfVwiIG9yIFwiJHthdHRyTmFtZX09XFwkeyR7YXR0clZhbHVlfX1cIiA/YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcnRzKSB7XG4gICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChuZXcgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBhdHRyTmFtZSwgcGFydHMsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBleHByZXNzaW9ucy5wdXNoKG5ldyBMZXRFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBhdHRyTmFtZSwgbmV3IExpdGVyYWxTdHJpbmcoYXR0clZhbHVlKSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgdG9CaW5kaW5nQ29udGV4dCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBleHByZXNzaW9ucztcbiAgfVxuXG4gIGluc3BlY3RUZXh0Q29udGVudChyZXNvdXJjZXMsIHZhbHVlKSB7XG4gICAgY29uc3QgcGFydHMgPSB0aGlzLnBhcnNlSW50ZXJwb2xhdGlvbihyZXNvdXJjZXMsIHZhbHVlKTtcbiAgICBpZiAocGFydHMgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ3RleHRDb250ZW50JywgcGFydHMsIGJpbmRpbmdNb2RlLm9uZVdheSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgJ3RleHRDb250ZW50Jyk7XG4gIH1cblxuICBwYXJzZUludGVycG9sYXRpb24ocmVzb3VyY2VzLCB2YWx1ZSkge1xuICAgIGxldCBpID0gdmFsdWUuaW5kZXhPZignJHsnLCAwKTtcbiAgICBsZXQgaWkgPSB2YWx1ZS5sZW5ndGg7XG4gICAgbGV0IGNoYXI7XG4gICAgbGV0IHBvcyA9IDA7XG4gICAgbGV0IG9wZW4gPSAwO1xuICAgIGxldCBxdW90ZSA9IG51bGw7XG4gICAgbGV0IGludGVycG9sYXRpb25TdGFydDtcbiAgICBsZXQgcGFydHM7XG4gICAgbGV0IHBhcnRJbmRleCA9IDA7XG5cbiAgICB3aGlsZSAoaSA+PSAwICYmIGkgPCBpaSAtIDIpIHtcbiAgICAgIG9wZW4gPSAxO1xuICAgICAgaW50ZXJwb2xhdGlvblN0YXJ0ID0gaTtcbiAgICAgIGkgKz0gMjtcblxuICAgICAgZG8ge1xuICAgICAgICBjaGFyID0gdmFsdWVbaV07XG4gICAgICAgIGkrKztcblxuICAgICAgICBpZiAoY2hhciA9PT0gXCInXCIgfHwgY2hhciA9PT0gJ1wiJykge1xuICAgICAgICAgIGlmIChxdW90ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcXVvdGUgPSBjaGFyO1xuICAgICAgICAgIH0gZWxzZSBpZiAocXVvdGUgPT09IGNoYXIpIHtcbiAgICAgICAgICAgIHF1b3RlID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XG4gICAgICAgICAgaSsrO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHF1b3RlICE9PSBudWxsKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hhciA9PT0gJ3snKSB7XG4gICAgICAgICAgb3BlbisrO1xuICAgICAgICB9IGVsc2UgaWYgKGNoYXIgPT09ICd9Jykge1xuICAgICAgICAgIG9wZW4tLTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAob3BlbiA+IDAgJiYgaSA8IGlpKTtcblxuICAgICAgaWYgKG9wZW4gPT09IDApIHtcbiAgICAgICAgcGFydHMgPSBwYXJ0cyB8fCBbXTtcbiAgICAgICAgaWYgKHZhbHVlW2ludGVycG9sYXRpb25TdGFydCAtIDFdID09PSAnXFxcXCcgJiYgdmFsdWVbaW50ZXJwb2xhdGlvblN0YXJ0IC0gMl0gIT09ICdcXFxcJykge1xuICAgICAgICAgIHBhcnRzW3BhcnRJbmRleF0gPSB2YWx1ZS5zdWJzdHJpbmcocG9zLCBpbnRlcnBvbGF0aW9uU3RhcnQgLSAxKSArIHZhbHVlLnN1YnN0cmluZyhpbnRlcnBvbGF0aW9uU3RhcnQsIGkpO1xuICAgICAgICAgIHBhcnRJbmRleCsrO1xuICAgICAgICAgIHBhcnRzW3BhcnRJbmRleF0gPSB0aGlzLmVtcHR5U3RyaW5nRXhwcmVzc2lvbjtcbiAgICAgICAgICBwYXJ0SW5kZXgrKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyaW5nKHBvcywgaW50ZXJwb2xhdGlvblN0YXJ0KTtcbiAgICAgICAgICBwYXJ0SW5kZXgrKztcbiAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdGhpcy5wYXJzZXIucGFyc2UodmFsdWUuc3Vic3RyaW5nKGludGVycG9sYXRpb25TdGFydCArIDIsIGkgLSAxKSk7XG4gICAgICAgICAgcGFydEluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgcG9zID0gaTtcbiAgICAgICAgaSA9IHZhbHVlLmluZGV4T2YoJyR7JywgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocGFydEluZGV4ID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyKHBvcyk7XG4gICAgcmV0dXJuIHBhcnRzO1xuICB9XG59LCBfY2xhc3M1LmluamVjdCA9IFtQYXJzZXIsIE9ic2VydmVyTG9jYXRvciwgU3ludGF4SW50ZXJwcmV0ZXIsIEF0dHJpYnV0ZU1hcF0sIF90ZW1wMyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XG4gIGNvbmZpZy5jb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b24oQmluZGluZ0xhbmd1YWdlLCBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlKTtcbiAgY29uZmlnLmNvbnRhaW5lci5yZWdpc3RlckFsaWFzKEJpbmRpbmdMYW5ndWFnZSwgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZSk7XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-templating-binding\n");

/***/ }),

/***/ "aurelia-templating-resources":
/*!***********************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-resources/dist/es2015/aurelia-templating-resources.js ***!
  \***********************************************************************************************/
/*! exports provided: AbstractRepeater, ArrayRepeatStrategy, AttrBindingBehavior, BindingSignaler, Compose, DebounceBindingBehavior, Else, Focus, FromViewBindingBehavior, HTMLSanitizer, Hide, If, MapRepeatStrategy, NullRepeatStrategy, NumberRepeatStrategy, OneTimeBindingBehavior, OneWayBindingBehavior, Repeat, RepeatStrategyLocator, Replaceable, SanitizeHTMLValueConverter, SelfBindingBehavior, SetRepeatStrategy, Show, SignalBindingBehavior, ThrottleBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior, UpdateTriggerBindingBehavior, With, configure, createFullOverrideContext, getItemsSourceExpression, isOneTime, unwrapExpression, updateOneTimeBinding, updateOverrideContext, viewsRequireLifecycle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractRepeater\", function() { return AbstractRepeater; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArrayRepeatStrategy\", function() { return ArrayRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttrBindingBehavior\", function() { return AttrBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingSignaler\", function() { return BindingSignaler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Compose\", function() { return Compose; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DebounceBindingBehavior\", function() { return DebounceBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Else\", function() { return Else; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Focus\", function() { return Focus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FromViewBindingBehavior\", function() { return FromViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HTMLSanitizer\", function() { return HTMLSanitizer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Hide\", function() { return Hide; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"If\", function() { return If; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MapRepeatStrategy\", function() { return MapRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullRepeatStrategy\", function() { return NullRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NumberRepeatStrategy\", function() { return NumberRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneTimeBindingBehavior\", function() { return OneTimeBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneWayBindingBehavior\", function() { return OneWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Repeat\", function() { return Repeat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RepeatStrategyLocator\", function() { return RepeatStrategyLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Replaceable\", function() { return Replaceable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SanitizeHTMLValueConverter\", function() { return SanitizeHTMLValueConverter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SelfBindingBehavior\", function() { return SelfBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SetRepeatStrategy\", function() { return SetRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Show\", function() { return Show; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SignalBindingBehavior\", function() { return SignalBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ThrottleBindingBehavior\", function() { return ThrottleBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ToViewBindingBehavior\", function() { return ToViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TwoWayBindingBehavior\", function() { return TwoWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UpdateTriggerBindingBehavior\", function() { return UpdateTriggerBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"With\", function() { return With; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure$1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFullOverrideContext\", function() { return createFullOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemsSourceExpression\", function() { return getItemsSourceExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isOneTime\", function() { return isOneTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unwrapExpression\", function() { return unwrapExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOneTimeBinding\", function() { return updateOneTimeBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOverrideContext\", function() { return updateOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewsRequireLifecycle\", function() { return viewsRequireLifecycle; });\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-dependency-injection */ \"OeXm\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"xIXs\");\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-task-queue */ \"aWZo\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"SkM8\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-binding */ \"NDtI\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-logging */ \"KKpb\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-loader */ \"489m\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-path */ \"n+sw\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aurelia-metadata */ \"SGXf\");\n\n\n\n\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar ActivationStrategy;\r\n(function (ActivationStrategy) {\r\n    ActivationStrategy[\"InvokeLifecycle\"] = \"invoke-lifecycle\";\r\n    ActivationStrategy[\"Replace\"] = \"replace\";\r\n})(ActivationStrategy || (ActivationStrategy = {}));\r\nlet Compose = class Compose {\r\n    constructor(element, container, compositionEngine, viewSlot, viewResources, taskQueue) {\r\n        this.activationStrategy = ActivationStrategy.InvokeLifecycle;\r\n        this.element = element;\r\n        this.container = container;\r\n        this.compositionEngine = compositionEngine;\r\n        this.viewSlot = viewSlot;\r\n        this.viewResources = viewResources;\r\n        this.taskQueue = taskQueue;\r\n        this.currentController = null;\r\n        this.currentViewModel = null;\r\n        this.changes = Object.create(null);\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    }\r\n    created(owningView) {\r\n        this.owningView = owningView;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n        let changes = this.changes;\r\n        changes.view = this.view;\r\n        changes.viewModel = this.viewModel;\r\n        changes.model = this.model;\r\n        if (!this.pendingTask) {\r\n            processChanges(this);\r\n        }\r\n    }\r\n    unbind() {\r\n        this.changes = Object.create(null);\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        let returnToCache = true;\r\n        let skipAnimation = true;\r\n        this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    }\r\n    modelChanged(newValue, oldValue) {\r\n        this.changes.model = newValue;\r\n        requestUpdate(this);\r\n    }\r\n    viewChanged(newValue, oldValue) {\r\n        this.changes.view = newValue;\r\n        requestUpdate(this);\r\n    }\r\n    viewModelChanged(newValue, oldValue) {\r\n        this.changes.viewModel = newValue;\r\n        requestUpdate(this);\r\n    }\r\n};\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"model\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"view\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"viewModel\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"activationStrategy\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"swapOrder\", void 0);\r\nCompose = __decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"noView\"],\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])('compose')\r\n], Compose);\r\nfunction isEmpty(obj) {\r\n    for (const _ in obj) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nfunction tryActivateViewModel(vm, model) {\r\n    if (vm && typeof vm.activate === 'function') {\r\n        return Promise.resolve(vm.activate(model));\r\n    }\r\n}\r\nfunction createInstruction(composer, instruction) {\r\n    return Object.assign(instruction, {\r\n        bindingContext: composer.bindingContext,\r\n        overrideContext: composer.overrideContext,\r\n        owningView: composer.owningView,\r\n        container: composer.container,\r\n        viewSlot: composer.viewSlot,\r\n        viewResources: composer.viewResources,\r\n        currentController: composer.currentController,\r\n        host: composer.element,\r\n        swapOrder: composer.swapOrder\r\n    });\r\n}\r\nfunction processChanges(composer) {\r\n    const changes = composer.changes;\r\n    composer.changes = Object.create(null);\r\n    if (needsReInitialization(composer, changes)) {\r\n        let instruction = {\r\n            view: composer.view,\r\n            viewModel: composer.currentViewModel || composer.viewModel,\r\n            model: composer.model\r\n        };\r\n        instruction = Object.assign(instruction, changes);\r\n        instruction = createInstruction(composer, instruction);\r\n        composer.pendingTask = composer.compositionEngine.compose(instruction).then(controller => {\r\n            composer.currentController = controller;\r\n            composer.currentViewModel = controller ? controller.viewModel : null;\r\n        });\r\n    }\r\n    else {\r\n        composer.pendingTask = tryActivateViewModel(composer.currentViewModel, changes.model);\r\n        if (!composer.pendingTask) {\r\n            return;\r\n        }\r\n    }\r\n    composer.pendingTask = composer.pendingTask\r\n        .then(() => {\r\n        completeCompositionTask(composer);\r\n    }, reason => {\r\n        completeCompositionTask(composer);\r\n        throw reason;\r\n    });\r\n}\r\nfunction completeCompositionTask(composer) {\r\n    composer.pendingTask = null;\r\n    if (!isEmpty(composer.changes)) {\r\n        processChanges(composer);\r\n    }\r\n}\r\nfunction requestUpdate(composer) {\r\n    if (composer.pendingTask || composer.updateRequested) {\r\n        return;\r\n    }\r\n    composer.updateRequested = true;\r\n    composer.taskQueue.queueMicroTask(() => {\r\n        composer.updateRequested = false;\r\n        processChanges(composer);\r\n    });\r\n}\r\nfunction needsReInitialization(composer, changes) {\r\n    let activationStrategy = composer.activationStrategy;\r\n    const vm = composer.currentViewModel;\r\n    if (vm && typeof vm.determineActivationStrategy === 'function') {\r\n        activationStrategy = vm.determineActivationStrategy();\r\n    }\r\n    return 'view' in changes\r\n        || 'viewModel' in changes\r\n        || activationStrategy === ActivationStrategy.Replace;\r\n}\n\nclass IfCore {\r\n    constructor(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        this.showing = false;\r\n        this.cache = true;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    }\r\n    unbind() {\r\n        if (this.view === null) {\r\n            return;\r\n        }\r\n        this.view.unbind();\r\n        if (!this.viewFactory.isCaching) {\r\n            return;\r\n        }\r\n        if (this.showing) {\r\n            this.showing = false;\r\n            this.viewSlot.remove(this.view, true, true);\r\n        }\r\n        else {\r\n            this.view.returnToCache();\r\n        }\r\n        this.view = null;\r\n    }\r\n    _show() {\r\n        if (this.showing) {\r\n            if (!this.view.isBound) {\r\n                this.view.bind(this.bindingContext, this.overrideContext);\r\n            }\r\n            return;\r\n        }\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n        }\r\n        if (!this.view.isBound) {\r\n            this.view.bind(this.bindingContext, this.overrideContext);\r\n        }\r\n        this.showing = true;\r\n        return this.viewSlot.add(this.view);\r\n    }\r\n    _hide() {\r\n        if (!this.showing) {\r\n            return;\r\n        }\r\n        this.showing = false;\r\n        let removed = this.viewSlot.remove(this.view);\r\n        if (removed instanceof Promise) {\r\n            return removed.then(() => {\r\n                this._unbindView();\r\n            });\r\n        }\r\n        this._unbindView();\r\n    }\r\n    _unbindView() {\r\n        const cache = this.cache === 'false' ? false : !!this.cache;\r\n        this.view.unbind();\r\n        if (!cache) {\r\n            this.view = null;\r\n        }\r\n    }\r\n}\n\nlet If = class If extends IfCore {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.cache = true;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        super.bind(bindingContext, overrideContext);\r\n        if (this.condition) {\r\n            this._show();\r\n        }\r\n        else {\r\n            this._hide();\r\n        }\r\n    }\r\n    conditionChanged(newValue) {\r\n        this._update(newValue);\r\n    }\r\n    _update(show) {\r\n        if (this.animating) {\r\n            return;\r\n        }\r\n        let promise;\r\n        if (this.elseVm) {\r\n            promise = show ? this._swap(this.elseVm, this) : this._swap(this, this.elseVm);\r\n        }\r\n        else {\r\n            promise = show ? this._show() : this._hide();\r\n        }\r\n        if (promise) {\r\n            this.animating = true;\r\n            promise.then(() => {\r\n                this.animating = false;\r\n                if (this.condition !== this.showing) {\r\n                    this._update(this.condition);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _swap(remove, add) {\r\n        switch (this.swapOrder) {\r\n            case 'before':\r\n                return Promise.resolve(add._show()).then(() => remove._hide());\r\n            case 'with':\r\n                return Promise.all([remove._hide(), add._show()]);\r\n            default:\r\n                let promise = remove._hide();\r\n                return promise ? promise.then(() => add._show()) : add._show();\r\n        }\r\n    }\r\n};\r\n__decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])({ primaryProperty: true })\r\n], If.prototype, \"condition\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], If.prototype, \"swapOrder\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], If.prototype, \"cache\", void 0);\r\nIf = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('if'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], If);\n\nlet Else = class Else extends IfCore {\r\n    constructor(viewFactory, viewSlot) {\r\n        super(viewFactory, viewSlot);\r\n        this._registerInIf();\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        super.bind(bindingContext, overrideContext);\r\n        if (this.ifVm.condition) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n    }\r\n    _registerInIf() {\r\n        let previous = this.viewSlot.anchor.previousSibling;\r\n        while (previous && !previous.au) {\r\n            previous = previous.previousSibling;\r\n        }\r\n        if (!previous || !previous.au.if) {\r\n            throw new Error(\"Can't find matching If for Else custom attribute.\");\r\n        }\r\n        this.ifVm = previous.au.if.viewModel;\r\n        this.ifVm.elseVm = this;\r\n    }\r\n};\r\nElse = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('else'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], Else);\n\nlet With = class With {\r\n    constructor(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.parentOverrideContext = null;\r\n        this.view = null;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.parentOverrideContext = overrideContext;\r\n        this.valueChanged(this.value);\r\n    }\r\n    valueChanged(newValue) {\r\n        let overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(newValue, this.parentOverrideContext);\r\n        let view = this.view;\r\n        if (!view) {\r\n            view = this.view = this.viewFactory.create();\r\n            view.bind(newValue, overrideContext);\r\n            this.viewSlot.add(view);\r\n        }\r\n        else {\r\n            view.bind(newValue, overrideContext);\r\n        }\r\n    }\r\n    unbind() {\r\n        let view = this.view;\r\n        this.parentOverrideContext = null;\r\n        if (view) {\r\n            view.unbind();\r\n        }\r\n    }\r\n};\r\nWith = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('with'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], With);\n\nconst oneTime = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\nfunction updateOverrideContexts(views, startIndex) {\r\n    let length = views.length;\r\n    if (startIndex > 0) {\r\n        startIndex = startIndex - 1;\r\n    }\r\n    for (; startIndex < length; ++startIndex) {\r\n        updateOverrideContext(views[startIndex].overrideContext, startIndex, length);\r\n    }\r\n}\r\nfunction createFullOverrideContext(repeat, data, index, length, key) {\r\n    let bindingContext = {};\r\n    let overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(bindingContext, repeat.scope.overrideContext);\r\n    if (typeof key !== 'undefined') {\r\n        bindingContext[repeat.key] = key;\r\n        bindingContext[repeat.value] = data;\r\n    }\r\n    else {\r\n        bindingContext[repeat.local] = data;\r\n    }\r\n    updateOverrideContext(overrideContext, index, length);\r\n    return overrideContext;\r\n}\r\nfunction updateOverrideContext(overrideContext, index, length) {\r\n    let first = (index === 0);\r\n    let last = (index === length - 1);\r\n    let even = index % 2 === 0;\r\n    overrideContext.$index = index;\r\n    overrideContext.$first = first;\r\n    overrideContext.$last = last;\r\n    overrideContext.$middle = !(first || last);\r\n    overrideContext.$odd = !even;\r\n    overrideContext.$even = even;\r\n}\r\nfunction getItemsSourceExpression(instruction, attrName) {\r\n    return instruction.behaviorInstructions\r\n        .filter(bi => bi.originalAttrName === attrName)[0]\r\n        .attributes\r\n        .items\r\n        .sourceExpression;\r\n}\r\nfunction unwrapExpression(expression) {\r\n    let unwrapped = false;\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        expression = expression.expression;\r\n    }\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ValueConverter\"]) {\r\n        expression = expression.expression;\r\n        unwrapped = true;\r\n    }\r\n    return unwrapped ? expression : null;\r\n}\r\nfunction isOneTime(expression) {\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        if (expression.name === 'oneTime') {\r\n            return true;\r\n        }\r\n        expression = expression.expression;\r\n    }\r\n    return false;\r\n}\r\nfunction updateOneTimeBinding(binding) {\r\n    if (binding.call && binding.mode === oneTime) {\r\n        binding.call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n    }\r\n    else if (binding.updateOneTimeBindings) {\r\n        binding.updateOneTimeBindings();\r\n    }\r\n}\r\nfunction indexOf(array, item, matcher, startIndex) {\r\n    if (!matcher) {\r\n        return array.indexOf(item);\r\n    }\r\n    const length = array.length;\r\n    for (let index = startIndex || 0; index < length; index++) {\r\n        if (matcher(array[index], item)) {\r\n            return index;\r\n        }\r\n    }\r\n    return -1;\r\n}\n\nclass ArrayRepeatStrategy {\r\n    getCollectionObserver(observerLocator, items) {\r\n        return observerLocator.getArrayObserver(items);\r\n    }\r\n    instanceChanged(repeat, items) {\r\n        const $repeat = repeat;\r\n        const itemsLength = items.length;\r\n        if (!items || itemsLength === 0) {\r\n            $repeat.removeAllViews(true, !$repeat.viewsRequireLifecycle);\r\n            return;\r\n        }\r\n        const children = $repeat.views();\r\n        const viewsLength = children.length;\r\n        if (viewsLength === 0) {\r\n            this._standardProcessInstanceChanged($repeat, items);\r\n            return;\r\n        }\r\n        if ($repeat.viewsRequireLifecycle) {\r\n            const childrenSnapshot = children.slice(0);\r\n            const itemNameInBindingContext = $repeat.local;\r\n            const matcher = $repeat.matcher();\r\n            let itemsPreviouslyInViews = [];\r\n            const viewsToRemove = [];\r\n            for (let index = 0; index < viewsLength; index++) {\r\n                const view = childrenSnapshot[index];\r\n                const oldItem = view.bindingContext[itemNameInBindingContext];\r\n                if (indexOf(items, oldItem, matcher) === -1) {\r\n                    viewsToRemove.push(view);\r\n                }\r\n                else {\r\n                    itemsPreviouslyInViews.push(oldItem);\r\n                }\r\n            }\r\n            let updateViews;\r\n            let removePromise;\r\n            if (itemsPreviouslyInViews.length > 0) {\r\n                removePromise = $repeat.removeViews(viewsToRemove, true, !$repeat.viewsRequireLifecycle);\r\n                updateViews = () => {\r\n                    for (let index = 0; index < itemsLength; index++) {\r\n                        const item = items[index];\r\n                        const indexOfView = indexOf(itemsPreviouslyInViews, item, matcher, index);\r\n                        let view;\r\n                        if (indexOfView === -1) {\r\n                            const overrideContext = createFullOverrideContext($repeat, items[index], index, itemsLength);\r\n                            $repeat.insertView(index, overrideContext.bindingContext, overrideContext);\r\n                            itemsPreviouslyInViews.splice(index, 0, undefined);\r\n                        }\r\n                        else if (indexOfView === index) {\r\n                            view = children[indexOfView];\r\n                            itemsPreviouslyInViews[indexOfView] = undefined;\r\n                        }\r\n                        else {\r\n                            view = children[indexOfView];\r\n                            $repeat.moveView(indexOfView, index);\r\n                            itemsPreviouslyInViews.splice(indexOfView, 1);\r\n                            itemsPreviouslyInViews.splice(index, 0, undefined);\r\n                        }\r\n                        if (view) {\r\n                            updateOverrideContext(view.overrideContext, index, itemsLength);\r\n                        }\r\n                    }\r\n                    this._inPlaceProcessItems($repeat, items);\r\n                };\r\n            }\r\n            else {\r\n                removePromise = $repeat.removeAllViews(true, !$repeat.viewsRequireLifecycle);\r\n                updateViews = () => this._standardProcessInstanceChanged($repeat, items);\r\n            }\r\n            if (removePromise instanceof Promise) {\r\n                removePromise.then(updateViews);\r\n            }\r\n            else {\r\n                updateViews();\r\n            }\r\n        }\r\n        else {\r\n            this._inPlaceProcessItems($repeat, items);\r\n        }\r\n    }\r\n    _standardProcessInstanceChanged(repeat, items) {\r\n        for (let i = 0, ii = items.length; i < ii; i++) {\r\n            let overrideContext = createFullOverrideContext(repeat, items[i], i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    }\r\n    _inPlaceProcessItems(repeat, items) {\r\n        let itemsLength = items.length;\r\n        let viewsLength = repeat.viewCount();\r\n        while (viewsLength > itemsLength) {\r\n            viewsLength--;\r\n            repeat.removeView(viewsLength, true, !repeat.viewsRequireLifecycle);\r\n        }\r\n        let local = repeat.local;\r\n        for (let i = 0; i < viewsLength; i++) {\r\n            let view = repeat.view(i);\r\n            let last = i === itemsLength - 1;\r\n            let middle = i !== 0 && !last;\r\n            let bindingContext = view.bindingContext;\r\n            let overrideContext = view.overrideContext;\r\n            if (bindingContext[local] === items[i]\r\n                && overrideContext.$middle === middle\r\n                && overrideContext.$last === last) {\r\n                continue;\r\n            }\r\n            bindingContext[local] = items[i];\r\n            overrideContext.$middle = middle;\r\n            overrideContext.$last = last;\r\n            repeat.updateBindings(view);\r\n        }\r\n        for (let i = viewsLength; i < itemsLength; i++) {\r\n            let overrideContext = createFullOverrideContext(repeat, items[i], i, itemsLength);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    }\r\n    instanceMutated(repeat, array, splices) {\r\n        if (repeat.__queuedSplices) {\r\n            for (let i = 0, ii = splices.length; i < ii; ++i) {\r\n                let { index, removed, addedCount } = splices[i];\r\n                Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"mergeSplice\"])(repeat.__queuedSplices, index, removed, addedCount);\r\n            }\r\n            repeat.__array = array.slice(0);\r\n            return;\r\n        }\r\n        let maybePromise = this._runSplices(repeat, array.slice(0), splices);\r\n        if (maybePromise instanceof Promise) {\r\n            let queuedSplices = repeat.__queuedSplices = [];\r\n            let runQueuedSplices = () => {\r\n                if (!queuedSplices.length) {\r\n                    repeat.__queuedSplices = undefined;\r\n                    repeat.__array = undefined;\r\n                    return;\r\n                }\r\n                let nextPromise = this._runSplices(repeat, repeat.__array, queuedSplices) || Promise.resolve();\r\n                queuedSplices = repeat.__queuedSplices = [];\r\n                nextPromise.then(runQueuedSplices);\r\n            };\r\n            maybePromise.then(runQueuedSplices);\r\n        }\r\n    }\r\n    _runSplices(repeat, array, splices) {\r\n        let removeDelta = 0;\r\n        let rmPromises = [];\r\n        for (let i = 0, ii = splices.length; i < ii; ++i) {\r\n            let splice = splices[i];\r\n            let removed = splice.removed;\r\n            for (let j = 0, jj = removed.length; j < jj; ++j) {\r\n                let viewOrPromise = repeat.removeView(splice.index + removeDelta + rmPromises.length, true);\r\n                if (viewOrPromise instanceof Promise) {\r\n                    rmPromises.push(viewOrPromise);\r\n                }\r\n            }\r\n            removeDelta -= splice.addedCount;\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            return Promise.all(rmPromises).then(() => {\r\n                let spliceIndexLow = this._handleAddedSplices(repeat, array, splices);\r\n                updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n            });\r\n        }\r\n        let spliceIndexLow = this._handleAddedSplices(repeat, array, splices);\r\n        updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n        return undefined;\r\n    }\r\n    _handleAddedSplices(repeat, array, splices) {\r\n        let spliceIndex;\r\n        let spliceIndexLow;\r\n        let arrayLength = array.length;\r\n        for (let i = 0, ii = splices.length; i < ii; ++i) {\r\n            let splice = splices[i];\r\n            let addIndex = spliceIndex = splice.index;\r\n            let end = splice.index + splice.addedCount;\r\n            if (typeof spliceIndexLow === 'undefined' || spliceIndexLow === null || spliceIndexLow > splice.index) {\r\n                spliceIndexLow = spliceIndex;\r\n            }\r\n            for (; addIndex < end; ++addIndex) {\r\n                let overrideContext = createFullOverrideContext(repeat, array[addIndex], addIndex, arrayLength);\r\n                repeat.insertView(addIndex, overrideContext.bindingContext, overrideContext);\r\n            }\r\n        }\r\n        return spliceIndexLow;\r\n    }\r\n}\n\nclass MapRepeatStrategy {\r\n    getCollectionObserver(observerLocator, items) {\r\n        return observerLocator.getMapObserver(items);\r\n    }\r\n    instanceChanged(repeat, items) {\r\n        let removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(() => this._standardProcessItems(repeat, items));\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    }\r\n    _standardProcessItems(repeat, items) {\r\n        let index = 0;\r\n        let overrideContext;\r\n        items.forEach((value, key) => {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size, key);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    }\r\n    instanceMutated(repeat, map, records) {\r\n        let key;\r\n        let i;\r\n        let ii;\r\n        let overrideContext;\r\n        let removeIndex;\r\n        let addIndex;\r\n        let record;\r\n        let rmPromises = [];\r\n        let viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            key = record.key;\r\n            switch (record.type) {\r\n                case 'update':\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), removeIndex, map.size, key);\r\n                    repeat.insertView(removeIndex, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'add':\r\n                    addIndex = repeat.viewCount() <= map.size - 1 ? repeat.viewCount() : map.size - 1;\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), addIndex, map.size, key);\r\n                    repeat.insertView(map.size - 1, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    if (record.oldValue === undefined) {\r\n                        return;\r\n                    }\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(() => {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    }\r\n    _getViewIndexByKey(repeat, key) {\r\n        let i;\r\n        let ii;\r\n        let child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.key] === key) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\n\nclass NullRepeatStrategy {\r\n    instanceChanged(repeat, items) {\r\n        repeat.removeAllViews(true);\r\n    }\r\n    getCollectionObserver(observerLocator, items) {\r\n    }\r\n}\n\nclass NumberRepeatStrategy {\r\n    getCollectionObserver() {\r\n        return null;\r\n    }\r\n    instanceChanged(repeat, value) {\r\n        let removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(() => this._standardProcessItems(repeat, value));\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, value);\r\n    }\r\n    _standardProcessItems(repeat, value) {\r\n        let childrenLength = repeat.viewCount();\r\n        let i;\r\n        let ii;\r\n        let overrideContext;\r\n        let viewsToRemove;\r\n        value = Math.floor(value);\r\n        viewsToRemove = childrenLength - value;\r\n        if (viewsToRemove > 0) {\r\n            if (viewsToRemove > childrenLength) {\r\n                viewsToRemove = childrenLength;\r\n            }\r\n            for (i = 0, ii = viewsToRemove; i < ii; ++i) {\r\n                repeat.removeView(childrenLength - (i + 1), true, !repeat.viewsRequireLifecycle);\r\n            }\r\n            return;\r\n        }\r\n        for (i = childrenLength, ii = value; i < ii; ++i) {\r\n            overrideContext = createFullOverrideContext(repeat, i, i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n        updateOverrideContexts(repeat.views(), 0);\r\n    }\r\n}\n\nclass SetRepeatStrategy {\r\n    getCollectionObserver(observerLocator, items) {\r\n        return observerLocator.getSetObserver(items);\r\n    }\r\n    instanceChanged(repeat, items) {\r\n        let removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(() => this._standardProcessItems(repeat, items));\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    }\r\n    _standardProcessItems(repeat, items) {\r\n        let index = 0;\r\n        let overrideContext;\r\n        items.forEach(value => {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    }\r\n    instanceMutated(repeat, set, records) {\r\n        let value;\r\n        let i;\r\n        let ii;\r\n        let overrideContext;\r\n        let removeIndex;\r\n        let record;\r\n        let rmPromises = [];\r\n        let viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            value = record.value;\r\n            switch (record.type) {\r\n                case 'add':\r\n                    let size = Math.max(set.size - 1, 0);\r\n                    overrideContext = createFullOverrideContext(repeat, value, size, set.size);\r\n                    repeat.insertView(size, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    removeIndex = this._getViewIndexByValue(repeat, value);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(() => {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    }\r\n    _getViewIndexByValue(repeat, value) {\r\n        let i;\r\n        let ii;\r\n        let child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.local] === value) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\n\nclass RepeatStrategyLocator {\r\n    constructor() {\r\n        this.matchers = [];\r\n        this.strategies = [];\r\n        this.addStrategy(items => items === null || items === undefined, new NullRepeatStrategy());\r\n        this.addStrategy(items => items instanceof Array, new ArrayRepeatStrategy());\r\n        this.addStrategy(items => items instanceof Map, new MapRepeatStrategy());\r\n        this.addStrategy(items => items instanceof Set, new SetRepeatStrategy());\r\n        this.addStrategy(items => typeof items === 'number', new NumberRepeatStrategy());\r\n    }\r\n    addStrategy(matcher, strategy) {\r\n        this.matchers.push(matcher);\r\n        this.strategies.push(strategy);\r\n    }\r\n    getStrategy(items) {\r\n        let matchers = this.matchers;\r\n        for (let i = 0, ii = matchers.length; i < ii; ++i) {\r\n            if (matchers[i](items)) {\r\n                return this.strategies[i];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n}\n\nconst lifecycleOptionalBehaviors = ['focus', 'if', 'else', 'repeat', 'show', 'hide', 'with'];\r\nfunction behaviorRequiresLifecycle(instruction) {\r\n    let t = instruction.type;\r\n    let name = t.elementName !== null ? t.elementName : t.attributeName;\r\n    return lifecycleOptionalBehaviors.indexOf(name) === -1 && (t.handlesAttached || t.handlesBind || t.handlesCreated || t.handlesDetached || t.handlesUnbind)\r\n        || t.viewFactory && viewsRequireLifecycle(t.viewFactory)\r\n        || instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction targetRequiresLifecycle(instruction) {\r\n    let behaviors = instruction.behaviorInstructions;\r\n    if (behaviors) {\r\n        let i = behaviors.length;\r\n        while (i--) {\r\n            if (behaviorRequiresLifecycle(behaviors[i])) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction viewsRequireLifecycle(viewFactory) {\r\n    if ('_viewsRequireLifecycle' in viewFactory) {\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    if (viewFactory.viewFactory) {\r\n        viewFactory._viewsRequireLifecycle = viewsRequireLifecycle(viewFactory.viewFactory);\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    if (viewFactory.template.querySelector('.au-animate')) {\r\n        viewFactory._viewsRequireLifecycle = true;\r\n        return true;\r\n    }\r\n    for (let id in viewFactory.instructions) {\r\n        if (targetRequiresLifecycle(viewFactory.instructions[id])) {\r\n            viewFactory._viewsRequireLifecycle = true;\r\n            return true;\r\n        }\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    return false;\r\n}\n\nclass AbstractRepeater {\r\n    constructor(options) {\r\n        Object.assign(this, {\r\n            local: 'items',\r\n            viewsRequireLifecycle: true\r\n        }, options);\r\n    }\r\n    viewCount() {\r\n        throw new Error('subclass must implement `viewCount`');\r\n    }\r\n    views() {\r\n        throw new Error('subclass must implement `views`');\r\n    }\r\n    view(index) {\r\n        throw new Error('subclass must implement `view`');\r\n    }\r\n    matcher() {\r\n        throw new Error('subclass must implement `matcher`');\r\n    }\r\n    addView(bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `addView`');\r\n    }\r\n    insertView(index, bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `insertView`');\r\n    }\r\n    moveView(sourceIndex, targetIndex) {\r\n        throw new Error('subclass must implement `moveView`');\r\n    }\r\n    removeAllViews(returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeAllViews`');\r\n    }\r\n    removeViews(viewsToRemove, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    }\r\n    removeView(index, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    }\r\n    updateBindings(view) {\r\n        throw new Error('subclass must implement `updateBindings`');\r\n    }\r\n}\n\nvar Repeat_1;\r\nlet Repeat = Repeat_1 = class Repeat extends AbstractRepeater {\r\n    constructor(viewFactory, instruction, viewSlot, viewResources, observerLocator, strategyLocator) {\r\n        super({\r\n            local: 'item',\r\n            viewsRequireLifecycle: viewsRequireLifecycle(viewFactory)\r\n        });\r\n        this.viewFactory = viewFactory;\r\n        this.instruction = instruction;\r\n        this.viewSlot = viewSlot;\r\n        this.lookupFunctions = viewResources.lookupFunctions;\r\n        this.observerLocator = observerLocator;\r\n        this.key = 'key';\r\n        this.value = 'value';\r\n        this.strategyLocator = strategyLocator;\r\n        this.ignoreMutation = false;\r\n        this.sourceExpression = getItemsSourceExpression(this.instruction, 'repeat.for');\r\n        this.isOneTime = isOneTime(this.sourceExpression);\r\n        this.viewsRequireLifecycle = viewsRequireLifecycle(viewFactory);\r\n    }\r\n    call(context, changes) {\r\n        this[context](this.items, changes);\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.scope = { bindingContext, overrideContext };\r\n        this.matcherBinding = this._captureAndRemoveMatcherBinding();\r\n        this.itemsChanged();\r\n    }\r\n    unbind() {\r\n        this.scope = null;\r\n        this.items = null;\r\n        this.matcherBinding = null;\r\n        this.viewSlot.removeAll(true, true);\r\n        this._unsubscribeCollection();\r\n    }\r\n    _unsubscribeCollection() {\r\n        if (this.collectionObserver) {\r\n            this.collectionObserver.unsubscribe(this.callContext, this);\r\n            this.collectionObserver = null;\r\n            this.callContext = null;\r\n        }\r\n    }\r\n    itemsChanged() {\r\n        this._unsubscribeCollection();\r\n        if (!this.scope) {\r\n            return;\r\n        }\r\n        let items = this.items;\r\n        this.strategy = this.strategyLocator.getStrategy(items);\r\n        if (!this.strategy) {\r\n            throw new Error(`Value for '${this.sourceExpression}' is non-repeatable`);\r\n        }\r\n        if (!this.isOneTime && !this._observeInnerCollection()) {\r\n            this._observeCollection();\r\n        }\r\n        this.ignoreMutation = true;\r\n        this.strategy.instanceChanged(this, items);\r\n        this.observerLocator.taskQueue.queueMicroTask(() => {\r\n            this.ignoreMutation = false;\r\n        });\r\n    }\r\n    _getInnerCollection() {\r\n        let expression = unwrapExpression(this.sourceExpression);\r\n        if (!expression) {\r\n            return null;\r\n        }\r\n        return expression.evaluate(this.scope, null);\r\n    }\r\n    handleCollectionMutated(collection, changes) {\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.strategy.instanceMutated(this, collection, changes);\r\n    }\r\n    handleInnerCollectionMutated(collection, changes) {\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.ignoreMutation = true;\r\n        let newItems = this.sourceExpression.evaluate(this.scope, this.lookupFunctions);\r\n        this.observerLocator.taskQueue.queueMicroTask(() => this.ignoreMutation = false);\r\n        if (newItems === this.items) {\r\n            this.itemsChanged();\r\n        }\r\n        else {\r\n            this.items = newItems;\r\n        }\r\n    }\r\n    _observeInnerCollection() {\r\n        let items = this._getInnerCollection();\r\n        let strategy = this.strategyLocator.getStrategy(items);\r\n        if (!strategy) {\r\n            return false;\r\n        }\r\n        this.collectionObserver = strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (!this.collectionObserver) {\r\n            return false;\r\n        }\r\n        this.callContext = 'handleInnerCollectionMutated';\r\n        this.collectionObserver.subscribe(this.callContext, this);\r\n        return true;\r\n    }\r\n    _observeCollection() {\r\n        let items = this.items;\r\n        this.collectionObserver = this.strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (this.collectionObserver) {\r\n            this.callContext = 'handleCollectionMutated';\r\n            this.collectionObserver.subscribe(this.callContext, this);\r\n        }\r\n    }\r\n    _captureAndRemoveMatcherBinding() {\r\n        const viewFactory = this.viewFactory.viewFactory;\r\n        if (viewFactory) {\r\n            const template = viewFactory.template;\r\n            const instructions = viewFactory.instructions;\r\n            if (Repeat_1.useInnerMatcher) {\r\n                return extractMatcherBindingExpression(instructions);\r\n            }\r\n            if (getChildrenCount(template) > 1) {\r\n                return undefined;\r\n            }\r\n            const repeatedElement = getFirstElementChild(template);\r\n            if (!repeatedElement.hasAttribute('au-target-id')) {\r\n                return undefined;\r\n            }\r\n            const repeatedElementTargetId = repeatedElement.getAttribute('au-target-id');\r\n            return extractMatcherBindingExpression(instructions, repeatedElementTargetId);\r\n        }\r\n        return undefined;\r\n    }\r\n    viewCount() { return this.viewSlot.children.length; }\r\n    views() { return this.viewSlot.children; }\r\n    view(index) { return this.viewSlot.children[index]; }\r\n    matcher() {\r\n        const matcherBinding = this.matcherBinding;\r\n        return matcherBinding\r\n            ? matcherBinding.sourceExpression.evaluate(this.scope, matcherBinding.lookupFunctions)\r\n            : null;\r\n    }\r\n    addView(bindingContext, overrideContext) {\r\n        let view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.add(view);\r\n    }\r\n    insertView(index, bindingContext, overrideContext) {\r\n        let view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.insert(index, view);\r\n    }\r\n    moveView(sourceIndex, targetIndex) {\r\n        this.viewSlot.move(sourceIndex, targetIndex);\r\n    }\r\n    removeAllViews(returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    }\r\n    removeViews(viewsToRemove, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeMany(viewsToRemove, returnToCache, skipAnimation);\r\n    }\r\n    removeView(index, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAt(index, returnToCache, skipAnimation);\r\n    }\r\n    updateBindings(view) {\r\n        const $view = view;\r\n        let j = $view.bindings.length;\r\n        while (j--) {\r\n            updateOneTimeBinding($view.bindings[j]);\r\n        }\r\n        j = $view.controllers.length;\r\n        while (j--) {\r\n            let k = $view.controllers[j].boundProperties.length;\r\n            while (k--) {\r\n                let binding = $view.controllers[j].boundProperties[k].binding;\r\n                updateOneTimeBinding(binding);\r\n            }\r\n        }\r\n    }\r\n};\r\nRepeat.useInnerMatcher = true;\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"items\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"local\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"key\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"value\", void 0);\r\nRepeat = Repeat_1 = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('repeat'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TargetInstruction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ObserverLocator\"], RepeatStrategyLocator)\r\n], Repeat);\r\nconst extractMatcherBindingExpression = (instructions, targetedElementId) => {\r\n    const instructionIds = Object.keys(instructions);\r\n    for (let i = 0; i < instructionIds.length; i++) {\r\n        const instructionId = instructionIds[i];\r\n        if (targetedElementId !== undefined && instructionId !== targetedElementId) {\r\n            continue;\r\n        }\r\n        const expressions = instructions[instructionId].expressions;\r\n        if (expressions) {\r\n            for (let ii = 0; ii < expressions.length; ii++) {\r\n                if (expressions[ii].targetProperty === 'matcher') {\r\n                    const matcherBindingExpression = expressions[ii];\r\n                    expressions.splice(ii, 1);\r\n                    return matcherBindingExpression;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nconst getChildrenCount = (el) => {\r\n    const childNodes = el.childNodes;\r\n    let count = 0;\r\n    for (let i = 0, ii = childNodes.length; ii > i; ++i) {\r\n        if (childNodes[i].nodeType === 1) {\r\n            ++count;\r\n        }\r\n    }\r\n    return count;\r\n};\r\nconst getFirstElementChild = (el) => {\r\n    let firstChild = el.firstChild;\r\n    while (firstChild !== null) {\r\n        if (firstChild.nodeType === 1) {\r\n            return firstChild;\r\n        }\r\n        firstChild = firstChild.nextSibling;\r\n    }\r\n    return null;\r\n};\n\nconst aureliaHideClassName = 'aurelia-hide';\r\nconst aureliaHideClass = `.${aureliaHideClassName} { display:none !important; }`;\r\nfunction injectAureliaHideStyleAtHead() {\r\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass);\r\n}\r\nfunction injectAureliaHideStyleAtBoundary(domBoundary) {\r\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].shadowDOM && domBoundary && !domBoundary.hasAureliaHideStyle) {\r\n        domBoundary.hasAureliaHideStyle = true;\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass, domBoundary);\r\n    }\r\n}\n\nlet Show = class Show {\r\n    constructor(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    }\r\n    created() {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    }\r\n    valueChanged(newValue) {\r\n        let element = this.element;\r\n        let animator = this.animator;\r\n        if (newValue) {\r\n            animator.removeClass(element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            animator.addClass(element, aureliaHideClassName);\r\n        }\r\n    }\r\n    bind(bindingContext) {\r\n        this.valueChanged(this.value);\r\n    }\r\n};\r\nShow = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('show')\r\n], Show);\n\nlet Hide = class Hide {\r\n    constructor(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    }\r\n    created() {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    }\r\n    valueChanged(newValue) {\r\n        if (newValue) {\r\n            this.animator.addClass(this.element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            this.animator.removeClass(this.element, aureliaHideClassName);\r\n        }\r\n    }\r\n    bind(bindingContext) {\r\n        this.valueChanged(this.value);\r\n    }\r\n    value(value) {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n};\r\nHide = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('hide')\r\n], Hide);\n\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\r\nlet needsToWarn = true;\r\nclass HTMLSanitizer {\r\n    sanitize(input) {\r\n        if (needsToWarn) {\r\n            needsToWarn = false;\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_5__[\"getLogger\"])('html-sanitizer')\r\n                .warn(`CAUTION: The default HTMLSanitizer does NOT provide security against a wide variety of sophisticated XSS attacks,\nand should not be relied on for sanitizing input from unknown sources.\nPlease see https://aurelia.io/docs/binding/basics#element-content for instructions on how to use a secure solution like DOMPurify or sanitize-html.`);\r\n        }\r\n        return input.replace(SCRIPT_REGEX, '');\r\n    }\r\n}\n\nlet SanitizeHTMLValueConverter = class SanitizeHTMLValueConverter {\r\n    constructor(sanitizer) {\r\n        this.sanitizer = sanitizer;\r\n    }\r\n    toView(untrustedMarkup) {\r\n        if (untrustedMarkup === null || untrustedMarkup === undefined) {\r\n            return null;\r\n        }\r\n        return this.sanitizer.sanitize(untrustedMarkup);\r\n    }\r\n};\r\nSanitizeHTMLValueConverter = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"valueConverter\"])('sanitizeHTML'),\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(HTMLSanitizer)\r\n], SanitizeHTMLValueConverter);\n\nlet Replaceable = class Replaceable {\r\n    constructor(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n            this.viewSlot.add(this.view);\r\n        }\r\n        this.view.bind(bindingContext, overrideContext);\r\n    }\r\n    unbind() {\r\n        this.view.unbind();\r\n    }\r\n};\r\nReplaceable = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('replaceable'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], Replaceable);\n\nlet Focus = class Focus {\r\n    constructor(element, taskQueue) {\r\n        this.element = element;\r\n        this.taskQueue = taskQueue;\r\n        this.isAttached = false;\r\n        this.needsApply = false;\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    }\r\n    valueChanged(newValue) {\r\n        if (this.isAttached) {\r\n            this._apply();\r\n        }\r\n        else {\r\n            this.needsApply = true;\r\n        }\r\n    }\r\n    _apply() {\r\n        if (this.value) {\r\n            this.taskQueue.queueMicroTask(() => {\r\n                if (this.value) {\r\n                    this.element.focus();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.element.blur();\r\n        }\r\n    }\r\n    attached() {\r\n        this.isAttached = true;\r\n        if (this.needsApply) {\r\n            this.needsApply = false;\r\n            this._apply();\r\n        }\r\n        this.element.addEventListener('focus', this);\r\n        this.element.addEventListener('blur', this);\r\n    }\r\n    detached() {\r\n        this.isAttached = false;\r\n        this.element.removeEventListener('focus', this);\r\n        this.element.removeEventListener('blur', this);\r\n    }\r\n    handleEvent(e) {\r\n        if (e.type === 'focus') {\r\n            this.value = true;\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].activeElement !== this.element) {\r\n            this.value = false;\r\n        }\r\n    }\r\n};\r\nFocus = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('focus', aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay)\r\n], Focus);\n\nlet cssUrlMatcher = /url\\((?!['\"]data)([^)]+)\\)/gi;\r\nfunction fixupCSSUrls(address, css) {\r\n    if (typeof css !== 'string') {\r\n        throw new Error(`Failed loading required CSS file: ${address}`);\r\n    }\r\n    return css.replace(cssUrlMatcher, (match, p1) => {\r\n        let quote = p1.charAt(0);\r\n        if (quote === '\\'' || quote === '\"') {\r\n            p1 = p1.substr(1, p1.length - 2);\r\n        }\r\n        return 'url(\\'' + Object(aurelia_path__WEBPACK_IMPORTED_MODULE_7__[\"relativeToFile\"])(p1, address) + '\\')';\r\n    });\r\n}\r\nclass CSSResource {\r\n    constructor(address) {\r\n        this.address = address;\r\n        this._scoped = null;\r\n        this._global = false;\r\n        this._alreadyGloballyInjected = false;\r\n    }\r\n    initialize(container, Target) {\r\n        this._scoped = new Target(this);\r\n    }\r\n    register(registry, name) {\r\n        if (name === 'scoped') {\r\n            registry.registerViewEngineHooks(this._scoped);\r\n        }\r\n        else {\r\n            this._global = true;\r\n        }\r\n    }\r\n    load(container) {\r\n        return container.get(aurelia_loader__WEBPACK_IMPORTED_MODULE_6__[\"Loader\"])\r\n            .loadText(this.address)\r\n            .catch(err => null)\r\n            .then(text => {\r\n            text = fixupCSSUrls(this.address, text);\r\n            this._scoped.css = text;\r\n            if (this._global) {\r\n                this._alreadyGloballyInjected = true;\r\n                aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(text);\r\n            }\r\n        });\r\n    }\r\n}\r\nclass CSSViewEngineHooks {\r\n    constructor(owner) {\r\n        this.owner = owner;\r\n        this.css = null;\r\n    }\r\n    beforeCompile(content, resources, instruction) {\r\n        if (instruction.targetShadowDOM) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].scopedCSS) {\r\n            let styleNode = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n            styleNode.setAttribute('scoped', 'scoped');\r\n        }\r\n        else if (this._global && !this.owner._alreadyGloballyInjected) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css);\r\n            this.owner._alreadyGloballyInjected = true;\r\n        }\r\n    }\r\n}\r\nfunction _createCSSResource(address) {\r\n    let ViewCSS = class ViewCSS extends CSSViewEngineHooks {\r\n    };\r\n    ViewCSS = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"resource\"])(new CSSResource(address))\r\n    ], ViewCSS);\r\n    return ViewCSS;\r\n}\n\nlet AttrBindingBehavior = class AttrBindingBehavior {\r\n    bind(binding, source) {\r\n        binding.targetObserver = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"DataAttributeObserver\"](binding.target, binding.targetProperty);\r\n    }\r\n    unbind(binding, source) {\r\n    }\r\n};\r\nAttrBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('attr')\r\n], AttrBindingBehavior);\n\nlet modeBindingBehavior = {\r\n    bind(binding, source, lookupFunctions) {\r\n        binding.originalMode = binding.mode;\r\n        binding.mode = this.mode;\r\n    },\r\n    unbind(binding, source) {\r\n        binding.mode = binding.originalMode;\r\n        binding.originalMode = null;\r\n    }\r\n};\r\nlet OneTimeBindingBehavior = class OneTimeBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\n    }\r\n};\r\nOneTimeBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneTime')\r\n], OneTimeBindingBehavior);\r\nlet OneWayBindingBehavior = class OneWayBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n};\r\nOneWayBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneWay')\r\n], OneWayBindingBehavior);\r\nlet ToViewBindingBehavior = class ToViewBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n};\r\nToViewBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('toView')\r\n], ToViewBindingBehavior);\r\nlet FromViewBindingBehavior = class FromViewBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView;\r\n    }\r\n};\r\nFromViewBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('fromView')\r\n], FromViewBindingBehavior);\r\nlet TwoWayBindingBehavior = class TwoWayBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay;\r\n    }\r\n};\r\nTwoWayBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('twoWay')\r\n], TwoWayBindingBehavior);\n\nfunction throttle(newValue) {\r\n    let state = this.throttleState;\r\n    let elapsed = +new Date() - state.last;\r\n    if (elapsed >= state.delay) {\r\n        clearTimeout(state.timeoutId);\r\n        state.timeoutId = null;\r\n        state.last = +new Date();\r\n        this.throttledMethod(newValue);\r\n        return;\r\n    }\r\n    state.newValue = newValue;\r\n    if (state.timeoutId === null) {\r\n        state.timeoutId = setTimeout(() => {\r\n            state.timeoutId = null;\r\n            state.last = +new Date();\r\n            this.throttledMethod(state.newValue);\r\n        }, state.delay - elapsed);\r\n    }\r\n}\r\nlet ThrottleBindingBehavior = class ThrottleBindingBehavior {\r\n    bind(binding, source, delay = 200) {\r\n        let methodToThrottle = 'updateTarget';\r\n        if (binding.callSource) {\r\n            methodToThrottle = 'callSource';\r\n        }\r\n        else if (binding.updateSource && binding.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay) {\r\n            methodToThrottle = 'updateSource';\r\n        }\r\n        binding.throttledMethod = binding[methodToThrottle];\r\n        binding.throttledMethod.originalName = methodToThrottle;\r\n        binding[methodToThrottle] = throttle;\r\n        binding.throttleState = {\r\n            delay: delay,\r\n            last: 0,\r\n            timeoutId: null\r\n        };\r\n    }\r\n    unbind(binding, source) {\r\n        let methodToRestore = binding.throttledMethod.originalName;\r\n        binding[methodToRestore] = binding.throttledMethod;\r\n        binding.throttledMethod = null;\r\n        clearTimeout(binding.throttleState.timeoutId);\r\n        binding.throttleState = null;\r\n    }\r\n};\r\nThrottleBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('throttle')\r\n], ThrottleBindingBehavior);\n\nconst unset = {};\r\nfunction debounceCallSource(event) {\r\n    const state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    state.timeoutId = setTimeout(() => this.debouncedMethod(event), state.delay);\r\n}\r\nfunction debounceCall(context, newValue, oldValue) {\r\n    const state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    if (context !== state.callContextToDebounce) {\r\n        state.oldValue = unset;\r\n        this.debouncedMethod(context, newValue, oldValue);\r\n        return;\r\n    }\r\n    if (state.oldValue === unset) {\r\n        state.oldValue = oldValue;\r\n    }\r\n    state.timeoutId = setTimeout(() => {\r\n        const _oldValue = state.oldValue;\r\n        state.oldValue = unset;\r\n        this.debouncedMethod(context, newValue, _oldValue);\r\n    }, state.delay);\r\n}\r\nlet DebounceBindingBehavior = class DebounceBindingBehavior {\r\n    bind(binding, source, delay = 200) {\r\n        const isCallSource = binding.callSource !== undefined;\r\n        const methodToDebounce = isCallSource ? 'callSource' : 'call';\r\n        const debouncer = isCallSource ? debounceCallSource : debounceCall;\r\n        const mode = binding.mode;\r\n        const callContextToDebounce = mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay || mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView ? aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"targetContext\"] : aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"];\r\n        binding.debouncedMethod = binding[methodToDebounce];\r\n        binding.debouncedMethod.originalName = methodToDebounce;\r\n        binding[methodToDebounce] = debouncer;\r\n        binding.debounceState = {\r\n            callContextToDebounce,\r\n            delay,\r\n            timeoutId: 0,\r\n            oldValue: unset\r\n        };\r\n    }\r\n    unbind(binding, source) {\r\n        const methodToRestore = binding.debouncedMethod.originalName;\r\n        binding[methodToRestore] = binding.debouncedMethod;\r\n        binding.debouncedMethod = null;\r\n        clearTimeout(binding.debounceState.timeoutId);\r\n        binding.debounceState = null;\r\n    }\r\n};\r\nDebounceBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('debounce')\r\n], DebounceBindingBehavior);\n\nfunction findOriginalEventTarget(event) {\r\n    return (event.path && event.path[0]) || (event.deepPath && event.deepPath[0]) || event.target;\r\n}\r\nfunction handleSelfEvent(event) {\r\n    let target = findOriginalEventTarget(event);\r\n    if (this.target !== target) {\r\n        return;\r\n    }\r\n    this.selfEventCallSource(event);\r\n}\r\nlet SelfBindingBehavior = class SelfBindingBehavior {\r\n    bind(binding, source) {\r\n        if (!binding.callSource || !binding.targetEvent) {\r\n            throw new Error('Self binding behavior only supports event.');\r\n        }\r\n        binding.selfEventCallSource = binding.callSource;\r\n        binding.callSource = handleSelfEvent;\r\n    }\r\n    unbind(binding, source) {\r\n        binding.callSource = binding.selfEventCallSource;\r\n        binding.selfEventCallSource = null;\r\n    }\r\n};\r\nSelfBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('self')\r\n], SelfBindingBehavior);\n\nclass BindingSignaler {\r\n    constructor() {\r\n        this.signals = {};\r\n    }\r\n    signal(name) {\r\n        let bindings = this.signals[name];\r\n        if (!bindings) {\r\n            return;\r\n        }\r\n        let i = bindings.length;\r\n        while (i--) {\r\n            bindings[i].call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n        }\r\n    }\r\n}\n\nlet SignalBindingBehavior = class SignalBindingBehavior {\r\n    constructor(bindingSignaler) {\r\n        this.signals = bindingSignaler.signals;\r\n    }\r\n    static inject() { return [BindingSignaler]; }\r\n    bind(binding, source, ...names) {\r\n        if (!binding.updateTarget) {\r\n            throw new Error('Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.');\r\n        }\r\n        let signals = this.signals;\r\n        if (names.length === 1) {\r\n            let name = names[0];\r\n            let bindings = signals[name] || (signals[name] = []);\r\n            bindings.push(binding);\r\n            binding.signalName = name;\r\n        }\r\n        else if (names.length > 1) {\r\n            let i = names.length;\r\n            while (i--) {\r\n                let name = names[i];\r\n                let bindings = signals[name] || (signals[name] = []);\r\n                bindings.push(binding);\r\n            }\r\n            binding.signalName = names;\r\n        }\r\n        else {\r\n            throw new Error('Signal name is required.');\r\n        }\r\n    }\r\n    unbind(binding, source) {\r\n        let signals = this.signals;\r\n        let name = binding.signalName;\r\n        binding.signalName = null;\r\n        if (Array.isArray(name)) {\r\n            let names = name;\r\n            let i = names.length;\r\n            while (i--) {\r\n                let n = names[i];\r\n                let bindings = signals[n];\r\n                bindings.splice(bindings.indexOf(binding), 1);\r\n            }\r\n        }\r\n        else {\r\n            let bindings = signals[name];\r\n            bindings.splice(bindings.indexOf(binding), 1);\r\n        }\r\n    }\r\n};\r\nSignalBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('signal')\r\n], SignalBindingBehavior);\n\nconst eventNamesRequired = 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">';\r\nconst notApplicableMessage = 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.';\r\nlet UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\r\n    bind(binding, source, ...events) {\r\n        if (events.length === 0) {\r\n            throw new Error(eventNamesRequired);\r\n        }\r\n        if (binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay && binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        let targetObserver = binding.observerLocator.getObserver(binding.target, binding.targetProperty);\r\n        if (!targetObserver.handler) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        binding.targetObserver = targetObserver;\r\n        targetObserver.originalHandler = binding.targetObserver.handler;\r\n        let handler = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"EventSubscriber\"](events);\r\n        targetObserver.handler = handler;\r\n    }\r\n    unbind(binding, source) {\r\n        let targetObserver = binding.targetObserver;\r\n        targetObserver.handler.dispose();\r\n        targetObserver.handler = targetObserver.originalHandler;\r\n        targetObserver.originalHandler = null;\r\n    }\r\n};\r\nUpdateTriggerBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('updateTrigger')\r\n], UpdateTriggerBindingBehavior);\n\nfunction _createDynamicElement({ name, viewUrl, bindableNames, useShadowDOMmode }) {\r\n    let DynamicElement = class DynamicElement {\r\n        bind(bindingContext) {\r\n            this.$parent = bindingContext;\r\n        }\r\n    };\r\n    DynamicElement = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name),\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(viewUrl)\r\n    ], DynamicElement);\r\n    for (let i = 0, ii = bindableNames.length; i < ii; ++i) {\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])(bindableNames[i])(DynamicElement);\r\n    }\r\n    switch (useShadowDOMmode) {\r\n        case 'open':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'open' })(DynamicElement);\r\n            break;\r\n        case 'closed':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'closed' })(DynamicElement);\r\n            break;\r\n        case '':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])(DynamicElement);\r\n            break;\r\n        case null:\r\n            break;\r\n        default:\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_5__[\"getLogger\"])('aurelia-html-only-element')\r\n                .warn(`Expected 'use-shadow-dom' value to be \"close\", \"open\" or \"\", received ${useShadowDOMmode}`);\r\n            break;\r\n    }\r\n    return DynamicElement;\r\n}\n\nfunction getElementName(address) {\r\n    return /([^\\/^\\?]+)\\.html/i.exec(address)[1].toLowerCase();\r\n}\r\nfunction configure(config) {\r\n    const viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    const loader = config.aurelia.loader;\r\n    viewEngine.addResourcePlugin('.html', {\r\n        'fetch': function (viewUrl) {\r\n            return loader.loadTemplate(viewUrl).then(registryEntry => {\r\n                let bindableNames = registryEntry.template.getAttribute('bindable');\r\n                const useShadowDOMmode = registryEntry.template.getAttribute('use-shadow-dom');\r\n                const name = getElementName(viewUrl);\r\n                if (bindableNames) {\r\n                    bindableNames = bindableNames.split(',').map(x => x.trim());\r\n                    registryEntry.template.removeAttribute('bindable');\r\n                }\r\n                else {\r\n                    bindableNames = [];\r\n                }\r\n                return { [name]: _createDynamicElement({ name, viewUrl, bindableNames, useShadowDOMmode }) };\r\n            });\r\n        }\r\n    });\r\n}\n\nfunction configure$1(config) {\r\n    injectAureliaHideStyleAtHead();\r\n    config.globalResources(Compose, If, Else, With, Repeat, Show, Hide, Replaceable, Focus, SanitizeHTMLValueConverter, OneTimeBindingBehavior, OneWayBindingBehavior, ToViewBindingBehavior, FromViewBindingBehavior, TwoWayBindingBehavior, ThrottleBindingBehavior, DebounceBindingBehavior, SelfBindingBehavior, SignalBindingBehavior, UpdateTriggerBindingBehavior, AttrBindingBehavior);\r\n    configure(config);\r\n    let viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    let styleResourcePlugin = {\r\n        fetch(address) {\r\n            return { [address]: _createCSSResource(address) };\r\n        }\r\n    };\r\n    ['.css', '.less', '.sass', '.scss', '.styl'].forEach(ext => viewEngine.addResourcePlugin(ext, styleResourcePlugin));\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-resources.js.map\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! promise-polyfill */ \"B/eG\")[\"default\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvZXMyMDE1L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMuanM/OWIzMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250YWluZXIsIGluamVjdCwgT3B0aW9uYWwgfSBmcm9tICdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJztcbmltcG9ydCB7IERPTSwgRkVBVFVSRSB9IGZyb20gJ2F1cmVsaWEtcGFsJztcbmltcG9ydCB7IFRhc2tRdWV1ZSB9IGZyb20gJ2F1cmVsaWEtdGFzay1xdWV1ZSc7XG5pbXBvcnQgeyBDb21wb3NpdGlvbkVuZ2luZSwgVmlld1Nsb3QsIFZpZXdSZXNvdXJjZXMsIGJpbmRhYmxlLCBub1ZpZXcsIGN1c3RvbUVsZW1lbnQsIGN1c3RvbUF0dHJpYnV0ZSwgdGVtcGxhdGVDb250cm9sbGVyLCBCb3VuZFZpZXdGYWN0b3J5LCBUYXJnZXRJbnN0cnVjdGlvbiwgQW5pbWF0b3IsIHJlc291cmNlLCB1c2VWaWV3LCB1c2VTaGFkb3dET00sIFZpZXdFbmdpbmUgfSBmcm9tICdhdXJlbGlhLXRlbXBsYXRpbmcnO1xuaW1wb3J0IHsgY3JlYXRlT3ZlcnJpZGVDb250ZXh0LCBiaW5kaW5nTW9kZSwgQmluZGluZ0JlaGF2aW9yLCBWYWx1ZUNvbnZlcnRlciwgc291cmNlQ29udGV4dCwgbWVyZ2VTcGxpY2UsIE9ic2VydmVyTG9jYXRvciwgdmFsdWVDb252ZXJ0ZXIsIERhdGFBdHRyaWJ1dGVPYnNlcnZlciwgYmluZGluZ0JlaGF2aW9yLCB0YXJnZXRDb250ZXh0LCBFdmVudFN1YnNjcmliZXIgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyIH0gZnJvbSAnYXVyZWxpYS1sb2dnaW5nJztcbmltcG9ydCB7IExvYWRlciB9IGZyb20gJ2F1cmVsaWEtbG9hZGVyJztcbmltcG9ydCB7IHJlbGF0aXZlVG9GaWxlIH0gZnJvbSAnYXVyZWxpYS1wYXRoJztcbmltcG9ydCB7IG1peGluIH0gZnJvbSAnYXVyZWxpYS1tZXRhZGF0YSc7XG5cbi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcblxyXG5mdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XG5cbnZhciBBY3RpdmF0aW9uU3RyYXRlZ3k7XHJcbihmdW5jdGlvbiAoQWN0aXZhdGlvblN0cmF0ZWd5KSB7XHJcbiAgICBBY3RpdmF0aW9uU3RyYXRlZ3lbXCJJbnZva2VMaWZlY3ljbGVcIl0gPSBcImludm9rZS1saWZlY3ljbGVcIjtcclxuICAgIEFjdGl2YXRpb25TdHJhdGVneVtcIlJlcGxhY2VcIl0gPSBcInJlcGxhY2VcIjtcclxufSkoQWN0aXZhdGlvblN0cmF0ZWd5IHx8IChBY3RpdmF0aW9uU3RyYXRlZ3kgPSB7fSkpO1xyXG5sZXQgQ29tcG9zZSA9IGNsYXNzIENvbXBvc2Uge1xyXG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgY29udGFpbmVyLCBjb21wb3NpdGlvbkVuZ2luZSwgdmlld1Nsb3QsIHZpZXdSZXNvdXJjZXMsIHRhc2tRdWV1ZSkge1xyXG4gICAgICAgIHRoaXMuYWN0aXZhdGlvblN0cmF0ZWd5ID0gQWN0aXZhdGlvblN0cmF0ZWd5Lkludm9rZUxpZmVjeWNsZTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25FbmdpbmUgPSBjb21wb3NpdGlvbkVuZ2luZTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy52aWV3UmVzb3VyY2VzID0gdmlld1Jlc291cmNlcztcclxuICAgICAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRDb250cm9sbGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRWaWV3TW9kZWwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaW5qZWN0KCkge1xyXG4gICAgICAgIHJldHVybiBbRE9NLkVsZW1lbnQsIENvbnRhaW5lciwgQ29tcG9zaXRpb25FbmdpbmUsIFZpZXdTbG90LCBWaWV3UmVzb3VyY2VzLCBUYXNrUXVldWVdO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlZChvd25pbmdWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5vd25pbmdWaWV3ID0gb3duaW5nVmlldztcclxuICAgIH1cclxuICAgIGJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBiaW5kaW5nQ29udGV4dDtcclxuICAgICAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICBsZXQgY2hhbmdlcyA9IHRoaXMuY2hhbmdlcztcclxuICAgICAgICBjaGFuZ2VzLnZpZXcgPSB0aGlzLnZpZXc7XHJcbiAgICAgICAgY2hhbmdlcy52aWV3TW9kZWwgPSB0aGlzLnZpZXdNb2RlbDtcclxuICAgICAgICBjaGFuZ2VzLm1vZGVsID0gdGhpcy5tb2RlbDtcclxuICAgICAgICBpZiAoIXRoaXMucGVuZGluZ1Rhc2spIHtcclxuICAgICAgICAgICAgcHJvY2Vzc0NoYW5nZXModGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIGxldCByZXR1cm5Ub0NhY2hlID0gdHJ1ZTtcclxuICAgICAgICBsZXQgc2tpcEFuaW1hdGlvbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdC5yZW1vdmVBbGwocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbik7XHJcbiAgICB9XHJcbiAgICBtb2RlbENoYW5nZWQobmV3VmFsdWUsIG9sZFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzLm1vZGVsID0gbmV3VmFsdWU7XHJcbiAgICAgICAgcmVxdWVzdFVwZGF0ZSh0aGlzKTtcclxuICAgIH1cclxuICAgIHZpZXdDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcy52aWV3ID0gbmV3VmFsdWU7XHJcbiAgICAgICAgcmVxdWVzdFVwZGF0ZSh0aGlzKTtcclxuICAgIH1cclxuICAgIHZpZXdNb2RlbENoYW5nZWQobmV3VmFsdWUsIG9sZFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzLnZpZXdNb2RlbCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIHJlcXVlc3RVcGRhdGUodGhpcyk7XHJcbiAgICB9XHJcbn07XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgQ29tcG9zZS5wcm90b3R5cGUsIFwibW9kZWxcIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kYWJsZVxyXG5dLCBDb21wb3NlLnByb3RvdHlwZSwgXCJ2aWV3XCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgQ29tcG9zZS5wcm90b3R5cGUsIFwidmlld01vZGVsXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgQ29tcG9zZS5wcm90b3R5cGUsIFwiYWN0aXZhdGlvblN0cmF0ZWd5XCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgQ29tcG9zZS5wcm90b3R5cGUsIFwic3dhcE9yZGVyXCIsIHZvaWQgMCk7XHJcbkNvbXBvc2UgPSBfX2RlY29yYXRlKFtcclxuICAgIG5vVmlldyxcclxuICAgIGN1c3RvbUVsZW1lbnQoJ2NvbXBvc2UnKVxyXG5dLCBDb21wb3NlKTtcclxuZnVuY3Rpb24gaXNFbXB0eShvYmopIHtcclxuICAgIGZvciAoY29uc3QgXyBpbiBvYmopIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiB0cnlBY3RpdmF0ZVZpZXdNb2RlbCh2bSwgbW9kZWwpIHtcclxuICAgIGlmICh2bSAmJiB0eXBlb2Ygdm0uYWN0aXZhdGUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZtLmFjdGl2YXRlKG1vZGVsKSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlSW5zdHJ1Y3Rpb24oY29tcG9zZXIsIGluc3RydWN0aW9uKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihpbnN0cnVjdGlvbiwge1xyXG4gICAgICAgIGJpbmRpbmdDb250ZXh0OiBjb21wb3Nlci5iaW5kaW5nQ29udGV4dCxcclxuICAgICAgICBvdmVycmlkZUNvbnRleHQ6IGNvbXBvc2VyLm92ZXJyaWRlQ29udGV4dCxcclxuICAgICAgICBvd25pbmdWaWV3OiBjb21wb3Nlci5vd25pbmdWaWV3LFxyXG4gICAgICAgIGNvbnRhaW5lcjogY29tcG9zZXIuY29udGFpbmVyLFxyXG4gICAgICAgIHZpZXdTbG90OiBjb21wb3Nlci52aWV3U2xvdCxcclxuICAgICAgICB2aWV3UmVzb3VyY2VzOiBjb21wb3Nlci52aWV3UmVzb3VyY2VzLFxyXG4gICAgICAgIGN1cnJlbnRDb250cm9sbGVyOiBjb21wb3Nlci5jdXJyZW50Q29udHJvbGxlcixcclxuICAgICAgICBob3N0OiBjb21wb3Nlci5lbGVtZW50LFxyXG4gICAgICAgIHN3YXBPcmRlcjogY29tcG9zZXIuc3dhcE9yZGVyXHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBwcm9jZXNzQ2hhbmdlcyhjb21wb3Nlcikge1xyXG4gICAgY29uc3QgY2hhbmdlcyA9IGNvbXBvc2VyLmNoYW5nZXM7XHJcbiAgICBjb21wb3Nlci5jaGFuZ2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIGlmIChuZWVkc1JlSW5pdGlhbGl6YXRpb24oY29tcG9zZXIsIGNoYW5nZXMpKSB7XHJcbiAgICAgICAgbGV0IGluc3RydWN0aW9uID0ge1xyXG4gICAgICAgICAgICB2aWV3OiBjb21wb3Nlci52aWV3LFxyXG4gICAgICAgICAgICB2aWV3TW9kZWw6IGNvbXBvc2VyLmN1cnJlbnRWaWV3TW9kZWwgfHwgY29tcG9zZXIudmlld01vZGVsLFxyXG4gICAgICAgICAgICBtb2RlbDogY29tcG9zZXIubW9kZWxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGluc3RydWN0aW9uID0gT2JqZWN0LmFzc2lnbihpbnN0cnVjdGlvbiwgY2hhbmdlcyk7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBjcmVhdGVJbnN0cnVjdGlvbihjb21wb3NlciwgaW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gY29tcG9zZXIuY29tcG9zaXRpb25FbmdpbmUuY29tcG9zZShpbnN0cnVjdGlvbikudGhlbihjb250cm9sbGVyID0+IHtcclxuICAgICAgICAgICAgY29tcG9zZXIuY3VycmVudENvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xyXG4gICAgICAgICAgICBjb21wb3Nlci5jdXJyZW50Vmlld01vZGVsID0gY29udHJvbGxlciA/IGNvbnRyb2xsZXIudmlld01vZGVsIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gdHJ5QWN0aXZhdGVWaWV3TW9kZWwoY29tcG9zZXIuY3VycmVudFZpZXdNb2RlbCwgY2hhbmdlcy5tb2RlbCk7XHJcbiAgICAgICAgaWYgKCFjb21wb3Nlci5wZW5kaW5nVGFzaykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29tcG9zZXIucGVuZGluZ1Rhc2sgPSBjb21wb3Nlci5wZW5kaW5nVGFza1xyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjb21wbGV0ZUNvbXBvc2l0aW9uVGFzayhjb21wb3Nlcik7XHJcbiAgICB9LCByZWFzb24gPT4ge1xyXG4gICAgICAgIGNvbXBsZXRlQ29tcG9zaXRpb25UYXNrKGNvbXBvc2VyKTtcclxuICAgICAgICB0aHJvdyByZWFzb247XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBjb21wbGV0ZUNvbXBvc2l0aW9uVGFzayhjb21wb3Nlcikge1xyXG4gICAgY29tcG9zZXIucGVuZGluZ1Rhc2sgPSBudWxsO1xyXG4gICAgaWYgKCFpc0VtcHR5KGNvbXBvc2VyLmNoYW5nZXMpKSB7XHJcbiAgICAgICAgcHJvY2Vzc0NoYW5nZXMoY29tcG9zZXIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlcXVlc3RVcGRhdGUoY29tcG9zZXIpIHtcclxuICAgIGlmIChjb21wb3Nlci5wZW5kaW5nVGFzayB8fCBjb21wb3Nlci51cGRhdGVSZXF1ZXN0ZWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb21wb3Nlci51cGRhdGVSZXF1ZXN0ZWQgPSB0cnVlO1xyXG4gICAgY29tcG9zZXIudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKCgpID0+IHtcclxuICAgICAgICBjb21wb3Nlci51cGRhdGVSZXF1ZXN0ZWQgPSBmYWxzZTtcclxuICAgICAgICBwcm9jZXNzQ2hhbmdlcyhjb21wb3Nlcik7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBuZWVkc1JlSW5pdGlhbGl6YXRpb24oY29tcG9zZXIsIGNoYW5nZXMpIHtcclxuICAgIGxldCBhY3RpdmF0aW9uU3RyYXRlZ3kgPSBjb21wb3Nlci5hY3RpdmF0aW9uU3RyYXRlZ3k7XHJcbiAgICBjb25zdCB2bSA9IGNvbXBvc2VyLmN1cnJlbnRWaWV3TW9kZWw7XHJcbiAgICBpZiAodm0gJiYgdHlwZW9mIHZtLmRldGVybWluZUFjdGl2YXRpb25TdHJhdGVneSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIGFjdGl2YXRpb25TdHJhdGVneSA9IHZtLmRldGVybWluZUFjdGl2YXRpb25TdHJhdGVneSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICd2aWV3JyBpbiBjaGFuZ2VzXHJcbiAgICAgICAgfHwgJ3ZpZXdNb2RlbCcgaW4gY2hhbmdlc1xyXG4gICAgICAgIHx8IGFjdGl2YXRpb25TdHJhdGVneSA9PT0gQWN0aXZhdGlvblN0cmF0ZWd5LlJlcGxhY2U7XHJcbn1cblxuY2xhc3MgSWZDb3JlIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy52aWV3ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlldyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcclxuICAgICAgICBpZiAoIXRoaXMudmlld0ZhY3RvcnkuaXNDYWNoaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5yZW1vdmUodGhpcy52aWV3LCB0cnVlLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldy5yZXR1cm5Ub0NhY2hlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBfc2hvdygpIHtcclxuICAgICAgICBpZiAodGhpcy5zaG93aW5nKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3LmlzQm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5iaW5kKHRoaXMuYmluZGluZ0NvbnRleHQsIHRoaXMub3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnZpZXcgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnZpZXcuaXNCb3VuZCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcuYmluZCh0aGlzLmJpbmRpbmdDb250ZXh0LCB0aGlzLm92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XHJcbiAgICB9XHJcbiAgICBfaGlkZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IGZhbHNlO1xyXG4gICAgICAgIGxldCByZW1vdmVkID0gdGhpcy52aWV3U2xvdC5yZW1vdmUodGhpcy52aWV3KTtcclxuICAgICAgICBpZiAocmVtb3ZlZCBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZWQudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91bmJpbmRWaWV3KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91bmJpbmRWaWV3KCk7XHJcbiAgICB9XHJcbiAgICBfdW5iaW5kVmlldygpIHtcclxuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGUgPT09ICdmYWxzZScgPyBmYWxzZSA6ICEhdGhpcy5jYWNoZTtcclxuICAgICAgICB0aGlzLnZpZXcudW5iaW5kKCk7XHJcbiAgICAgICAgaWYgKCFjYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5sZXQgSWYgPSBjbGFzcyBJZiBleHRlbmRzIElmQ29yZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgc3VwZXIuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICBpZiAodGhpcy5jb25kaXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbmRpdGlvbkNoYW5nZWQobmV3VmFsdWUpIHtcclxuICAgICAgICB0aGlzLl91cGRhdGUobmV3VmFsdWUpO1xyXG4gICAgfVxyXG4gICAgX3VwZGF0ZShzaG93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHByb21pc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuZWxzZVZtKSB7XHJcbiAgICAgICAgICAgIHByb21pc2UgPSBzaG93ID8gdGhpcy5fc3dhcCh0aGlzLmVsc2VWbSwgdGhpcykgOiB0aGlzLl9zd2FwKHRoaXMsIHRoaXMuZWxzZVZtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHByb21pc2UgPSBzaG93ID8gdGhpcy5fc2hvdygpIDogdGhpcy5faGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJvbWlzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZGl0aW9uICE9PSB0aGlzLnNob3dpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUodGhpcy5jb25kaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfc3dhcChyZW1vdmUsIGFkZCkge1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5zd2FwT3JkZXIpIHtcclxuICAgICAgICAgICAgY2FzZSAnYmVmb3JlJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYWRkLl9zaG93KCkpLnRoZW4oKCkgPT4gcmVtb3ZlLl9oaWRlKCkpO1xyXG4gICAgICAgICAgICBjYXNlICd3aXRoJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbcmVtb3ZlLl9oaWRlKCksIGFkZC5fc2hvdygpXSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBsZXQgcHJvbWlzZSA9IHJlbW92ZS5faGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UgPyBwcm9taXNlLnRoZW4oKCkgPT4gYWRkLl9zaG93KCkpIDogYWRkLl9zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlKHsgcHJpbWFyeVByb3BlcnR5OiB0cnVlIH0pXHJcbl0sIElmLnByb3RvdHlwZSwgXCJjb25kaXRpb25cIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kYWJsZVxyXG5dLCBJZi5wcm90b3R5cGUsIFwic3dhcE9yZGVyXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgSWYucHJvdG90eXBlLCBcImNhY2hlXCIsIHZvaWQgMCk7XHJcbklmID0gX19kZWNvcmF0ZShbXHJcbiAgICBjdXN0b21BdHRyaWJ1dGUoJ2lmJyksXHJcbiAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbl0sIElmKTtcblxubGV0IEVsc2UgPSBjbGFzcyBFbHNlIGV4dGVuZHMgSWZDb3JlIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHN1cGVyKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCk7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJJbklmKCk7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICBzdXBlci5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIGlmICh0aGlzLmlmVm0uY29uZGl0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJJbklmKCkge1xyXG4gICAgICAgIGxldCBwcmV2aW91cyA9IHRoaXMudmlld1Nsb3QuYW5jaG9yLnByZXZpb3VzU2libGluZztcclxuICAgICAgICB3aGlsZSAocHJldmlvdXMgJiYgIXByZXZpb3VzLmF1KSB7XHJcbiAgICAgICAgICAgIHByZXZpb3VzID0gcHJldmlvdXMucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXByZXZpb3VzIHx8ICFwcmV2aW91cy5hdS5pZikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBmaW5kIG1hdGNoaW5nIElmIGZvciBFbHNlIGN1c3RvbSBhdHRyaWJ1dGUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlmVm0gPSBwcmV2aW91cy5hdS5pZi52aWV3TW9kZWw7XHJcbiAgICAgICAgdGhpcy5pZlZtLmVsc2VWbSA9IHRoaXM7XHJcbiAgICB9XHJcbn07XHJcbkVsc2UgPSBfX2RlY29yYXRlKFtcclxuICAgIGN1c3RvbUF0dHJpYnV0ZSgnZWxzZScpLFxyXG4gICAgdGVtcGxhdGVDb250cm9sbGVyLFxyXG4gICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFZpZXdTbG90KVxyXG5dLCBFbHNlKTtcblxubGV0IFdpdGggPSBjbGFzcyBXaXRoIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnBhcmVudE92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlZCh0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuICAgIHZhbHVlQ2hhbmdlZChuZXdWYWx1ZSkge1xyXG4gICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQobmV3VmFsdWUsIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICBsZXQgdmlldyA9IHRoaXMudmlldztcclxuICAgICAgICBpZiAoIXZpZXcpIHtcclxuICAgICAgICAgICAgdmlldyA9IHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHZpZXcuYmluZChuZXdWYWx1ZSwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5hZGQodmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2aWV3LmJpbmQobmV3VmFsdWUsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIGxldCB2aWV3ID0gdGhpcy52aWV3O1xyXG4gICAgICAgIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICB2aWV3LnVuYmluZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuV2l0aCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgY3VzdG9tQXR0cmlidXRlKCd3aXRoJyksXHJcbiAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbl0sIFdpdGgpO1xuXG5jb25zdCBvbmVUaW1lID0gYmluZGluZ01vZGUub25lVGltZTtcclxuZnVuY3Rpb24gdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyh2aWV3cywgc3RhcnRJbmRleCkge1xyXG4gICAgbGV0IGxlbmd0aCA9IHZpZXdzLmxlbmd0aDtcclxuICAgIGlmIChzdGFydEluZGV4ID4gMCkge1xyXG4gICAgICAgIHN0YXJ0SW5kZXggPSBzdGFydEluZGV4IC0gMTtcclxuICAgIH1cclxuICAgIGZvciAoOyBzdGFydEluZGV4IDwgbGVuZ3RoOyArK3N0YXJ0SW5kZXgpIHtcclxuICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHQodmlld3Nbc3RhcnRJbmRleF0ub3ZlcnJpZGVDb250ZXh0LCBzdGFydEluZGV4LCBsZW5ndGgpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBkYXRhLCBpbmRleCwgbGVuZ3RoLCBrZXkpIHtcclxuICAgIGxldCBiaW5kaW5nQ29udGV4dCA9IHt9O1xyXG4gICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZU92ZXJyaWRlQ29udGV4dChiaW5kaW5nQ29udGV4dCwgcmVwZWF0LnNjb3BlLm92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQua2V5XSA9IGtleTtcclxuICAgICAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQudmFsdWVdID0gZGF0YTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGJpbmRpbmdDb250ZXh0W3JlcGVhdC5sb2NhbF0gPSBkYXRhO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0KG92ZXJyaWRlQ29udGV4dCwgaW5kZXgsIGxlbmd0aCk7XHJcbiAgICByZXR1cm4gb3ZlcnJpZGVDb250ZXh0O1xyXG59XHJcbmZ1bmN0aW9uIHVwZGF0ZU92ZXJyaWRlQ29udGV4dChvdmVycmlkZUNvbnRleHQsIGluZGV4LCBsZW5ndGgpIHtcclxuICAgIGxldCBmaXJzdCA9IChpbmRleCA9PT0gMCk7XHJcbiAgICBsZXQgbGFzdCA9IChpbmRleCA9PT0gbGVuZ3RoIC0gMSk7XHJcbiAgICBsZXQgZXZlbiA9IGluZGV4ICUgMiA9PT0gMDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kaW5kZXggPSBpbmRleDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kZmlyc3QgPSBmaXJzdDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kbGFzdCA9IGxhc3Q7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJG1pZGRsZSA9ICEoZmlyc3QgfHwgbGFzdCk7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJG9kZCA9ICFldmVuO1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRldmVuID0gZXZlbjtcclxufVxyXG5mdW5jdGlvbiBnZXRJdGVtc1NvdXJjZUV4cHJlc3Npb24oaW5zdHJ1Y3Rpb24sIGF0dHJOYW1lKSB7XHJcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnNcclxuICAgICAgICAuZmlsdGVyKGJpID0+IGJpLm9yaWdpbmFsQXR0ck5hbWUgPT09IGF0dHJOYW1lKVswXVxyXG4gICAgICAgIC5hdHRyaWJ1dGVzXHJcbiAgICAgICAgLml0ZW1zXHJcbiAgICAgICAgLnNvdXJjZUV4cHJlc3Npb247XHJcbn1cclxuZnVuY3Rpb24gdW53cmFwRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XHJcbiAgICBsZXQgdW53cmFwcGVkID0gZmFsc2U7XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEJpbmRpbmdCZWhhdmlvcikge1xyXG4gICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLmV4cHJlc3Npb247XHJcbiAgICB9XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIFZhbHVlQ29udmVydGVyKSB7XHJcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcclxuICAgICAgICB1bndyYXBwZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVud3JhcHBlZCA/IGV4cHJlc3Npb24gOiBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIGlzT25lVGltZShleHByZXNzaW9uKSB7XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEJpbmRpbmdCZWhhdmlvcikge1xyXG4gICAgICAgIGlmIChleHByZXNzaW9uLm5hbWUgPT09ICdvbmVUaW1lJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVPbmVUaW1lQmluZGluZyhiaW5kaW5nKSB7XHJcbiAgICBpZiAoYmluZGluZy5jYWxsICYmIGJpbmRpbmcubW9kZSA9PT0gb25lVGltZSkge1xyXG4gICAgICAgIGJpbmRpbmcuY2FsbChzb3VyY2VDb250ZXh0KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlT25lVGltZUJpbmRpbmdzKSB7XHJcbiAgICAgICAgYmluZGluZy51cGRhdGVPbmVUaW1lQmluZGluZ3MoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpbmRleE9mKGFycmF5LCBpdGVtLCBtYXRjaGVyLCBzdGFydEluZGV4KSB7XHJcbiAgICBpZiAoIW1hdGNoZXIpIHtcclxuICAgICAgICByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcclxuICAgIGZvciAobGV0IGluZGV4ID0gc3RhcnRJbmRleCB8fCAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgIGlmIChtYXRjaGVyKGFycmF5W2luZGV4XSwgaXRlbSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAtMTtcclxufVxuXG5jbGFzcyBBcnJheVJlcGVhdFN0cmF0ZWd5IHtcclxuICAgIGdldENvbGxlY3Rpb25PYnNlcnZlcihvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRBcnJheU9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgY29uc3QgJHJlcGVhdCA9IHJlcGVhdDtcclxuICAgICAgICBjb25zdCBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcclxuICAgICAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zTGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICRyZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgISRyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9ICRyZXBlYXQudmlld3MoKTtcclxuICAgICAgICBjb25zdCB2aWV3c0xlbmd0aCA9IGNoaWxkcmVuLmxlbmd0aDtcclxuICAgICAgICBpZiAodmlld3NMZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VDaGFuZ2VkKCRyZXBlYXQsIGl0ZW1zKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoJHJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpIHtcclxuICAgICAgICAgICAgY29uc3QgY2hpbGRyZW5TbmFwc2hvdCA9IGNoaWxkcmVuLnNsaWNlKDApO1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtTmFtZUluQmluZGluZ0NvbnRleHQgPSAkcmVwZWF0LmxvY2FsO1xyXG4gICAgICAgICAgICBjb25zdCBtYXRjaGVyID0gJHJlcGVhdC5tYXRjaGVyKCk7XHJcbiAgICAgICAgICAgIGxldCBpdGVtc1ByZXZpb3VzbHlJblZpZXdzID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdzVG9SZW1vdmUgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHZpZXdzTGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gY2hpbGRyZW5TbmFwc2hvdFtpbmRleF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRJdGVtID0gdmlldy5iaW5kaW5nQ29udGV4dFtpdGVtTmFtZUluQmluZGluZ0NvbnRleHRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4T2YoaXRlbXMsIG9sZEl0ZW0sIG1hdGNoZXIpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzVG9SZW1vdmUucHVzaCh2aWV3KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3MucHVzaChvbGRJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgdXBkYXRlVmlld3M7XHJcbiAgICAgICAgICAgIGxldCByZW1vdmVQcm9taXNlO1xyXG4gICAgICAgICAgICBpZiAoaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlID0gJHJlcGVhdC5yZW1vdmVWaWV3cyh2aWV3c1RvUmVtb3ZlLCB0cnVlLCAhJHJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVmlld3MgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGl0ZW1zTGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tpbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4T2ZWaWV3ID0gaW5kZXhPZihpdGVtc1ByZXZpb3VzbHlJblZpZXdzLCBpdGVtLCBtYXRjaGVyLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2aWV3O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhPZlZpZXcgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KCRyZXBlYXQsIGl0ZW1zW2luZGV4XSwgaW5kZXgsIGl0ZW1zTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXBlYXQuaW5zZXJ0VmlldyhpbmRleCwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5zcGxpY2UoaW5kZXgsIDAsIHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaW5kZXhPZlZpZXcgPT09IGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3ID0gY2hpbGRyZW5baW5kZXhPZlZpZXddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3c1tpbmRleE9mVmlld10gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3ID0gY2hpbGRyZW5baW5kZXhPZlZpZXddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlcGVhdC5tb3ZlVmlldyhpbmRleE9mVmlldywgaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5zcGxpY2UoaW5kZXhPZlZpZXcsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5zcGxpY2UoaW5kZXgsIDAsIHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dCh2aWV3Lm92ZXJyaWRlQ29udGV4dCwgaW5kZXgsIGl0ZW1zTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pblBsYWNlUHJvY2Vzc0l0ZW1zKCRyZXBlYXQsIGl0ZW1zKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlID0gJHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhJHJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVmlld3MgPSAoKSA9PiB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZUNoYW5nZWQoJHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKHVwZGF0ZVZpZXdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXdzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luUGxhY2VQcm9jZXNzSXRlbXMoJHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZUNoYW5nZWQocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGl0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpdGVtc1tpXSwgaSwgaWkpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2luUGxhY2VQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIGxldCBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcclxuICAgICAgICBsZXQgdmlld3NMZW5ndGggPSByZXBlYXQudmlld0NvdW50KCk7XHJcbiAgICAgICAgd2hpbGUgKHZpZXdzTGVuZ3RoID4gaXRlbXNMZW5ndGgpIHtcclxuICAgICAgICAgICAgdmlld3NMZW5ndGgtLTtcclxuICAgICAgICAgICAgcmVwZWF0LnJlbW92ZVZpZXcodmlld3NMZW5ndGgsIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGxvY2FsID0gcmVwZWF0LmxvY2FsO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmlld3NMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgdmlldyA9IHJlcGVhdC52aWV3KGkpO1xyXG4gICAgICAgICAgICBsZXQgbGFzdCA9IGkgPT09IGl0ZW1zTGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgbGV0IG1pZGRsZSA9IGkgIT09IDAgJiYgIWxhc3Q7XHJcbiAgICAgICAgICAgIGxldCBiaW5kaW5nQ29udGV4dCA9IHZpZXcuYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQgPSB2aWV3Lm92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmdDb250ZXh0W2xvY2FsXSA9PT0gaXRlbXNbaV1cclxuICAgICAgICAgICAgICAgICYmIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID09PSBtaWRkbGVcclxuICAgICAgICAgICAgICAgICYmIG92ZXJyaWRlQ29udGV4dC4kbGFzdCA9PT0gbGFzdCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYmluZGluZ0NvbnRleHRbbG9jYWxdID0gaXRlbXNbaV07XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID0gbWlkZGxlO1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuJGxhc3QgPSBsYXN0O1xyXG4gICAgICAgICAgICByZXBlYXQudXBkYXRlQmluZGluZ3Modmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IGkgPSB2aWV3c0xlbmd0aDsgaSA8IGl0ZW1zTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpdGVtc1tpXSwgaSwgaXRlbXNMZW5ndGgpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcclxuICAgICAgICBpZiAocmVwZWF0Ll9fcXVldWVkU3BsaWNlcykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBzcGxpY2VzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGxldCB7IGluZGV4LCByZW1vdmVkLCBhZGRlZENvdW50IH0gPSBzcGxpY2VzW2ldO1xyXG4gICAgICAgICAgICAgICAgbWVyZ2VTcGxpY2UocmVwZWF0Ll9fcXVldWVkU3BsaWNlcywgaW5kZXgsIHJlbW92ZWQsIGFkZGVkQ291bnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlcGVhdC5fX2FycmF5ID0gYXJyYXkuc2xpY2UoMCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IG1heWJlUHJvbWlzZSA9IHRoaXMuX3J1blNwbGljZXMocmVwZWF0LCBhcnJheS5zbGljZSgwKSwgc3BsaWNlcyk7XHJcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgbGV0IHF1ZXVlZFNwbGljZXMgPSByZXBlYXQuX19xdWV1ZWRTcGxpY2VzID0gW107XHJcbiAgICAgICAgICAgIGxldCBydW5RdWV1ZWRTcGxpY2VzID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFxdWV1ZWRTcGxpY2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Ll9fYXJyYXkgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IG5leHRQcm9taXNlID0gdGhpcy5fcnVuU3BsaWNlcyhyZXBlYXQsIHJlcGVhdC5fX2FycmF5LCBxdWV1ZWRTcGxpY2VzKSB8fCBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIHF1ZXVlZFNwbGljZXMgPSByZXBlYXQuX19xdWV1ZWRTcGxpY2VzID0gW107XHJcbiAgICAgICAgICAgICAgICBuZXh0UHJvbWlzZS50aGVuKHJ1blF1ZXVlZFNwbGljZXMpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtYXliZVByb21pc2UudGhlbihydW5RdWV1ZWRTcGxpY2VzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfcnVuU3BsaWNlcyhyZXBlYXQsIGFycmF5LCBzcGxpY2VzKSB7XHJcbiAgICAgICAgbGV0IHJlbW92ZURlbHRhID0gMDtcclxuICAgICAgICBsZXQgcm1Qcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBsZXQgc3BsaWNlID0gc3BsaWNlc1tpXTtcclxuICAgICAgICAgICAgbGV0IHJlbW92ZWQgPSBzcGxpY2UucmVtb3ZlZDtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGpqID0gcmVtb3ZlZC5sZW5ndGg7IGogPCBqajsgKytqKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdmlld09yUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVWaWV3KHNwbGljZS5pbmRleCArIHJlbW92ZURlbHRhICsgcm1Qcm9taXNlcy5sZW5ndGgsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcm1Qcm9taXNlcy5wdXNoKHZpZXdPclByb21pc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlbW92ZURlbHRhIC09IHNwbGljZS5hZGRlZENvdW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocm1Qcm9taXNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChybVByb21pc2VzKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBzcGxpY2VJbmRleExvdyA9IHRoaXMuX2hhbmRsZUFkZGVkU3BsaWNlcyhyZXBlYXQsIGFycmF5LCBzcGxpY2VzKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIHNwbGljZUluZGV4TG93KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBzcGxpY2VJbmRleExvdyA9IHRoaXMuX2hhbmRsZUFkZGVkU3BsaWNlcyhyZXBlYXQsIGFycmF5LCBzcGxpY2VzKTtcclxuICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCBzcGxpY2VJbmRleExvdyk7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIF9oYW5kbGVBZGRlZFNwbGljZXMocmVwZWF0LCBhcnJheSwgc3BsaWNlcykge1xyXG4gICAgICAgIGxldCBzcGxpY2VJbmRleDtcclxuICAgICAgICBsZXQgc3BsaWNlSW5kZXhMb3c7XHJcbiAgICAgICAgbGV0IGFycmF5TGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBsZXQgc3BsaWNlID0gc3BsaWNlc1tpXTtcclxuICAgICAgICAgICAgbGV0IGFkZEluZGV4ID0gc3BsaWNlSW5kZXggPSBzcGxpY2UuaW5kZXg7XHJcbiAgICAgICAgICAgIGxldCBlbmQgPSBzcGxpY2UuaW5kZXggKyBzcGxpY2UuYWRkZWRDb3VudDtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzcGxpY2VJbmRleExvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgc3BsaWNlSW5kZXhMb3cgPT09IG51bGwgfHwgc3BsaWNlSW5kZXhMb3cgPiBzcGxpY2UuaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHNwbGljZUluZGV4TG93ID0gc3BsaWNlSW5kZXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICg7IGFkZEluZGV4IDwgZW5kOyArK2FkZEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGFycmF5W2FkZEluZGV4XSwgYWRkSW5kZXgsIGFycmF5TGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KGFkZEluZGV4LCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNwbGljZUluZGV4TG93O1xyXG4gICAgfVxyXG59XG5cbmNsYXNzIE1hcFJlcGVhdFN0cmF0ZWd5IHtcclxuICAgIGdldENvbGxlY3Rpb25PYnNlcnZlcihvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRNYXBPYnNlcnZlcihpdGVtcyk7XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZUNoYW5nZWQocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIGxldCByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKCgpID0+IHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTtcclxuICAgIH1cclxuICAgIF9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIHZhbHVlLCBpbmRleCwgaXRlbXMuc2l6ZSwga2V5KTtcclxuICAgICAgICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICArK2luZGV4O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgbWFwLCByZWNvcmRzKSB7XHJcbiAgICAgICAgbGV0IGtleTtcclxuICAgICAgICBsZXQgaTtcclxuICAgICAgICBsZXQgaWk7XHJcbiAgICAgICAgbGV0IG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICBsZXQgcmVtb3ZlSW5kZXg7XHJcbiAgICAgICAgbGV0IGFkZEluZGV4O1xyXG4gICAgICAgIGxldCByZWNvcmQ7XHJcbiAgICAgICAgbGV0IHJtUHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBsZXQgdmlld09yUHJvbWlzZTtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlY29yZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICByZWNvcmQgPSByZWNvcmRzW2ldO1xyXG4gICAgICAgICAgICBrZXkgPSByZWNvcmQua2V5O1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHJlY29yZC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhyZW1vdmVJbmRleCwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBtYXAuZ2V0KGtleSksIHJlbW92ZUluZGV4LCBtYXAuc2l6ZSwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuaW5zZXJ0VmlldyhyZW1vdmVJbmRleCwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcclxuICAgICAgICAgICAgICAgICAgICBhZGRJbmRleCA9IHJlcGVhdC52aWV3Q291bnQoKSA8PSBtYXAuc2l6ZSAtIDEgPyByZXBlYXQudmlld0NvdW50KCkgOiBtYXAuc2l6ZSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIG1hcC5nZXQoa2V5KSwgYWRkSW5kZXgsIG1hcC5zaXplLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KG1hcC5zaXplIC0gMSwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVjb3JkLm9sZFZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJbmRleCA9IHRoaXMuX2dldFZpZXdJbmRleEJ5S2V5KHJlcGVhdCwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3T3JQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXcocmVtb3ZlSW5kZXgsIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm1Qcm9taXNlcy5wdXNoKHZpZXdPclByb21pc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyJzpcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocm1Qcm9taXNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2dldFZpZXdJbmRleEJ5S2V5KHJlcGVhdCwga2V5KSB7XHJcbiAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgbGV0IGlpO1xyXG4gICAgICAgIGxldCBjaGlsZDtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlcGVhdC52aWV3Q291bnQoKTsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgY2hpbGQgPSByZXBlYXQudmlldyhpKTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLmJpbmRpbmdDb250ZXh0W3JlcGVhdC5rZXldID09PSBrZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cblxuY2xhc3MgTnVsbFJlcGVhdFN0cmF0ZWd5IHtcclxuICAgIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUpO1xyXG4gICAgfVxyXG4gICAgZ2V0Q29sbGVjdGlvbk9ic2VydmVyKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcclxuICAgIH1cclxufVxuXG5jbGFzcyBOdW1iZXJSZXBlYXRTdHJhdGVneSB7XHJcbiAgICBnZXRDb2xsZWN0aW9uT2JzZXJ2ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZUNoYW5nZWQocmVwZWF0LCB2YWx1ZSkge1xyXG4gICAgICAgIGxldCByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKCgpID0+IHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgdmFsdWUpKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIHZhbHVlKTtcclxuICAgIH1cclxuICAgIF9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIHZhbHVlKSB7XHJcbiAgICAgICAgbGV0IGNoaWxkcmVuTGVuZ3RoID0gcmVwZWF0LnZpZXdDb3VudCgpO1xyXG4gICAgICAgIGxldCBpO1xyXG4gICAgICAgIGxldCBpaTtcclxuICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGxldCB2aWV3c1RvUmVtb3ZlO1xyXG4gICAgICAgIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSk7XHJcbiAgICAgICAgdmlld3NUb1JlbW92ZSA9IGNoaWxkcmVuTGVuZ3RoIC0gdmFsdWU7XHJcbiAgICAgICAgaWYgKHZpZXdzVG9SZW1vdmUgPiAwKSB7XHJcbiAgICAgICAgICAgIGlmICh2aWV3c1RvUmVtb3ZlID4gY2hpbGRyZW5MZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHZpZXdzVG9SZW1vdmUgPSBjaGlsZHJlbkxlbmd0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHZpZXdzVG9SZW1vdmU7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICByZXBlYXQucmVtb3ZlVmlldyhjaGlsZHJlbkxlbmd0aCAtIChpICsgMSksIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAoaSA9IGNoaWxkcmVuTGVuZ3RoLCBpaSA9IHZhbHVlOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgaSwgaSwgaWkpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIDApO1xyXG4gICAgfVxyXG59XG5cbmNsYXNzIFNldFJlcGVhdFN0cmF0ZWd5IHtcclxuICAgIGdldENvbGxlY3Rpb25PYnNlcnZlcihvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRTZXRPYnNlcnZlcihpdGVtcyk7XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZUNoYW5nZWQocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIGxldCByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKCgpID0+IHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTtcclxuICAgIH1cclxuICAgIF9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2godmFsdWUgPT4ge1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgdmFsdWUsIGluZGV4LCBpdGVtcy5zaXplKTtcclxuICAgICAgICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICArK2luZGV4O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgc2V0LCByZWNvcmRzKSB7XHJcbiAgICAgICAgbGV0IHZhbHVlO1xyXG4gICAgICAgIGxldCBpO1xyXG4gICAgICAgIGxldCBpaTtcclxuICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGxldCByZW1vdmVJbmRleDtcclxuICAgICAgICBsZXQgcmVjb3JkO1xyXG4gICAgICAgIGxldCBybVByb21pc2VzID0gW107XHJcbiAgICAgICAgbGV0IHZpZXdPclByb21pc2U7XHJcbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSByZWNvcmRzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgcmVjb3JkID0gcmVjb3Jkc1tpXTtcclxuICAgICAgICAgICAgdmFsdWUgPSByZWNvcmQudmFsdWU7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocmVjb3JkLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNpemUgPSBNYXRoLm1heChzZXQuc2l6ZSAtIDEsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCB2YWx1ZSwgc2l6ZSwgc2V0LnNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KHNpemUsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSW5kZXggPSB0aGlzLl9nZXRWaWV3SW5kZXhCeVZhbHVlKHJlcGVhdCwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhyZW1vdmVJbmRleCwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXInOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgUHJvbWlzZS5hbGwocm1Qcm9taXNlcykudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfZ2V0Vmlld0luZGV4QnlWYWx1ZShyZXBlYXQsIHZhbHVlKSB7XHJcbiAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgbGV0IGlpO1xyXG4gICAgICAgIGxldCBjaGlsZDtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlcGVhdC52aWV3Q291bnQoKTsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgY2hpbGQgPSByZXBlYXQudmlldyhpKTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLmJpbmRpbmdDb250ZXh0W3JlcGVhdC5sb2NhbF0gPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG59XG5cbmNsYXNzIFJlcGVhdFN0cmF0ZWd5TG9jYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLm1hdGNoZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5zdHJhdGVnaWVzID0gW107XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShpdGVtcyA9PiBpdGVtcyA9PT0gbnVsbCB8fCBpdGVtcyA9PT0gdW5kZWZpbmVkLCBuZXcgTnVsbFJlcGVhdFN0cmF0ZWd5KCkpO1xyXG4gICAgICAgIHRoaXMuYWRkU3RyYXRlZ3koaXRlbXMgPT4gaXRlbXMgaW5zdGFuY2VvZiBBcnJheSwgbmV3IEFycmF5UmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShpdGVtcyA9PiBpdGVtcyBpbnN0YW5jZW9mIE1hcCwgbmV3IE1hcFJlcGVhdFN0cmF0ZWd5KCkpO1xyXG4gICAgICAgIHRoaXMuYWRkU3RyYXRlZ3koaXRlbXMgPT4gaXRlbXMgaW5zdGFuY2VvZiBTZXQsIG5ldyBTZXRSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGl0ZW1zID0+IHR5cGVvZiBpdGVtcyA9PT0gJ251bWJlcicsIG5ldyBOdW1iZXJSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgIH1cclxuICAgIGFkZFN0cmF0ZWd5KG1hdGNoZXIsIHN0cmF0ZWd5KSB7XHJcbiAgICAgICAgdGhpcy5tYXRjaGVycy5wdXNoKG1hdGNoZXIpO1xyXG4gICAgICAgIHRoaXMuc3RyYXRlZ2llcy5wdXNoKHN0cmF0ZWd5KTtcclxuICAgIH1cclxuICAgIGdldFN0cmF0ZWd5KGl0ZW1zKSB7XHJcbiAgICAgICAgbGV0IG1hdGNoZXJzID0gdGhpcy5tYXRjaGVycztcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBtYXRjaGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaGVyc1tpXShpdGVtcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0cmF0ZWdpZXNbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cblxuY29uc3QgbGlmZWN5Y2xlT3B0aW9uYWxCZWhhdmlvcnMgPSBbJ2ZvY3VzJywgJ2lmJywgJ2Vsc2UnLCAncmVwZWF0JywgJ3Nob3cnLCAnaGlkZScsICd3aXRoJ107XHJcbmZ1bmN0aW9uIGJlaGF2aW9yUmVxdWlyZXNMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24pIHtcclxuICAgIGxldCB0ID0gaW5zdHJ1Y3Rpb24udHlwZTtcclxuICAgIGxldCBuYW1lID0gdC5lbGVtZW50TmFtZSAhPT0gbnVsbCA/IHQuZWxlbWVudE5hbWUgOiB0LmF0dHJpYnV0ZU5hbWU7XHJcbiAgICByZXR1cm4gbGlmZWN5Y2xlT3B0aW9uYWxCZWhhdmlvcnMuaW5kZXhPZihuYW1lKSA9PT0gLTEgJiYgKHQuaGFuZGxlc0F0dGFjaGVkIHx8IHQuaGFuZGxlc0JpbmQgfHwgdC5oYW5kbGVzQ3JlYXRlZCB8fCB0LmhhbmRsZXNEZXRhY2hlZCB8fCB0LmhhbmRsZXNVbmJpbmQpXHJcbiAgICAgICAgfHwgdC52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodC52aWV3RmFjdG9yeSlcclxuICAgICAgICB8fCBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkpO1xyXG59XHJcbmZ1bmN0aW9uIHRhcmdldFJlcXVpcmVzTGlmZWN5Y2xlKGluc3RydWN0aW9uKSB7XHJcbiAgICBsZXQgYmVoYXZpb3JzID0gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnM7XHJcbiAgICBpZiAoYmVoYXZpb3JzKSB7XHJcbiAgICAgICAgbGV0IGkgPSBiZWhhdmlvcnMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgaWYgKGJlaGF2aW9yUmVxdWlyZXNMaWZlY3ljbGUoYmVoYXZpb3JzW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgJiYgdmlld3NSZXF1aXJlTGlmZWN5Y2xlKGluc3RydWN0aW9uLnZpZXdGYWN0b3J5KTtcclxufVxyXG5mdW5jdGlvbiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3RvcnkpIHtcclxuICAgIGlmICgnX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZScgaW4gdmlld0ZhY3RvcnkpIHtcclxuICAgICAgICByZXR1cm4gdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZTtcclxuICAgIH1cclxuICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSBmYWxzZTtcclxuICAgIGlmICh2aWV3RmFjdG9yeS52aWV3RmFjdG9yeSkge1xyXG4gICAgICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3Rvcnkudmlld0ZhY3RvcnkpO1xyXG4gICAgICAgIHJldHVybiB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlO1xyXG4gICAgfVxyXG4gICAgaWYgKHZpZXdGYWN0b3J5LnRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5hdS1hbmltYXRlJykpIHtcclxuICAgICAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGlkIGluIHZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucykge1xyXG4gICAgICAgIGlmICh0YXJnZXRSZXF1aXJlc0xpZmVjeWNsZSh2aWV3RmFjdG9yeS5pbnN0cnVjdGlvbnNbaWRdKSkge1xyXG4gICAgICAgICAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XG5cbmNsYXNzIEFic3RyYWN0UmVwZWF0ZXIge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywge1xyXG4gICAgICAgICAgICBsb2NhbDogJ2l0ZW1zJyxcclxuICAgICAgICAgICAgdmlld3NSZXF1aXJlTGlmZWN5Y2xlOiB0cnVlXHJcbiAgICAgICAgfSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbiAgICB2aWV3Q291bnQoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdmlld0NvdW50YCcpO1xyXG4gICAgfVxyXG4gICAgdmlld3MoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdmlld3NgJyk7XHJcbiAgICB9XHJcbiAgICB2aWV3KGluZGV4KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdmlld2AnKTtcclxuICAgIH1cclxuICAgIG1hdGNoZXIoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgbWF0Y2hlcmAnKTtcclxuICAgIH1cclxuICAgIGFkZFZpZXcoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYGFkZFZpZXdgJyk7XHJcbiAgICB9XHJcbiAgICBpbnNlcnRWaWV3KGluZGV4LCBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgaW5zZXJ0Vmlld2AnKTtcclxuICAgIH1cclxuICAgIG1vdmVWaWV3KHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYG1vdmVWaWV3YCcpO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlQWxsVmlld3MocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHJlbW92ZUFsbFZpZXdzYCcpO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlVmlld3Modmlld3NUb1JlbW92ZSwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHJlbW92ZVZpZXdgJyk7XHJcbiAgICB9XHJcbiAgICByZW1vdmVWaWV3KGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgcmVtb3ZlVmlld2AnKTtcclxuICAgIH1cclxuICAgIHVwZGF0ZUJpbmRpbmdzKHZpZXcpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB1cGRhdGVCaW5kaW5nc2AnKTtcclxuICAgIH1cclxufVxuXG52YXIgUmVwZWF0XzE7XHJcbmxldCBSZXBlYXQgPSBSZXBlYXRfMSA9IGNsYXNzIFJlcGVhdCBleHRlbmRzIEFic3RyYWN0UmVwZWF0ZXIge1xyXG4gICAgY29uc3RydWN0b3Iodmlld0ZhY3RvcnksIGluc3RydWN0aW9uLCB2aWV3U2xvdCwgdmlld1Jlc291cmNlcywgb2JzZXJ2ZXJMb2NhdG9yLCBzdHJhdGVneUxvY2F0b3IpIHtcclxuICAgICAgICBzdXBlcih7XHJcbiAgICAgICAgICAgIGxvY2FsOiAnaXRlbScsXHJcbiAgICAgICAgICAgIHZpZXdzUmVxdWlyZUxpZmVjeWNsZTogdmlld3NSZXF1aXJlTGlmZWN5Y2xlKHZpZXdGYWN0b3J5KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLmluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gdmlld1Jlc291cmNlcy5sb29rdXBGdW5jdGlvbnM7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XHJcbiAgICAgICAgdGhpcy5rZXkgPSAna2V5JztcclxuICAgICAgICB0aGlzLnZhbHVlID0gJ3ZhbHVlJztcclxuICAgICAgICB0aGlzLnN0cmF0ZWd5TG9jYXRvciA9IHN0cmF0ZWd5TG9jYXRvcjtcclxuICAgICAgICB0aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uKHRoaXMuaW5zdHJ1Y3Rpb24sICdyZXBlYXQuZm9yJyk7XHJcbiAgICAgICAgdGhpcy5pc09uZVRpbWUgPSBpc09uZVRpbWUodGhpcy5zb3VyY2VFeHByZXNzaW9uKTtcclxuICAgICAgICB0aGlzLnZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeSk7XHJcbiAgICB9XHJcbiAgICBjYWxsKGNvbnRleHQsIGNoYW5nZXMpIHtcclxuICAgICAgICB0aGlzW2NvbnRleHRdKHRoaXMuaXRlbXMsIGNoYW5nZXMpO1xyXG4gICAgfVxyXG4gICAgYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5zY29wZSA9IHsgYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCB9O1xyXG4gICAgICAgIHRoaXMubWF0Y2hlckJpbmRpbmcgPSB0aGlzLl9jYXB0dXJlQW5kUmVtb3ZlTWF0Y2hlckJpbmRpbmcoKTtcclxuICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIHRoaXMuc2NvcGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubWF0Y2hlckJpbmRpbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHRydWUsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpO1xyXG4gICAgfVxyXG4gICAgX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIudW5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbk9ic2VydmVyID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jYWxsQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXRlbXNDaGFuZ2VkKCkge1xyXG4gICAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIGlmICghdGhpcy5zY29wZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpdGVtcyA9IHRoaXMuaXRlbXM7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXRoaXMuc3RyYXRlZ3kpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBWYWx1ZSBmb3IgJyR7dGhpcy5zb3VyY2VFeHByZXNzaW9ufScgaXMgbm9uLXJlcGVhdGFibGVgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzT25lVGltZSAmJiAhdGhpcy5fb2JzZXJ2ZUlubmVyQ29sbGVjdGlvbigpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaWdub3JlTXV0YXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc3RyYXRlZ3kuaW5zdGFuY2VDaGFuZ2VkKHRoaXMsIGl0ZW1zKTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyTG9jYXRvci50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfZ2V0SW5uZXJDb2xsZWN0aW9uKCkge1xyXG4gICAgICAgIGxldCBleHByZXNzaW9uID0gdW53cmFwRXhwcmVzc2lvbih0aGlzLnNvdXJjZUV4cHJlc3Npb24pO1xyXG4gICAgICAgIGlmICghZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgbnVsbCk7XHJcbiAgICB9XHJcbiAgICBoYW5kbGVDb2xsZWN0aW9uTXV0YXRlZChjb2xsZWN0aW9uLCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlnbm9yZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneS5pbnN0YW5jZU11dGF0ZWQodGhpcywgY29sbGVjdGlvbiwgY2hhbmdlcyk7XHJcbiAgICB9XHJcbiAgICBoYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkKGNvbGxlY3Rpb24sIGNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaWdub3JlTXV0YXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlnbm9yZU11dGF0aW9uID0gdHJ1ZTtcclxuICAgICAgICBsZXQgbmV3SXRlbXMgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzaygoKSA9PiB0aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2UpO1xyXG4gICAgICAgIGlmIChuZXdJdGVtcyA9PT0gdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ld0l0ZW1zO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9vYnNlcnZlSW5uZXJDb2xsZWN0aW9uKCkge1xyXG4gICAgICAgIGxldCBpdGVtcyA9IHRoaXMuX2dldElubmVyQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIGxldCBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXN0cmF0ZWd5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSBzdHJhdGVneS5nZXRDb2xsZWN0aW9uT2JzZXJ2ZXIodGhpcy5vYnNlcnZlckxvY2F0b3IsIGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxsQ29udGV4dCA9ICdoYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkJztcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBfb2JzZXJ2ZUNvbGxlY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGl0ZW1zID0gdGhpcy5pdGVtcztcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IHRoaXMuc3RyYXRlZ3kuZ2V0Q29sbGVjdGlvbk9ic2VydmVyKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpdGVtcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbENvbnRleHQgPSAnaGFuZGxlQ29sbGVjdGlvbk11dGF0ZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2NhcHR1cmVBbmRSZW1vdmVNYXRjaGVyQmluZGluZygpIHtcclxuICAgICAgICBjb25zdCB2aWV3RmFjdG9yeSA9IHRoaXMudmlld0ZhY3Rvcnkudmlld0ZhY3Rvcnk7XHJcbiAgICAgICAgaWYgKHZpZXdGYWN0b3J5KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdmlld0ZhY3RvcnkudGVtcGxhdGU7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IHZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucztcclxuICAgICAgICAgICAgaWYgKFJlcGVhdF8xLnVzZUlubmVyTWF0Y2hlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dHJhY3RNYXRjaGVyQmluZGluZ0V4cHJlc3Npb24oaW5zdHJ1Y3Rpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZ2V0Q2hpbGRyZW5Db3VudCh0ZW1wbGF0ZSkgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcGVhdGVkRWxlbWVudCA9IGdldEZpcnN0RWxlbWVudENoaWxkKHRlbXBsYXRlKTtcclxuICAgICAgICAgICAgaWYgKCFyZXBlYXRlZEVsZW1lbnQuaGFzQXR0cmlidXRlKCdhdS10YXJnZXQtaWQnKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByZXBlYXRlZEVsZW1lbnRUYXJnZXRJZCA9IHJlcGVhdGVkRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2F1LXRhcmdldC1pZCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gZXh0cmFjdE1hdGNoZXJCaW5kaW5nRXhwcmVzc2lvbihpbnN0cnVjdGlvbnMsIHJlcGVhdGVkRWxlbWVudFRhcmdldElkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIHZpZXdDb3VudCgpIHsgcmV0dXJuIHRoaXMudmlld1Nsb3QuY2hpbGRyZW4ubGVuZ3RoOyB9XHJcbiAgICB2aWV3cygpIHsgcmV0dXJuIHRoaXMudmlld1Nsb3QuY2hpbGRyZW47IH1cclxuICAgIHZpZXcoaW5kZXgpIHsgcmV0dXJuIHRoaXMudmlld1Nsb3QuY2hpbGRyZW5baW5kZXhdOyB9XHJcbiAgICBtYXRjaGVyKCkge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoZXJCaW5kaW5nID0gdGhpcy5tYXRjaGVyQmluZGluZztcclxuICAgICAgICByZXR1cm4gbWF0Y2hlckJpbmRpbmdcclxuICAgICAgICAgICAgPyBtYXRjaGVyQmluZGluZy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIG1hdGNoZXJCaW5kaW5nLmxvb2t1cEZ1bmN0aW9ucylcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgfVxyXG4gICAgYWRkVmlldyhiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgbGV0IHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90LmFkZCh2aWV3KTtcclxuICAgIH1cclxuICAgIGluc2VydFZpZXcoaW5kZXgsIGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICBsZXQgdmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgdmlldy5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QuaW5zZXJ0KGluZGV4LCB2aWV3KTtcclxuICAgIH1cclxuICAgIG1vdmVWaWV3KHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QubW92ZShzb3VyY2VJbmRleCwgdGFyZ2V0SW5kZXgpO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlQWxsVmlld3MocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUFsbChyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH1cclxuICAgIHJlbW92ZVZpZXdzKHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3U2xvdC5yZW1vdmVNYW55KHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlVmlldyhpbmRleCwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUF0KGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH1cclxuICAgIHVwZGF0ZUJpbmRpbmdzKHZpZXcpIHtcclxuICAgICAgICBjb25zdCAkdmlldyA9IHZpZXc7XHJcbiAgICAgICAgbGV0IGogPSAkdmlldy5iaW5kaW5ncy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGotLSkge1xyXG4gICAgICAgICAgICB1cGRhdGVPbmVUaW1lQmluZGluZygkdmlldy5iaW5kaW5nc1tqXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGogPSAkdmlldy5jb250cm9sbGVycy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGotLSkge1xyXG4gICAgICAgICAgICBsZXQgayA9ICR2aWV3LmNvbnRyb2xsZXJzW2pdLmJvdW5kUHJvcGVydGllcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChrLS0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBiaW5kaW5nID0gJHZpZXcuY29udHJvbGxlcnNbal0uYm91bmRQcm9wZXJ0aWVzW2tdLmJpbmRpbmc7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVPbmVUaW1lQmluZGluZyhiaW5kaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuUmVwZWF0LnVzZUlubmVyTWF0Y2hlciA9IHRydWU7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgUmVwZWF0LnByb3RvdHlwZSwgXCJpdGVtc1wiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIFJlcGVhdC5wcm90b3R5cGUsIFwibG9jYWxcIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kYWJsZVxyXG5dLCBSZXBlYXQucHJvdG90eXBlLCBcImtleVwiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIFJlcGVhdC5wcm90b3R5cGUsIFwidmFsdWVcIiwgdm9pZCAwKTtcclxuUmVwZWF0ID0gUmVwZWF0XzEgPSBfX2RlY29yYXRlKFtcclxuICAgIGN1c3RvbUF0dHJpYnV0ZSgncmVwZWF0JyksXHJcbiAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVGFyZ2V0SW5zdHJ1Y3Rpb24sIFZpZXdTbG90LCBWaWV3UmVzb3VyY2VzLCBPYnNlcnZlckxvY2F0b3IsIFJlcGVhdFN0cmF0ZWd5TG9jYXRvcilcclxuXSwgUmVwZWF0KTtcclxuY29uc3QgZXh0cmFjdE1hdGNoZXJCaW5kaW5nRXhwcmVzc2lvbiA9IChpbnN0cnVjdGlvbnMsIHRhcmdldGVkRWxlbWVudElkKSA9PiB7XHJcbiAgICBjb25zdCBpbnN0cnVjdGlvbklkcyA9IE9iamVjdC5rZXlzKGluc3RydWN0aW9ucyk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluc3RydWN0aW9uSWRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25JZCA9IGluc3RydWN0aW9uSWRzW2ldO1xyXG4gICAgICAgIGlmICh0YXJnZXRlZEVsZW1lbnRJZCAhPT0gdW5kZWZpbmVkICYmIGluc3RydWN0aW9uSWQgIT09IHRhcmdldGVkRWxlbWVudElkKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBleHByZXNzaW9ucyA9IGluc3RydWN0aW9uc1tpbnN0cnVjdGlvbklkXS5leHByZXNzaW9ucztcclxuICAgICAgICBpZiAoZXhwcmVzc2lvbnMpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaWkgPSAwOyBpaSA8IGV4cHJlc3Npb25zLmxlbmd0aDsgaWkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4cHJlc3Npb25zW2lpXS50YXJnZXRQcm9wZXJ0eSA9PT0gJ21hdGNoZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uID0gZXhwcmVzc2lvbnNbaWldO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25zLnNwbGljZShpaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXJCaW5kaW5nRXhwcmVzc2lvbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuY29uc3QgZ2V0Q2hpbGRyZW5Db3VudCA9IChlbCkgPT4ge1xyXG4gICAgY29uc3QgY2hpbGROb2RlcyA9IGVsLmNoaWxkTm9kZXM7XHJcbiAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gY2hpbGROb2Rlcy5sZW5ndGg7IGlpID4gaTsgKytpKSB7XHJcbiAgICAgICAgaWYgKGNoaWxkTm9kZXNbaV0ubm9kZVR5cGUgPT09IDEpIHtcclxuICAgICAgICAgICAgKytjb3VudDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY291bnQ7XHJcbn07XHJcbmNvbnN0IGdldEZpcnN0RWxlbWVudENoaWxkID0gKGVsKSA9PiB7XHJcbiAgICBsZXQgZmlyc3RDaGlsZCA9IGVsLmZpcnN0Q2hpbGQ7XHJcbiAgICB3aGlsZSAoZmlyc3RDaGlsZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIGlmIChmaXJzdENoaWxkLm5vZGVUeXBlID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaXJzdENoaWxkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaXJzdENoaWxkID0gZmlyc3RDaGlsZC5uZXh0U2libGluZztcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG5jb25zdCBhdXJlbGlhSGlkZUNsYXNzTmFtZSA9ICdhdXJlbGlhLWhpZGUnO1xyXG5jb25zdCBhdXJlbGlhSGlkZUNsYXNzID0gYC4ke2F1cmVsaWFIaWRlQ2xhc3NOYW1lfSB7IGRpc3BsYXk6bm9uZSAhaW1wb3J0YW50OyB9YDtcclxuZnVuY3Rpb24gaW5qZWN0QXVyZWxpYUhpZGVTdHlsZUF0SGVhZCgpIHtcclxuICAgIERPTS5pbmplY3RTdHlsZXMoYXVyZWxpYUhpZGVDbGFzcyk7XHJcbn1cclxuZnVuY3Rpb24gaW5qZWN0QXVyZWxpYUhpZGVTdHlsZUF0Qm91bmRhcnkoZG9tQm91bmRhcnkpIHtcclxuICAgIGlmIChGRUFUVVJFLnNoYWRvd0RPTSAmJiBkb21Cb3VuZGFyeSAmJiAhZG9tQm91bmRhcnkuaGFzQXVyZWxpYUhpZGVTdHlsZSkge1xyXG4gICAgICAgIGRvbUJvdW5kYXJ5Lmhhc0F1cmVsaWFIaWRlU3R5bGUgPSB0cnVlO1xyXG4gICAgICAgIERPTS5pbmplY3RTdHlsZXMoYXVyZWxpYUhpZGVDbGFzcywgZG9tQm91bmRhcnkpO1xyXG4gICAgfVxyXG59XG5cbmxldCBTaG93ID0gY2xhc3MgU2hvdyB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBhbmltYXRvciwgZG9tQm91bmRhcnkpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuYW5pbWF0b3IgPSBhbmltYXRvcjtcclxuICAgICAgICB0aGlzLmRvbUJvdW5kYXJ5ID0gZG9tQm91bmRhcnk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaW5qZWN0KCkge1xyXG4gICAgICAgIHJldHVybiBbRE9NLkVsZW1lbnQsIEFuaW1hdG9yLCBPcHRpb25hbC5vZihET00uYm91bmRhcnksIHRydWUpXTtcclxuICAgIH1cclxuICAgIGNyZWF0ZWQoKSB7XHJcbiAgICAgICAgaW5qZWN0QXVyZWxpYUhpZGVTdHlsZUF0Qm91bmRhcnkodGhpcy5kb21Cb3VuZGFyeSk7XHJcbiAgICB9XHJcbiAgICB2YWx1ZUNoYW5nZWQobmV3VmFsdWUpIHtcclxuICAgICAgICBsZXQgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICBsZXQgYW5pbWF0b3IgPSB0aGlzLmFuaW1hdG9yO1xyXG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICBhbmltYXRvci5yZW1vdmVDbGFzcyhlbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhbmltYXRvci5hZGRDbGFzcyhlbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgYmluZChiaW5kaW5nQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VkKHRoaXMudmFsdWUpO1xyXG4gICAgfVxyXG59O1xyXG5TaG93ID0gX19kZWNvcmF0ZShbXHJcbiAgICBjdXN0b21BdHRyaWJ1dGUoJ3Nob3cnKVxyXG5dLCBTaG93KTtcblxubGV0IEhpZGUgPSBjbGFzcyBIaWRlIHtcclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGFuaW1hdG9yLCBkb21Cb3VuZGFyeSkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5hbmltYXRvciA9IGFuaW1hdG9yO1xyXG4gICAgICAgIHRoaXMuZG9tQm91bmRhcnkgPSBkb21Cb3VuZGFyeTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBpbmplY3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtET00uRWxlbWVudCwgQW5pbWF0b3IsIE9wdGlvbmFsLm9mKERPTS5ib3VuZGFyeSwgdHJ1ZSldO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlZCgpIHtcclxuICAgICAgICBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRCb3VuZGFyeSh0aGlzLmRvbUJvdW5kYXJ5KTtcclxuICAgIH1cclxuICAgIHZhbHVlQ2hhbmdlZChuZXdWYWx1ZSkge1xyXG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdG9yLmFkZENsYXNzKHRoaXMuZWxlbWVudCwgYXVyZWxpYUhpZGVDbGFzc05hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hbmltYXRvci5yZW1vdmVDbGFzcyh0aGlzLmVsZW1lbnQsIGF1cmVsaWFIaWRlQ2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZWQodGhpcy52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICB2YWx1ZSh2YWx1ZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC4nKTtcclxuICAgIH1cclxufTtcclxuSGlkZSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgY3VzdG9tQXR0cmlidXRlKCdoaWRlJylcclxuXSwgSGlkZSk7XG5cbmNvbnN0IFNDUklQVF9SRUdFWCA9IC88c2NyaXB0XFxiW148XSooPzooPyE8XFwvc2NyaXB0Pik8W148XSopKjxcXC9zY3JpcHQ+L2dpO1xyXG5sZXQgbmVlZHNUb1dhcm4gPSB0cnVlO1xyXG5jbGFzcyBIVE1MU2FuaXRpemVyIHtcclxuICAgIHNhbml0aXplKGlucHV0KSB7XHJcbiAgICAgICAgaWYgKG5lZWRzVG9XYXJuKSB7XHJcbiAgICAgICAgICAgIG5lZWRzVG9XYXJuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGdldExvZ2dlcignaHRtbC1zYW5pdGl6ZXInKVxyXG4gICAgICAgICAgICAgICAgLndhcm4oYENBVVRJT046IFRoZSBkZWZhdWx0IEhUTUxTYW5pdGl6ZXIgZG9lcyBOT1QgcHJvdmlkZSBzZWN1cml0eSBhZ2FpbnN0IGEgd2lkZSB2YXJpZXR5IG9mIHNvcGhpc3RpY2F0ZWQgWFNTIGF0dGFja3MsXG5hbmQgc2hvdWxkIG5vdCBiZSByZWxpZWQgb24gZm9yIHNhbml0aXppbmcgaW5wdXQgZnJvbSB1bmtub3duIHNvdXJjZXMuXG5QbGVhc2Ugc2VlIGh0dHBzOi8vYXVyZWxpYS5pby9kb2NzL2JpbmRpbmcvYmFzaWNzI2VsZW1lbnQtY29udGVudCBmb3IgaW5zdHJ1Y3Rpb25zIG9uIGhvdyB0byB1c2UgYSBzZWN1cmUgc29sdXRpb24gbGlrZSBET01QdXJpZnkgb3Igc2FuaXRpemUtaHRtbC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoU0NSSVBUX1JFR0VYLCAnJyk7XHJcbiAgICB9XHJcbn1cblxubGV0IFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyID0gY2xhc3MgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIge1xyXG4gICAgY29uc3RydWN0b3Ioc2FuaXRpemVyKSB7XHJcbiAgICAgICAgdGhpcy5zYW5pdGl6ZXIgPSBzYW5pdGl6ZXI7XHJcbiAgICB9XHJcbiAgICB0b1ZpZXcodW50cnVzdGVkTWFya3VwKSB7XHJcbiAgICAgICAgaWYgKHVudHJ1c3RlZE1hcmt1cCA9PT0gbnVsbCB8fCB1bnRydXN0ZWRNYXJrdXAgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2FuaXRpemVyLnNhbml0aXplKHVudHJ1c3RlZE1hcmt1cCk7XHJcbiAgICB9XHJcbn07XHJcblNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyID0gX19kZWNvcmF0ZShbXHJcbiAgICB2YWx1ZUNvbnZlcnRlcignc2FuaXRpemVIVE1MJyksXHJcbiAgICBpbmplY3QoSFRNTFNhbml0aXplcilcclxuXSwgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIpO1xuXG5sZXQgUmVwbGFjZWFibGUgPSBjbGFzcyBSZXBsYWNlYWJsZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcih2aWV3RmFjdG9yeSwgdmlld1Nsb3QpIHtcclxuICAgICAgICB0aGlzLnZpZXdGYWN0b3J5ID0gdmlld0ZhY3Rvcnk7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICBpZiAodGhpcy52aWV3ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldy5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcclxuICAgIH1cclxufTtcclxuUmVwbGFjZWFibGUgPSBfX2RlY29yYXRlKFtcclxuICAgIGN1c3RvbUF0dHJpYnV0ZSgncmVwbGFjZWFibGUnKSxcclxuICAgIHRlbXBsYXRlQ29udHJvbGxlcixcclxuICAgIGluamVjdChCb3VuZFZpZXdGYWN0b3J5LCBWaWV3U2xvdClcclxuXSwgUmVwbGFjZWFibGUpO1xuXG5sZXQgRm9jdXMgPSBjbGFzcyBGb2N1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCB0YXNrUXVldWUpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMudGFza1F1ZXVlID0gdGFza1F1ZXVlO1xyXG4gICAgICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmVlZHNBcHBseSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGluamVjdCgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBUYXNrUXVldWVdO1xyXG4gICAgfVxyXG4gICAgdmFsdWVDaGFuZ2VkKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5uZWVkc0FwcGx5ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfYXBwbHkoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYmx1cigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGF0dGFjaGVkKCkge1xyXG4gICAgICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMubmVlZHNBcHBseSkge1xyXG4gICAgICAgICAgICB0aGlzLm5lZWRzQXBwbHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fYXBwbHkoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzKTtcclxuICAgIH1cclxuICAgIGRldGFjaGVkKCkge1xyXG4gICAgICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcyk7XHJcbiAgICB9XHJcbiAgICBoYW5kbGVFdmVudChlKSB7XHJcbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ2ZvY3VzJykge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoRE9NLmFjdGl2ZUVsZW1lbnQgIT09IHRoaXMuZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5Gb2N1cyA9IF9fZGVjb3JhdGUoW1xyXG4gICAgY3VzdG9tQXR0cmlidXRlKCdmb2N1cycsIGJpbmRpbmdNb2RlLnR3b1dheSlcclxuXSwgRm9jdXMpO1xuXG5sZXQgY3NzVXJsTWF0Y2hlciA9IC91cmxcXCgoPyFbJ1wiXWRhdGEpKFteKV0rKVxcKS9naTtcclxuZnVuY3Rpb24gZml4dXBDU1NVcmxzKGFkZHJlc3MsIGNzcykge1xyXG4gICAgaWYgKHR5cGVvZiBjc3MgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgbG9hZGluZyByZXF1aXJlZCBDU1MgZmlsZTogJHthZGRyZXNzfWApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNzcy5yZXBsYWNlKGNzc1VybE1hdGNoZXIsIChtYXRjaCwgcDEpID0+IHtcclxuICAgICAgICBsZXQgcXVvdGUgPSBwMS5jaGFyQXQoMCk7XHJcbiAgICAgICAgaWYgKHF1b3RlID09PSAnXFwnJyB8fCBxdW90ZSA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICBwMSA9IHAxLnN1YnN0cigxLCBwMS5sZW5ndGggLSAyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICd1cmwoXFwnJyArIHJlbGF0aXZlVG9GaWxlKHAxLCBhZGRyZXNzKSArICdcXCcpJztcclxuICAgIH0pO1xyXG59XHJcbmNsYXNzIENTU1Jlc291cmNlIHtcclxuICAgIGNvbnN0cnVjdG9yKGFkZHJlc3MpIHtcclxuICAgICAgICB0aGlzLmFkZHJlc3MgPSBhZGRyZXNzO1xyXG4gICAgICAgIHRoaXMuX3Njb3BlZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fZ2xvYmFsID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGluaXRpYWxpemUoY29udGFpbmVyLCBUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLl9zY29wZWQgPSBuZXcgVGFyZ2V0KHRoaXMpO1xyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcclxuICAgICAgICBpZiAobmFtZSA9PT0gJ3Njb3BlZCcpIHtcclxuICAgICAgICAgICAgcmVnaXN0cnkucmVnaXN0ZXJWaWV3RW5naW5lSG9va3ModGhpcy5fc2NvcGVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dsb2JhbCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbG9hZChjb250YWluZXIpIHtcclxuICAgICAgICByZXR1cm4gY29udGFpbmVyLmdldChMb2FkZXIpXHJcbiAgICAgICAgICAgIC5sb2FkVGV4dCh0aGlzLmFkZHJlc3MpXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gbnVsbClcclxuICAgICAgICAgICAgLnRoZW4odGV4dCA9PiB7XHJcbiAgICAgICAgICAgIHRleHQgPSBmaXh1cENTU1VybHModGhpcy5hZGRyZXNzLCB0ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy5fc2NvcGVkLmNzcyA9IHRleHQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9nbG9iYWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FscmVhZHlHbG9iYWxseUluamVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIERPTS5pbmplY3RTdHlsZXModGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBDU1NWaWV3RW5naW5lSG9va3Mge1xyXG4gICAgY29uc3RydWN0b3Iob3duZXIpIHtcclxuICAgICAgICB0aGlzLm93bmVyID0gb3duZXI7XHJcbiAgICAgICAgdGhpcy5jc3MgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgYmVmb3JlQ29tcGlsZShjb250ZW50LCByZXNvdXJjZXMsIGluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgaWYgKGluc3RydWN0aW9uLnRhcmdldFNoYWRvd0RPTSkge1xyXG4gICAgICAgICAgICBET00uaW5qZWN0U3R5bGVzKHRoaXMuY3NzLCBjb250ZW50LCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoRkVBVFVSRS5zY29wZWRDU1MpIHtcclxuICAgICAgICAgICAgbGV0IHN0eWxlTm9kZSA9IERPTS5pbmplY3RTdHlsZXModGhpcy5jc3MsIGNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgICAgICBzdHlsZU5vZGUuc2V0QXR0cmlidXRlKCdzY29wZWQnLCAnc2NvcGVkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2dsb2JhbCAmJiAhdGhpcy5vd25lci5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQpIHtcclxuICAgICAgICAgICAgRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcyk7XHJcbiAgICAgICAgICAgIHRoaXMub3duZXIuX2FscmVhZHlHbG9iYWxseUluamVjdGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gX2NyZWF0ZUNTU1Jlc291cmNlKGFkZHJlc3MpIHtcclxuICAgIGxldCBWaWV3Q1NTID0gY2xhc3MgVmlld0NTUyBleHRlbmRzIENTU1ZpZXdFbmdpbmVIb29rcyB7XHJcbiAgICB9O1xyXG4gICAgVmlld0NTUyA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIHJlc291cmNlKG5ldyBDU1NSZXNvdXJjZShhZGRyZXNzKSlcclxuICAgIF0sIFZpZXdDU1MpO1xyXG4gICAgcmV0dXJuIFZpZXdDU1M7XHJcbn1cblxubGV0IEF0dHJCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBBdHRyQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgYmluZGluZy50YXJnZXRPYnNlcnZlciA9IG5ldyBEYXRhQXR0cmlidXRlT2JzZXJ2ZXIoYmluZGluZy50YXJnZXQsIGJpbmRpbmcudGFyZ2V0UHJvcGVydHkpO1xyXG4gICAgfVxyXG4gICAgdW5iaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgfVxyXG59O1xyXG5BdHRyQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kaW5nQmVoYXZpb3IoJ2F0dHInKVxyXG5dLCBBdHRyQmluZGluZ0JlaGF2aW9yKTtcblxubGV0IG1vZGVCaW5kaW5nQmVoYXZpb3IgPSB7XHJcbiAgICBiaW5kKGJpbmRpbmcsIHNvdXJjZSwgbG9va3VwRnVuY3Rpb25zKSB7XHJcbiAgICAgICAgYmluZGluZy5vcmlnaW5hbE1vZGUgPSBiaW5kaW5nLm1vZGU7XHJcbiAgICAgICAgYmluZGluZy5tb2RlID0gdGhpcy5tb2RlO1xyXG4gICAgfSxcclxuICAgIHVuYmluZChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBiaW5kaW5nLm1vZGUgPSBiaW5kaW5nLm9yaWdpbmFsTW9kZTtcclxuICAgICAgICBiaW5kaW5nLm9yaWdpbmFsTW9kZSA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcbmxldCBPbmVUaW1lQmluZGluZ0JlaGF2aW9yID0gY2xhc3MgT25lVGltZUJpbmRpbmdCZWhhdmlvciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLm1vZGUgPSBiaW5kaW5nTW9kZS5vbmVUaW1lO1xyXG4gICAgfVxyXG59O1xyXG5PbmVUaW1lQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgIGJpbmRpbmdCZWhhdmlvcignb25lVGltZScpXHJcbl0sIE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IpO1xyXG5sZXQgT25lV2F5QmluZGluZ0JlaGF2aW9yID0gY2xhc3MgT25lV2F5QmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLnRvVmlldztcclxuICAgIH1cclxufTtcclxuT25lV2F5QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgIGJpbmRpbmdCZWhhdmlvcignb25lV2F5JylcclxuXSwgT25lV2F5QmluZGluZ0JlaGF2aW9yKTtcclxubGV0IFRvVmlld0JpbmRpbmdCZWhhdmlvciA9IGNsYXNzIFRvVmlld0JpbmRpbmdCZWhhdmlvciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLm1vZGUgPSBiaW5kaW5nTW9kZS50b1ZpZXc7XHJcbiAgICB9XHJcbn07XHJcblRvVmlld0JpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgbWl4aW4obW9kZUJpbmRpbmdCZWhhdmlvciksXHJcbiAgICBiaW5kaW5nQmVoYXZpb3IoJ3RvVmlldycpXHJcbl0sIFRvVmlld0JpbmRpbmdCZWhhdmlvcik7XHJcbmxldCBGcm9tVmlld0JpbmRpbmdCZWhhdmlvciA9IGNsYXNzIEZyb21WaWV3QmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLmZyb21WaWV3O1xyXG4gICAgfVxyXG59O1xyXG5Gcm9tVmlld0JpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgbWl4aW4obW9kZUJpbmRpbmdCZWhhdmlvciksXHJcbiAgICBiaW5kaW5nQmVoYXZpb3IoJ2Zyb21WaWV3JylcclxuXSwgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IpO1xyXG5sZXQgVHdvV2F5QmluZGluZ0JlaGF2aW9yID0gY2xhc3MgVHdvV2F5QmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLnR3b1dheTtcclxuICAgIH1cclxufTtcclxuVHdvV2F5QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgIGJpbmRpbmdCZWhhdmlvcigndHdvV2F5JylcclxuXSwgVHdvV2F5QmluZGluZ0JlaGF2aW9yKTtcblxuZnVuY3Rpb24gdGhyb3R0bGUobmV3VmFsdWUpIHtcclxuICAgIGxldCBzdGF0ZSA9IHRoaXMudGhyb3R0bGVTdGF0ZTtcclxuICAgIGxldCBlbGFwc2VkID0gK25ldyBEYXRlKCkgLSBzdGF0ZS5sYXN0O1xyXG4gICAgaWYgKGVsYXBzZWQgPj0gc3RhdGUuZGVsYXkpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcclxuICAgICAgICBzdGF0ZS50aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgIHN0YXRlLmxhc3QgPSArbmV3IERhdGUoKTtcclxuICAgICAgICB0aGlzLnRocm90dGxlZE1ldGhvZChuZXdWYWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgc3RhdGUubmV3VmFsdWUgPSBuZXdWYWx1ZTtcclxuICAgIGlmIChzdGF0ZS50aW1lb3V0SWQgPT09IG51bGwpIHtcclxuICAgICAgICBzdGF0ZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgc3RhdGUudGltZW91dElkID0gbnVsbDtcclxuICAgICAgICAgICAgc3RhdGUubGFzdCA9ICtuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnRocm90dGxlZE1ldGhvZChzdGF0ZS5uZXdWYWx1ZSk7XHJcbiAgICAgICAgfSwgc3RhdGUuZGVsYXkgLSBlbGFwc2VkKTtcclxuICAgIH1cclxufVxyXG5sZXQgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciB7XHJcbiAgICBiaW5kKGJpbmRpbmcsIHNvdXJjZSwgZGVsYXkgPSAyMDApIHtcclxuICAgICAgICBsZXQgbWV0aG9kVG9UaHJvdHRsZSA9ICd1cGRhdGVUYXJnZXQnO1xyXG4gICAgICAgIGlmIChiaW5kaW5nLmNhbGxTb3VyY2UpIHtcclxuICAgICAgICAgICAgbWV0aG9kVG9UaHJvdHRsZSA9ICdjYWxsU291cmNlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYmluZGluZy51cGRhdGVTb3VyY2UgJiYgYmluZGluZy5tb2RlID09PSBiaW5kaW5nTW9kZS50d29XYXkpIHtcclxuICAgICAgICAgICAgbWV0aG9kVG9UaHJvdHRsZSA9ICd1cGRhdGVTb3VyY2UnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZCA9IGJpbmRpbmdbbWV0aG9kVG9UaHJvdHRsZV07XHJcbiAgICAgICAgYmluZGluZy50aHJvdHRsZWRNZXRob2Qub3JpZ2luYWxOYW1lID0gbWV0aG9kVG9UaHJvdHRsZTtcclxuICAgICAgICBiaW5kaW5nW21ldGhvZFRvVGhyb3R0bGVdID0gdGhyb3R0bGU7XHJcbiAgICAgICAgYmluZGluZy50aHJvdHRsZVN0YXRlID0ge1xyXG4gICAgICAgICAgICBkZWxheTogZGVsYXksXHJcbiAgICAgICAgICAgIGxhc3Q6IDAsXHJcbiAgICAgICAgICAgIHRpbWVvdXRJZDogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgbGV0IG1ldGhvZFRvUmVzdG9yZSA9IGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kLm9yaWdpbmFsTmFtZTtcclxuICAgICAgICBiaW5kaW5nW21ldGhvZFRvUmVzdG9yZV0gPSBiaW5kaW5nLnRocm90dGxlZE1ldGhvZDtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZCA9IG51bGw7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KGJpbmRpbmcudGhyb3R0bGVTdGF0ZS50aW1lb3V0SWQpO1xyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVTdGF0ZSA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcblRocm90dGxlQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kaW5nQmVoYXZpb3IoJ3Rocm90dGxlJylcclxuXSwgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IpO1xuXG5jb25zdCB1bnNldCA9IHt9O1xyXG5mdW5jdGlvbiBkZWJvdW5jZUNhbGxTb3VyY2UoZXZlbnQpIHtcclxuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5kZWJvdW5jZVN0YXRlO1xyXG4gICAgY2xlYXJUaW1lb3V0KHN0YXRlLnRpbWVvdXRJZCk7XHJcbiAgICBzdGF0ZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZGVib3VuY2VkTWV0aG9kKGV2ZW50KSwgc3RhdGUuZGVsYXkpO1xyXG59XHJcbmZ1bmN0aW9uIGRlYm91bmNlQ2FsbChjb250ZXh0LCBuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5kZWJvdW5jZVN0YXRlO1xyXG4gICAgY2xlYXJUaW1lb3V0KHN0YXRlLnRpbWVvdXRJZCk7XHJcbiAgICBpZiAoY29udGV4dCAhPT0gc3RhdGUuY2FsbENvbnRleHRUb0RlYm91bmNlKSB7XHJcbiAgICAgICAgc3RhdGUub2xkVmFsdWUgPSB1bnNldDtcclxuICAgICAgICB0aGlzLmRlYm91bmNlZE1ldGhvZChjb250ZXh0LCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChzdGF0ZS5vbGRWYWx1ZSA9PT0gdW5zZXQpIHtcclxuICAgICAgICBzdGF0ZS5vbGRWYWx1ZSA9IG9sZFZhbHVlO1xyXG4gICAgfVxyXG4gICAgc3RhdGUudGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgX29sZFZhbHVlID0gc3RhdGUub2xkVmFsdWU7XHJcbiAgICAgICAgc3RhdGUub2xkVmFsdWUgPSB1bnNldDtcclxuICAgICAgICB0aGlzLmRlYm91bmNlZE1ldGhvZChjb250ZXh0LCBuZXdWYWx1ZSwgX29sZFZhbHVlKTtcclxuICAgIH0sIHN0YXRlLmRlbGF5KTtcclxufVxyXG5sZXQgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvciB7XHJcbiAgICBiaW5kKGJpbmRpbmcsIHNvdXJjZSwgZGVsYXkgPSAyMDApIHtcclxuICAgICAgICBjb25zdCBpc0NhbGxTb3VyY2UgPSBiaW5kaW5nLmNhbGxTb3VyY2UgIT09IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBtZXRob2RUb0RlYm91bmNlID0gaXNDYWxsU291cmNlID8gJ2NhbGxTb3VyY2UnIDogJ2NhbGwnO1xyXG4gICAgICAgIGNvbnN0IGRlYm91bmNlciA9IGlzQ2FsbFNvdXJjZSA/IGRlYm91bmNlQ2FsbFNvdXJjZSA6IGRlYm91bmNlQ2FsbDtcclxuICAgICAgICBjb25zdCBtb2RlID0gYmluZGluZy5tb2RlO1xyXG4gICAgICAgIGNvbnN0IGNhbGxDb250ZXh0VG9EZWJvdW5jZSA9IG1vZGUgPT09IGJpbmRpbmdNb2RlLnR3b1dheSB8fCBtb2RlID09PSBiaW5kaW5nTW9kZS5mcm9tVmlldyA/IHRhcmdldENvbnRleHQgOiBzb3VyY2VDb250ZXh0O1xyXG4gICAgICAgIGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kID0gYmluZGluZ1ttZXRob2RUb0RlYm91bmNlXTtcclxuICAgICAgICBiaW5kaW5nLmRlYm91bmNlZE1ldGhvZC5vcmlnaW5hbE5hbWUgPSBtZXRob2RUb0RlYm91bmNlO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9EZWJvdW5jZV0gPSBkZWJvdW5jZXI7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZVN0YXRlID0ge1xyXG4gICAgICAgICAgICBjYWxsQ29udGV4dFRvRGVib3VuY2UsXHJcbiAgICAgICAgICAgIGRlbGF5LFxyXG4gICAgICAgICAgICB0aW1lb3V0SWQ6IDAsXHJcbiAgICAgICAgICAgIG9sZFZhbHVlOiB1bnNldFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgY29uc3QgbWV0aG9kVG9SZXN0b3JlID0gYmluZGluZy5kZWJvdW5jZWRNZXRob2Qub3JpZ2luYWxOYW1lO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9SZXN0b3JlXSA9IGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kO1xyXG4gICAgICAgIGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kID0gbnVsbDtcclxuICAgICAgICBjbGVhclRpbWVvdXQoYmluZGluZy5kZWJvdW5jZVN0YXRlLnRpbWVvdXRJZCk7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZVN0YXRlID0gbnVsbDtcclxuICAgIH1cclxufTtcclxuRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGJpbmRpbmdCZWhhdmlvcignZGVib3VuY2UnKVxyXG5dLCBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvcik7XG5cbmZ1bmN0aW9uIGZpbmRPcmlnaW5hbEV2ZW50VGFyZ2V0KGV2ZW50KSB7XHJcbiAgICByZXR1cm4gKGV2ZW50LnBhdGggJiYgZXZlbnQucGF0aFswXSkgfHwgKGV2ZW50LmRlZXBQYXRoICYmIGV2ZW50LmRlZXBQYXRoWzBdKSB8fCBldmVudC50YXJnZXQ7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlU2VsZkV2ZW50KGV2ZW50KSB7XHJcbiAgICBsZXQgdGFyZ2V0ID0gZmluZE9yaWdpbmFsRXZlbnRUYXJnZXQoZXZlbnQpO1xyXG4gICAgaWYgKHRoaXMudGFyZ2V0ICE9PSB0YXJnZXQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNlbGZFdmVudENhbGxTb3VyY2UoZXZlbnQpO1xyXG59XHJcbmxldCBTZWxmQmluZGluZ0JlaGF2aW9yID0gY2xhc3MgU2VsZkJpbmRpbmdCZWhhdmlvciB7XHJcbiAgICBiaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGlmICghYmluZGluZy5jYWxsU291cmNlIHx8ICFiaW5kaW5nLnRhcmdldEV2ZW50KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2VsZiBiaW5kaW5nIGJlaGF2aW9yIG9ubHkgc3VwcG9ydHMgZXZlbnQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJpbmRpbmcuc2VsZkV2ZW50Q2FsbFNvdXJjZSA9IGJpbmRpbmcuY2FsbFNvdXJjZTtcclxuICAgICAgICBiaW5kaW5nLmNhbGxTb3VyY2UgPSBoYW5kbGVTZWxmRXZlbnQ7XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgYmluZGluZy5jYWxsU291cmNlID0gYmluZGluZy5zZWxmRXZlbnRDYWxsU291cmNlO1xyXG4gICAgICAgIGJpbmRpbmcuc2VsZkV2ZW50Q2FsbFNvdXJjZSA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcblNlbGZCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGJpbmRpbmdCZWhhdmlvcignc2VsZicpXHJcbl0sIFNlbGZCaW5kaW5nQmVoYXZpb3IpO1xuXG5jbGFzcyBCaW5kaW5nU2lnbmFsZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5zaWduYWxzID0ge307XHJcbiAgICB9XHJcbiAgICBzaWduYWwobmFtZSkge1xyXG4gICAgICAgIGxldCBiaW5kaW5ncyA9IHRoaXMuc2lnbmFsc1tuYW1lXTtcclxuICAgICAgICBpZiAoIWJpbmRpbmdzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGkgPSBiaW5kaW5ncy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICBiaW5kaW5nc1tpXS5jYWxsKHNvdXJjZUNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5sZXQgU2lnbmFsQmluZGluZ0JlaGF2aW9yID0gY2xhc3MgU2lnbmFsQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGJpbmRpbmdTaWduYWxlcikge1xyXG4gICAgICAgIHRoaXMuc2lnbmFscyA9IGJpbmRpbmdTaWduYWxlci5zaWduYWxzO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGluamVjdCgpIHsgcmV0dXJuIFtCaW5kaW5nU2lnbmFsZXJdOyB9XHJcbiAgICBiaW5kKGJpbmRpbmcsIHNvdXJjZSwgLi4ubmFtZXMpIHtcclxuICAgICAgICBpZiAoIWJpbmRpbmcudXBkYXRlVGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT25seSBwcm9wZXJ0eSBiaW5kaW5ncyBhbmQgc3RyaW5nIGludGVycG9sYXRpb24gYmluZGluZ3MgY2FuIGJlIHNpZ25hbGVkLiAgVHJpZ2dlciwgZGVsZWdhdGUgYW5kIGNhbGwgYmluZGluZ3MgY2Fubm90IGJlIHNpZ25hbGVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgc2lnbmFscyA9IHRoaXMuc2lnbmFscztcclxuICAgICAgICBpZiAobmFtZXMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gbmFtZXNbMF07XHJcbiAgICAgICAgICAgIGxldCBiaW5kaW5ncyA9IHNpZ25hbHNbbmFtZV0gfHwgKHNpZ25hbHNbbmFtZV0gPSBbXSk7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzLnB1c2goYmluZGluZyk7XHJcbiAgICAgICAgICAgIGJpbmRpbmcuc2lnbmFsTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG5hbWVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgbGV0IGkgPSBuYW1lcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBuYW1lID0gbmFtZXNbaV07XHJcbiAgICAgICAgICAgICAgICBsZXQgYmluZGluZ3MgPSBzaWduYWxzW25hbWVdIHx8IChzaWduYWxzW25hbWVdID0gW10pO1xyXG4gICAgICAgICAgICAgICAgYmluZGluZ3MucHVzaChiaW5kaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiaW5kaW5nLnNpZ25hbE5hbWUgPSBuYW1lcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2lnbmFsIG5hbWUgaXMgcmVxdWlyZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdW5iaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGxldCBzaWduYWxzID0gdGhpcy5zaWduYWxzO1xyXG4gICAgICAgIGxldCBuYW1lID0gYmluZGluZy5zaWduYWxOYW1lO1xyXG4gICAgICAgIGJpbmRpbmcuc2lnbmFsTmFtZSA9IG51bGw7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZSkpIHtcclxuICAgICAgICAgICAgbGV0IG5hbWVzID0gbmFtZTtcclxuICAgICAgICAgICAgbGV0IGkgPSBuYW1lcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gbmFtZXNbaV07XHJcbiAgICAgICAgICAgICAgICBsZXQgYmluZGluZ3MgPSBzaWduYWxzW25dO1xyXG4gICAgICAgICAgICAgICAgYmluZGluZ3Muc3BsaWNlKGJpbmRpbmdzLmluZGV4T2YoYmluZGluZyksIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgYmluZGluZ3MgPSBzaWduYWxzW25hbWVdO1xyXG4gICAgICAgICAgICBiaW5kaW5ncy5zcGxpY2UoYmluZGluZ3MuaW5kZXhPZihiaW5kaW5nKSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5TaWduYWxCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGJpbmRpbmdCZWhhdmlvcignc2lnbmFsJylcclxuXSwgU2lnbmFsQmluZGluZ0JlaGF2aW9yKTtcblxuY29uc3QgZXZlbnROYW1lc1JlcXVpcmVkID0gJ1RoZSB1cGRhdGVUcmlnZ2VyIGJpbmRpbmcgYmVoYXZpb3IgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIGV2ZW50IG5hbWUgYXJndW1lbnQ6IGVnIDxpbnB1dCB2YWx1ZS5iaW5kPVwiZmlyc3ROYW1lICYgdXBkYXRlVHJpZ2dlcjpcXCdibHVyXFwnXCI+JztcclxuY29uc3Qgbm90QXBwbGljYWJsZU1lc3NhZ2UgPSAnVGhlIHVwZGF0ZVRyaWdnZXIgYmluZGluZyBiZWhhdmlvciBjYW4gb25seSBiZSBhcHBsaWVkIHRvIHR3by13YXkvIGZyb20tdmlldyBiaW5kaW5ncyBvbiBpbnB1dC9zZWxlY3QgZWxlbWVudHMuJztcclxubGV0IFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGJpbmQoYmluZGluZywgc291cmNlLCAuLi5ldmVudHMpIHtcclxuICAgICAgICBpZiAoZXZlbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXZlbnROYW1lc1JlcXVpcmVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGJpbmRpbmcubW9kZSAhPT0gYmluZGluZ01vZGUudHdvV2F5ICYmIGJpbmRpbmcubW9kZSAhPT0gYmluZGluZ01vZGUuZnJvbVZpZXcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG5vdEFwcGxpY2FibGVNZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHRhcmdldE9ic2VydmVyID0gYmluZGluZy5vYnNlcnZlckxvY2F0b3IuZ2V0T2JzZXJ2ZXIoYmluZGluZy50YXJnZXQsIGJpbmRpbmcudGFyZ2V0UHJvcGVydHkpO1xyXG4gICAgICAgIGlmICghdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlcikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3Iobm90QXBwbGljYWJsZU1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBiaW5kaW5nLnRhcmdldE9ic2VydmVyID0gdGFyZ2V0T2JzZXJ2ZXI7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIub3JpZ2luYWxIYW5kbGVyID0gYmluZGluZy50YXJnZXRPYnNlcnZlci5oYW5kbGVyO1xyXG4gICAgICAgIGxldCBoYW5kbGVyID0gbmV3IEV2ZW50U3Vic2NyaWJlcihldmVudHMpO1xyXG4gICAgICAgIHRhcmdldE9ic2VydmVyLmhhbmRsZXIgPSBoYW5kbGVyO1xyXG4gICAgfVxyXG4gICAgdW5iaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGxldCB0YXJnZXRPYnNlcnZlciA9IGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXI7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlciA9IHRhcmdldE9ic2VydmVyLm9yaWdpbmFsSGFuZGxlcjtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5vcmlnaW5hbEhhbmRsZXIgPSBudWxsO1xyXG4gICAgfVxyXG59O1xyXG5VcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kaW5nQmVoYXZpb3IoJ3VwZGF0ZVRyaWdnZXInKVxyXG5dLCBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yKTtcblxuZnVuY3Rpb24gX2NyZWF0ZUR5bmFtaWNFbGVtZW50KHsgbmFtZSwgdmlld1VybCwgYmluZGFibGVOYW1lcywgdXNlU2hhZG93RE9NbW9kZSB9KSB7XHJcbiAgICBsZXQgRHluYW1pY0VsZW1lbnQgPSBjbGFzcyBEeW5hbWljRWxlbWVudCB7XHJcbiAgICAgICAgYmluZChiaW5kaW5nQ29udGV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLiRwYXJlbnQgPSBiaW5kaW5nQ29udGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRHluYW1pY0VsZW1lbnQgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBjdXN0b21FbGVtZW50KG5hbWUpLFxyXG4gICAgICAgIHVzZVZpZXcodmlld1VybClcclxuICAgIF0sIER5bmFtaWNFbGVtZW50KTtcclxuICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGJpbmRhYmxlTmFtZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgIGJpbmRhYmxlKGJpbmRhYmxlTmFtZXNbaV0pKER5bmFtaWNFbGVtZW50KTtcclxuICAgIH1cclxuICAgIHN3aXRjaCAodXNlU2hhZG93RE9NbW9kZSkge1xyXG4gICAgICAgIGNhc2UgJ29wZW4nOlxyXG4gICAgICAgICAgICB1c2VTaGFkb3dET00oeyBtb2RlOiAnb3BlbicgfSkoRHluYW1pY0VsZW1lbnQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdjbG9zZWQnOlxyXG4gICAgICAgICAgICB1c2VTaGFkb3dET00oeyBtb2RlOiAnY2xvc2VkJyB9KShEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJyc6XHJcbiAgICAgICAgICAgIHVzZVNoYWRvd0RPTShEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgbnVsbDpcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgZ2V0TG9nZ2VyKCdhdXJlbGlhLWh0bWwtb25seS1lbGVtZW50JylcclxuICAgICAgICAgICAgICAgIC53YXJuKGBFeHBlY3RlZCAndXNlLXNoYWRvdy1kb20nIHZhbHVlIHRvIGJlIFwiY2xvc2VcIiwgXCJvcGVuXCIgb3IgXCJcIiwgcmVjZWl2ZWQgJHt1c2VTaGFkb3dET01tb2RlfWApO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIHJldHVybiBEeW5hbWljRWxlbWVudDtcclxufVxuXG5mdW5jdGlvbiBnZXRFbGVtZW50TmFtZShhZGRyZXNzKSB7XHJcbiAgICByZXR1cm4gLyhbXlxcL15cXD9dKylcXC5odG1sL2kuZXhlYyhhZGRyZXNzKVsxXS50b0xvd2VyQ2FzZSgpO1xyXG59XHJcbmZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcpIHtcclxuICAgIGNvbnN0IHZpZXdFbmdpbmUgPSBjb25maWcuY29udGFpbmVyLmdldChWaWV3RW5naW5lKTtcclxuICAgIGNvbnN0IGxvYWRlciA9IGNvbmZpZy5hdXJlbGlhLmxvYWRlcjtcclxuICAgIHZpZXdFbmdpbmUuYWRkUmVzb3VyY2VQbHVnaW4oJy5odG1sJywge1xyXG4gICAgICAgICdmZXRjaCc6IGZ1bmN0aW9uICh2aWV3VXJsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXIubG9hZFRlbXBsYXRlKHZpZXdVcmwpLnRoZW4ocmVnaXN0cnlFbnRyeSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYmluZGFibGVOYW1lcyA9IHJlZ2lzdHJ5RW50cnkudGVtcGxhdGUuZ2V0QXR0cmlidXRlKCdiaW5kYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdXNlU2hhZG93RE9NbW9kZSA9IHJlZ2lzdHJ5RW50cnkudGVtcGxhdGUuZ2V0QXR0cmlidXRlKCd1c2Utc2hhZG93LWRvbScpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGdldEVsZW1lbnROYW1lKHZpZXdVcmwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJpbmRhYmxlTmFtZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBiaW5kYWJsZU5hbWVzID0gYmluZGFibGVOYW1lcy5zcGxpdCgnLCcpLm1hcCh4ID0+IHgudHJpbSgpKTtcclxuICAgICAgICAgICAgICAgICAgICByZWdpc3RyeUVudHJ5LnRlbXBsYXRlLnJlbW92ZUF0dHJpYnV0ZSgnYmluZGFibGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbmRhYmxlTmFtZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB7IFtuYW1lXTogX2NyZWF0ZUR5bmFtaWNFbGVtZW50KHsgbmFtZSwgdmlld1VybCwgYmluZGFibGVOYW1lcywgdXNlU2hhZG93RE9NbW9kZSB9KSB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxuXG5mdW5jdGlvbiBjb25maWd1cmUkMShjb25maWcpIHtcclxuICAgIGluamVjdEF1cmVsaWFIaWRlU3R5bGVBdEhlYWQoKTtcclxuICAgIGNvbmZpZy5nbG9iYWxSZXNvdXJjZXMoQ29tcG9zZSwgSWYsIEVsc2UsIFdpdGgsIFJlcGVhdCwgU2hvdywgSGlkZSwgUmVwbGFjZWFibGUsIEZvY3VzLCBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciwgT25lVGltZUJpbmRpbmdCZWhhdmlvciwgT25lV2F5QmluZGluZ0JlaGF2aW9yLCBUb1ZpZXdCaW5kaW5nQmVoYXZpb3IsIEZyb21WaWV3QmluZGluZ0JlaGF2aW9yLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IsIFRocm90dGxlQmluZGluZ0JlaGF2aW9yLCBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvciwgU2VsZkJpbmRpbmdCZWhhdmlvciwgU2lnbmFsQmluZGluZ0JlaGF2aW9yLCBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yLCBBdHRyQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIGNvbmZpZ3VyZShjb25maWcpO1xyXG4gICAgbGV0IHZpZXdFbmdpbmUgPSBjb25maWcuY29udGFpbmVyLmdldChWaWV3RW5naW5lKTtcclxuICAgIGxldCBzdHlsZVJlc291cmNlUGx1Z2luID0ge1xyXG4gICAgICAgIGZldGNoKGFkZHJlc3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgW2FkZHJlc3NdOiBfY3JlYXRlQ1NTUmVzb3VyY2UoYWRkcmVzcykgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgWycuY3NzJywgJy5sZXNzJywgJy5zYXNzJywgJy5zY3NzJywgJy5zdHlsJ10uZm9yRWFjaChleHQgPT4gdmlld0VuZ2luZS5hZGRSZXNvdXJjZVBsdWdpbihleHQsIHN0eWxlUmVzb3VyY2VQbHVnaW4pKTtcclxufVxuXG5leHBvcnQgeyBBYnN0cmFjdFJlcGVhdGVyLCBBcnJheVJlcGVhdFN0cmF0ZWd5LCBBdHRyQmluZGluZ0JlaGF2aW9yLCBCaW5kaW5nU2lnbmFsZXIsIENvbXBvc2UsIERlYm91bmNlQmluZGluZ0JlaGF2aW9yLCBFbHNlLCBGb2N1cywgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IsIEhUTUxTYW5pdGl6ZXIsIEhpZGUsIElmLCBNYXBSZXBlYXRTdHJhdGVneSwgTnVsbFJlcGVhdFN0cmF0ZWd5LCBOdW1iZXJSZXBlYXRTdHJhdGVneSwgT25lVGltZUJpbmRpbmdCZWhhdmlvciwgT25lV2F5QmluZGluZ0JlaGF2aW9yLCBSZXBlYXQsIFJlcGVhdFN0cmF0ZWd5TG9jYXRvciwgUmVwbGFjZWFibGUsIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyLCBTZWxmQmluZGluZ0JlaGF2aW9yLCBTZXRSZXBlYXRTdHJhdGVneSwgU2hvdywgU2lnbmFsQmluZGluZ0JlaGF2aW9yLCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciwgVG9WaWV3QmluZGluZ0JlaGF2aW9yLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IsIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IsIFdpdGgsIGNvbmZpZ3VyZSQxIGFzIGNvbmZpZ3VyZSwgY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCwgZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uLCBpc09uZVRpbWUsIHVud3JhcEV4cHJlc3Npb24sIHVwZGF0ZU9uZVRpbWVCaW5kaW5nLCB1cGRhdGVPdmVycmlkZUNvbnRleHQsIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-templating-resources\n");

/***/ }),

/***/ "aurelia-templating-router":
/*!*****************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-router/dist/es2015/aurelia-templating-router.js ***!
  \*****************************************************************************************/
/*! exports provided: RouteHref, RouterView, TemplatingRouteLoader, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouteHref\", function() { return RouteHref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterView\", function() { return RouterView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingRouteLoader\", function() { return TemplatingRouteLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-router */ \"IA8k\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-metadata */ \"SGXf\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-path */ \"n+sw\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"SkM8\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-dependency-injection */ \"OeXm\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-binding */ \"NDtI\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-pal */ \"xIXs\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-logging */ \"KKpb\");\n\n\n\n\n\n\n\n\n\nclass EmptyLayoutViewModel {\r\n}\r\n/**\r\n * Implementation of Aurelia Router ViewPort. Responsible for loading route, composing and swapping routes views\r\n */\r\nclass RouterView {\r\n    constructor(element, container, viewSlot, router, viewLocator, compositionTransaction, compositionEngine) {\r\n        this.element = element;\r\n        this.container = container;\r\n        this.viewSlot = viewSlot;\r\n        this.router = router;\r\n        this.viewLocator = viewLocator;\r\n        this.compositionTransaction = compositionTransaction;\r\n        this.compositionEngine = compositionEngine;\r\n        // add this <router-view/> to router view ports lookup based on name attribute\r\n        // when this router is the root router-view\r\n        // also trigger AppRouter registerViewPort extra flow\r\n        this.router.registerViewPort(this, this.element.getAttribute('name'));\r\n        // Each <router-view/> process its instruction as a composition transaction\r\n        // there are differences between intial composition and subsequent compositions\r\n        // also there are differences between root composition and child <router-view/> composition\r\n        // mark the first composition transaction with a property initialComposition to distinguish it\r\n        // when the root <router-view/> gets new instruction for the first time\r\n        if (!('initialComposition' in compositionTransaction)) {\r\n            compositionTransaction.initialComposition = true;\r\n            this.compositionTransactionNotifier = compositionTransaction.enlist();\r\n        }\r\n    }\r\n    /**@internal */\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewLocator\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransaction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n    }\r\n    created(owningView) {\r\n        this.owningView = owningView;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        // router needs to get access to view model of current route parent\r\n        // doing it in generic way via viewModel property on container\r\n        this.container.viewModel = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    }\r\n    /**\r\n     * Implementation of `aurelia-router` ViewPort interface, responsible for templating related part in routing Pipeline\r\n     */\r\n    process($viewPortInstruction, waitToSwap) {\r\n        // have strong typings without exposing it in public typings, this is to ensure maximum backward compat\r\n        const viewPortInstruction = $viewPortInstruction;\r\n        const component = viewPortInstruction.component;\r\n        const childContainer = component.childContainer;\r\n        const viewModel = component.viewModel;\r\n        const viewModelResource = component.viewModelResource;\r\n        const metadata = viewModelResource.metadata;\r\n        const config = component.router.currentInstruction.config;\r\n        const viewPortConfig = config.viewPorts ? (config.viewPorts[viewPortInstruction.name] || {}) : {};\r\n        childContainer.get(RouterViewLocator)._notify(this);\r\n        // layoutInstruction is our layout viewModel\r\n        const layoutInstruction = {\r\n            viewModel: viewPortConfig.layoutViewModel || config.layoutViewModel || this.layoutViewModel,\r\n            view: viewPortConfig.layoutView || config.layoutView || this.layoutView,\r\n            model: viewPortConfig.layoutModel || config.layoutModel || this.layoutModel,\r\n            router: viewPortInstruction.component.router,\r\n            childContainer: childContainer,\r\n            viewSlot: this.viewSlot\r\n        };\r\n        // viewport will be a thin wrapper around composition engine\r\n        // to process instruction/configuration from users\r\n        // preparing all information related to a composition process\r\n        // first by getting view strategy of a ViewPortComponent View\r\n        const viewStrategy = this.viewLocator.getViewStrategy(component.view || viewModel);\r\n        if (viewStrategy && component.view) {\r\n            viewStrategy.makeRelativeTo(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(component.router.container.viewModel.constructor).moduleId);\r\n        }\r\n        // using metadata of a custom element view model to load appropriate view-factory instance\r\n        return metadata\r\n            .load(childContainer, viewModelResource.value, null, viewStrategy, true)\r\n            // for custom element, viewFactory typing is always ViewFactory\r\n            // for custom attribute, it will be HtmlBehaviorResource\r\n            .then((viewFactory) => {\r\n            // if this is not the first time that this <router-view/> is composing its instruction\r\n            // try to capture ownership of the composition transaction\r\n            // child <router-view/> will not be able to capture, since root <router-view/> typically captures\r\n            // the ownership token\r\n            if (!this.compositionTransactionNotifier) {\r\n                this.compositionTransactionOwnershipToken = this.compositionTransaction.tryCapture();\r\n            }\r\n            if (layoutInstruction.viewModel || layoutInstruction.view) {\r\n                viewPortInstruction.layoutInstruction = layoutInstruction;\r\n            }\r\n            const viewPortComponentBehaviorInstruction = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorInstruction\"].dynamic(this.element, viewModel, viewFactory);\r\n            viewPortInstruction.controller = metadata.create(childContainer, viewPortComponentBehaviorInstruction);\r\n            if (waitToSwap) {\r\n                return null;\r\n            }\r\n            this.swap(viewPortInstruction);\r\n        });\r\n    }\r\n    swap($viewPortInstruction) {\r\n        // have strong typings without exposing it in public typings, this is to ensure maximum backward compat\r\n        const viewPortInstruction = $viewPortInstruction;\r\n        const viewPortController = viewPortInstruction.controller;\r\n        const layoutInstruction = viewPortInstruction.layoutInstruction;\r\n        const previousView = this.view;\r\n        // Final step of swapping a <router-view/> ViewPortComponent\r\n        const work = () => {\r\n            const swapStrategy = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"][this.swapOrder] || aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"].after;\r\n            const viewSlot = this.viewSlot;\r\n            swapStrategy(viewSlot, previousView, () => Promise.resolve(viewSlot.add(this.view))).then(() => {\r\n                this._notify();\r\n            });\r\n        };\r\n        // Ensure all users setups have been completed\r\n        const ready = (owningView_or_layoutView) => {\r\n            viewPortController.automate(this.overrideContext, owningView_or_layoutView);\r\n            const transactionOwnerShipToken = this.compositionTransactionOwnershipToken;\r\n            // if this router-view is the root <router-view/> of a normal startup via aurelia.setRoot\r\n            // attemp to take control of the transaction\r\n            // if ownership can be taken\r\n            // wait for transaction to complete before swapping\r\n            if (transactionOwnerShipToken) {\r\n                return transactionOwnerShipToken\r\n                    .waitForCompositionComplete()\r\n                    .then(() => {\r\n                    this.compositionTransactionOwnershipToken = null;\r\n                    return work();\r\n                });\r\n            }\r\n            // otherwise, just swap\r\n            return work();\r\n        };\r\n        // If there is layout instruction, new to compose layout before processing ViewPortComponent\r\n        // layout controller/view/view-model is composed using composition engine APIs\r\n        if (layoutInstruction) {\r\n            if (!layoutInstruction.viewModel) {\r\n                // createController chokes if there's no viewmodel, so create a dummy one\r\n                // but avoid using a POJO as it creates unwanted metadata in Object constructor\r\n                layoutInstruction.viewModel = new EmptyLayoutViewModel();\r\n            }\r\n            // using composition engine to create compose layout\r\n            return this.compositionEngine\r\n                // first create controller from layoutInstruction\r\n                // and treat it as CompositionContext\r\n                // then emulate slot projection with ViewPortComponent view\r\n                .createController(layoutInstruction)\r\n                .then((layoutController) => {\r\n                const layoutView = layoutController.view;\r\n                aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ShadowDOM\"].distributeView(viewPortController.view, layoutController.slots || layoutView.slots);\r\n                // when there is a layout\r\n                // view hierarchy is: <router-view/> owner view -> layout view -> ViewPortComponent view\r\n                layoutController.automate(Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(layoutInstruction.viewModel), this.owningView);\r\n                layoutView.children.push(viewPortController.view);\r\n                return layoutView || layoutController;\r\n            })\r\n                .then((newView) => {\r\n                this.view = newView;\r\n                return ready(newView);\r\n            });\r\n        }\r\n        // if there is no layout, then get ViewPortComponent view ready as view property\r\n        // and process controller/swapping\r\n        // when there is no layout\r\n        // view hierarchy is: <router-view/> owner view -> ViewPortComponent view\r\n        this.view = viewPortController.view;\r\n        return ready(this.owningView);\r\n    }\r\n    /**\r\n     * Notify composition transaction that this router has finished processing\r\n     * Happens when this <router-view/> is the root router-view\r\n     * @internal\r\n     */\r\n    _notify() {\r\n        const notifier = this.compositionTransactionNotifier;\r\n        if (notifier) {\r\n            notifier.done();\r\n            this.compositionTransactionNotifier = null;\r\n        }\r\n    }\r\n}\r\n/**\r\n * @internal Actively avoid using decorator to reduce the amount of code generated\r\n *\r\n * There is no view to compose by default in a router view\r\n * This custom element is responsible for composing its own view, based on current config\r\n */\r\nRouterView.$view = null;\r\n/**\r\n * @internal Actively avoid using decorator to reduce the amount of code generated\r\n */\r\nRouterView.$resource = {\r\n    name: 'router-view',\r\n    bindables: ['swapOrder', 'layoutView', 'layoutViewModel', 'layoutModel', 'inherit-binding-context']\r\n};\r\n/**\r\n* Locator which finds the nearest RouterView, relative to the current dependency injection container.\r\n*/\r\nclass RouterViewLocator {\r\n    /**\r\n    * Creates an instance of the RouterViewLocator class.\r\n    */\r\n    constructor() {\r\n        this.promise = new Promise((resolve) => this.resolve = resolve);\r\n    }\r\n    /**\r\n    * Finds the nearest RouterView instance.\r\n    * @returns A promise that will be resolved with the located RouterView instance.\r\n    */\r\n    findNearest() {\r\n        return this.promise;\r\n    }\r\n    /**@internal */\r\n    _notify(routerView) {\r\n        this.resolve(routerView);\r\n    }\r\n}\n\n/**@internal exported for unit testing */\r\nclass EmptyClass {\r\n}\r\naurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"inlineView\"]('<template></template>')(EmptyClass);\r\n/**\r\n * Default implementation of `RouteLoader` used for loading component based on a route config\r\n */\r\nclass TemplatingRouteLoader extends aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"] {\r\n    constructor(compositionEngine) {\r\n        super();\r\n        this.compositionEngine = compositionEngine;\r\n    }\r\n    /**\r\n     * Resolve a view model from a RouteConfig\r\n     * Throws when there is neither \"moduleId\" nor \"viewModel\" property\r\n     * @internal\r\n     */\r\n    resolveViewModel(router, config) {\r\n        return new Promise((resolve, reject) => {\r\n            let viewModel;\r\n            if ('moduleId' in config) {\r\n                let moduleId = config.moduleId;\r\n                if (moduleId === null) {\r\n                    viewModel = EmptyClass;\r\n                }\r\n                else {\r\n                    // this requires container of router has passes a certain point\r\n                    // where a view model has been setup on the container\r\n                    // it will fail in enhance scenario because no viewport has been registered\r\n                    moduleId = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_2__[\"relativeToFile\"])(moduleId, aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(router.container.viewModel.constructor).moduleId);\r\n                    if (/\\.html/i.test(moduleId)) {\r\n                        viewModel = createDynamicClass(moduleId);\r\n                    }\r\n                    else {\r\n                        viewModel = moduleId;\r\n                    }\r\n                }\r\n                return resolve(viewModel);\r\n            }\r\n            // todo: add if ('viewModel' in config) to support static view model resolution\r\n            reject(new Error('Invalid route config. No \"moduleId\" found.'));\r\n        });\r\n    }\r\n    /**\r\n     * Create child container based on a router container\r\n     * Also ensures that child router are properly constructed in the newly created child container\r\n     * @internal\r\n     */\r\n    createChildContainer(router) {\r\n        const childContainer = router.container.createChild();\r\n        childContainer.registerSingleton(RouterViewLocator);\r\n        childContainer.getChildRouter = function () {\r\n            let childRouter;\r\n            childContainer.registerHandler(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], () => childRouter || (childRouter = router.createChild(childContainer)));\r\n            return childContainer.get(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"]);\r\n        };\r\n        return childContainer;\r\n    }\r\n    /**\r\n     * Load corresponding component of a route config of a navigation instruction\r\n     */\r\n    loadRoute(router, config, _navInstruction) {\r\n        return this\r\n            .resolveViewModel(router, config)\r\n            .then(viewModel => this.compositionEngine.ensureViewModel({\r\n            viewModel: viewModel,\r\n            childContainer: this.createChildContainer(router),\r\n            view: config.view || config.viewStrategy,\r\n            router: router\r\n        }));\r\n    }\r\n}\r\n/**@internal */\r\nTemplatingRouteLoader.inject = [aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n/**@internal exported for unit testing */\r\nfunction createDynamicClass(moduleId) {\r\n    const name = /([^\\/^\\?]+)\\.html/i.exec(moduleId)[1];\r\n    class DynamicClass {\r\n        bind(bindingContext) {\r\n            this.$parent = bindingContext;\r\n        }\r\n    }\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name)(DynamicClass);\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(moduleId)(DynamicClass);\r\n    return DynamicClass;\r\n}\n\nconst logger = Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_7__[\"getLogger\"])('route-href');\r\n/**\r\n * Helper custom attribute to help associate an element with a route by name\r\n */\r\nclass RouteHref {\r\n    constructor(router, element) {\r\n        this.router = router;\r\n        this.element = element;\r\n        this.attribute = 'href';\r\n    }\r\n    /*@internal */\r\n    static inject() {\r\n        return [aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element];\r\n    }\r\n    bind() {\r\n        this.isActive = true;\r\n        this.processChange();\r\n    }\r\n    unbind() {\r\n        this.isActive = false;\r\n    }\r\n    attributeChanged(value, previous) {\r\n        if (previous) {\r\n            this.element.removeAttribute(previous);\r\n        }\r\n        return this.processChange();\r\n    }\r\n    processChange() {\r\n        return this.router\r\n            .ensureConfigured()\r\n            .then(() => {\r\n            if (!this.isActive) {\r\n                // returning null to avoid Bluebird warning\r\n                return null;\r\n            }\r\n            const element = this.element;\r\n            const href = this.router.generate(this.route, this.params);\r\n            if (element.au.controller) {\r\n                element.au.controller.viewModel[this.attribute] = href;\r\n            }\r\n            else {\r\n                element.setAttribute(this.attribute, href);\r\n            }\r\n            // returning null to avoid Bluebird warning\r\n            return null;\r\n        })\r\n            .catch((reason) => {\r\n            logger.error(reason);\r\n        });\r\n    }\r\n}\r\n/**\r\n * @internal Actively avoid using decorator to reduce the amount of code generated\r\n */\r\nRouteHref.$resource = {\r\n    type: 'attribute',\r\n    name: 'route-href',\r\n    bindables: [\r\n        { name: 'route', changeHandler: 'processChange', primaryProperty: true },\r\n        { name: 'params', changeHandler: 'processChange' },\r\n        'attribute'\r\n    ] // type definition of Aurelia templating is wrong\r\n};\n\nfunction configure(config) {\r\n    config\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"], TemplatingRouteLoader)\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"])\r\n        .globalResources(RouterView, RouteHref);\r\n    config.container.registerAlias(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"]);\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-router.js.map\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! promise-polyfill */ \"B/eG\")[\"default\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyL2Rpc3QvZXMyMDE1L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIuanM/ZTk2MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIsIFJvdXRlTG9hZGVyLCBBcHBSb3V0ZXIgfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQgeyBPcmlnaW4gfSBmcm9tICdhdXJlbGlhLW1ldGFkYXRhJztcbmltcG9ydCB7IHJlbGF0aXZlVG9GaWxlIH0gZnJvbSAnYXVyZWxpYS1wYXRoJztcbmltcG9ydCB7IFZpZXdTbG90LCBWaWV3TG9jYXRvciwgQ29tcG9zaXRpb25UcmFuc2FjdGlvbiwgQ29tcG9zaXRpb25FbmdpbmUsIEJlaGF2aW9ySW5zdHJ1Y3Rpb24sIFNoYWRvd0RPTSwgU3dhcFN0cmF0ZWdpZXMsIGlubGluZVZpZXcsIGN1c3RvbUVsZW1lbnQsIHVzZVZpZXcgfSBmcm9tICdhdXJlbGlhLXRlbXBsYXRpbmcnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbic7XG5pbXBvcnQgeyBjcmVhdGVPdmVycmlkZUNvbnRleHQgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgRE9NIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyIH0gZnJvbSAnYXVyZWxpYS1sb2dnaW5nJztcblxuY2xhc3MgRW1wdHlMYXlvdXRWaWV3TW9kZWwge1xyXG59XHJcbi8qKlxyXG4gKiBJbXBsZW1lbnRhdGlvbiBvZiBBdXJlbGlhIFJvdXRlciBWaWV3UG9ydC4gUmVzcG9uc2libGUgZm9yIGxvYWRpbmcgcm91dGUsIGNvbXBvc2luZyBhbmQgc3dhcHBpbmcgcm91dGVzIHZpZXdzXHJcbiAqL1xyXG5jbGFzcyBSb3V0ZXJWaWV3IHtcclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGNvbnRhaW5lciwgdmlld1Nsb3QsIHJvdXRlciwgdmlld0xvY2F0b3IsIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24sIGNvbXBvc2l0aW9uRW5naW5lKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICAgICAgdGhpcy52aWV3TG9jYXRvciA9IHZpZXdMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGNvbXBvc2l0aW9uVHJhbnNhY3Rpb247XHJcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgICAgIC8vIGFkZCB0aGlzIDxyb3V0ZXItdmlldy8+IHRvIHJvdXRlciB2aWV3IHBvcnRzIGxvb2t1cCBiYXNlZCBvbiBuYW1lIGF0dHJpYnV0ZVxyXG4gICAgICAgIC8vIHdoZW4gdGhpcyByb3V0ZXIgaXMgdGhlIHJvb3Qgcm91dGVyLXZpZXdcclxuICAgICAgICAvLyBhbHNvIHRyaWdnZXIgQXBwUm91dGVyIHJlZ2lzdGVyVmlld1BvcnQgZXh0cmEgZmxvd1xyXG4gICAgICAgIHRoaXMucm91dGVyLnJlZ2lzdGVyVmlld1BvcnQodGhpcywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpKTtcclxuICAgICAgICAvLyBFYWNoIDxyb3V0ZXItdmlldy8+IHByb2Nlc3MgaXRzIGluc3RydWN0aW9uIGFzIGEgY29tcG9zaXRpb24gdHJhbnNhY3Rpb25cclxuICAgICAgICAvLyB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgYmV0d2VlbiBpbnRpYWwgY29tcG9zaXRpb24gYW5kIHN1YnNlcXVlbnQgY29tcG9zaXRpb25zXHJcbiAgICAgICAgLy8gYWxzbyB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgYmV0d2VlbiByb290IGNvbXBvc2l0aW9uIGFuZCBjaGlsZCA8cm91dGVyLXZpZXcvPiBjb21wb3NpdGlvblxyXG4gICAgICAgIC8vIG1hcmsgdGhlIGZpcnN0IGNvbXBvc2l0aW9uIHRyYW5zYWN0aW9uIHdpdGggYSBwcm9wZXJ0eSBpbml0aWFsQ29tcG9zaXRpb24gdG8gZGlzdGluZ3Vpc2ggaXRcclxuICAgICAgICAvLyB3aGVuIHRoZSByb290IDxyb3V0ZXItdmlldy8+IGdldHMgbmV3IGluc3RydWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIGlmICghKCdpbml0aWFsQ29tcG9zaXRpb24nIGluIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24pKSB7XHJcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24uaW5pdGlhbENvbXBvc2l0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIgPSBjb21wb3NpdGlvblRyYW5zYWN0aW9uLmVubGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgc3RhdGljIGluamVjdCgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBDb250YWluZXIsIFZpZXdTbG90LCBSb3V0ZXIsIFZpZXdMb2NhdG9yLCBDb21wb3NpdGlvblRyYW5zYWN0aW9uLCBDb21wb3NpdGlvbkVuZ2luZV07XHJcbiAgICB9XHJcbiAgICBjcmVhdGVkKG93bmluZ1ZpZXcpIHtcclxuICAgICAgICB0aGlzLm93bmluZ1ZpZXcgPSBvd25pbmdWaWV3O1xyXG4gICAgfVxyXG4gICAgYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgLy8gcm91dGVyIG5lZWRzIHRvIGdldCBhY2Nlc3MgdG8gdmlldyBtb2RlbCBvZiBjdXJyZW50IHJvdXRlIHBhcmVudFxyXG4gICAgICAgIC8vIGRvaW5nIGl0IGluIGdlbmVyaWMgd2F5IHZpYSB2aWV3TW9kZWwgcHJvcGVydHkgb24gY29udGFpbmVyXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIudmlld01vZGVsID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEltcGxlbWVudGF0aW9uIG9mIGBhdXJlbGlhLXJvdXRlcmAgVmlld1BvcnQgaW50ZXJmYWNlLCByZXNwb25zaWJsZSBmb3IgdGVtcGxhdGluZyByZWxhdGVkIHBhcnQgaW4gcm91dGluZyBQaXBlbGluZVxyXG4gICAgICovXHJcbiAgICBwcm9jZXNzKCR2aWV3UG9ydEluc3RydWN0aW9uLCB3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgLy8gaGF2ZSBzdHJvbmcgdHlwaW5ncyB3aXRob3V0IGV4cG9zaW5nIGl0IGluIHB1YmxpYyB0eXBpbmdzLCB0aGlzIGlzIHRvIGVuc3VyZSBtYXhpbXVtIGJhY2t3YXJkIGNvbXBhdFxyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSAkdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgICAgICBjb25zdCBjb21wb25lbnQgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbXBvbmVudDtcclxuICAgICAgICBjb25zdCBjaGlsZENvbnRhaW5lciA9IGNvbXBvbmVudC5jaGlsZENvbnRhaW5lcjtcclxuICAgICAgICBjb25zdCB2aWV3TW9kZWwgPSBjb21wb25lbnQudmlld01vZGVsO1xyXG4gICAgICAgIGNvbnN0IHZpZXdNb2RlbFJlc291cmNlID0gY29tcG9uZW50LnZpZXdNb2RlbFJlc291cmNlO1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdmlld01vZGVsUmVzb3VyY2UubWV0YWRhdGE7XHJcbiAgICAgICAgY29uc3QgY29uZmlnID0gY29tcG9uZW50LnJvdXRlci5jdXJyZW50SW5zdHJ1Y3Rpb24uY29uZmlnO1xyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0Q29uZmlnID0gY29uZmlnLnZpZXdQb3J0cyA/IChjb25maWcudmlld1BvcnRzW3ZpZXdQb3J0SW5zdHJ1Y3Rpb24ubmFtZV0gfHwge30pIDoge307XHJcbiAgICAgICAgY2hpbGRDb250YWluZXIuZ2V0KFJvdXRlclZpZXdMb2NhdG9yKS5fbm90aWZ5KHRoaXMpO1xyXG4gICAgICAgIC8vIGxheW91dEluc3RydWN0aW9uIGlzIG91ciBsYXlvdXQgdmlld01vZGVsXHJcbiAgICAgICAgY29uc3QgbGF5b3V0SW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgICAgICAgIHZpZXdNb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0Vmlld01vZGVsIHx8IGNvbmZpZy5sYXlvdXRWaWV3TW9kZWwgfHwgdGhpcy5sYXlvdXRWaWV3TW9kZWwsXHJcbiAgICAgICAgICAgIHZpZXc6IHZpZXdQb3J0Q29uZmlnLmxheW91dFZpZXcgfHwgY29uZmlnLmxheW91dFZpZXcgfHwgdGhpcy5sYXlvdXRWaWV3LFxyXG4gICAgICAgICAgICBtb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0TW9kZWwgfHwgY29uZmlnLmxheW91dE1vZGVsIHx8IHRoaXMubGF5b3V0TW9kZWwsXHJcbiAgICAgICAgICAgIHJvdXRlcjogdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQucm91dGVyLFxyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lcjogY2hpbGRDb250YWluZXIsXHJcbiAgICAgICAgICAgIHZpZXdTbG90OiB0aGlzLnZpZXdTbG90XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyB2aWV3cG9ydCB3aWxsIGJlIGEgdGhpbiB3cmFwcGVyIGFyb3VuZCBjb21wb3NpdGlvbiBlbmdpbmVcclxuICAgICAgICAvLyB0byBwcm9jZXNzIGluc3RydWN0aW9uL2NvbmZpZ3VyYXRpb24gZnJvbSB1c2Vyc1xyXG4gICAgICAgIC8vIHByZXBhcmluZyBhbGwgaW5mb3JtYXRpb24gcmVsYXRlZCB0byBhIGNvbXBvc2l0aW9uIHByb2Nlc3NcclxuICAgICAgICAvLyBmaXJzdCBieSBnZXR0aW5nIHZpZXcgc3RyYXRlZ3kgb2YgYSBWaWV3UG9ydENvbXBvbmVudCBWaWV3XHJcbiAgICAgICAgY29uc3Qgdmlld1N0cmF0ZWd5ID0gdGhpcy52aWV3TG9jYXRvci5nZXRWaWV3U3RyYXRlZ3koY29tcG9uZW50LnZpZXcgfHwgdmlld01vZGVsKTtcclxuICAgICAgICBpZiAodmlld1N0cmF0ZWd5ICYmIGNvbXBvbmVudC52aWV3KSB7XHJcbiAgICAgICAgICAgIHZpZXdTdHJhdGVneS5tYWtlUmVsYXRpdmVUbyhPcmlnaW4uZ2V0KGNvbXBvbmVudC5yb3V0ZXIuY29udGFpbmVyLnZpZXdNb2RlbC5jb25zdHJ1Y3RvcikubW9kdWxlSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB1c2luZyBtZXRhZGF0YSBvZiBhIGN1c3RvbSBlbGVtZW50IHZpZXcgbW9kZWwgdG8gbG9hZCBhcHByb3ByaWF0ZSB2aWV3LWZhY3RvcnkgaW5zdGFuY2VcclxuICAgICAgICByZXR1cm4gbWV0YWRhdGFcclxuICAgICAgICAgICAgLmxvYWQoY2hpbGRDb250YWluZXIsIHZpZXdNb2RlbFJlc291cmNlLnZhbHVlLCBudWxsLCB2aWV3U3RyYXRlZ3ksIHRydWUpXHJcbiAgICAgICAgICAgIC8vIGZvciBjdXN0b20gZWxlbWVudCwgdmlld0ZhY3RvcnkgdHlwaW5nIGlzIGFsd2F5cyBWaWV3RmFjdG9yeVxyXG4gICAgICAgICAgICAvLyBmb3IgY3VzdG9tIGF0dHJpYnV0ZSwgaXQgd2lsbCBiZSBIdG1sQmVoYXZpb3JSZXNvdXJjZVxyXG4gICAgICAgICAgICAudGhlbigodmlld0ZhY3RvcnkpID0+IHtcclxuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBub3QgdGhlIGZpcnN0IHRpbWUgdGhhdCB0aGlzIDxyb3V0ZXItdmlldy8+IGlzIGNvbXBvc2luZyBpdHMgaW5zdHJ1Y3Rpb25cclxuICAgICAgICAgICAgLy8gdHJ5IHRvIGNhcHR1cmUgb3duZXJzaGlwIG9mIHRoZSBjb21wb3NpdGlvbiB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAvLyBjaGlsZCA8cm91dGVyLXZpZXcvPiB3aWxsIG5vdCBiZSBhYmxlIHRvIGNhcHR1cmUsIHNpbmNlIHJvb3QgPHJvdXRlci12aWV3Lz4gdHlwaWNhbGx5IGNhcHR1cmVzXHJcbiAgICAgICAgICAgIC8vIHRoZSBvd25lcnNoaXAgdG9rZW5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4gPSB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb24udHJ5Q2FwdHVyZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsYXlvdXRJbnN0cnVjdGlvbi52aWV3TW9kZWwgfHwgbGF5b3V0SW5zdHJ1Y3Rpb24udmlldykge1xyXG4gICAgICAgICAgICAgICAgdmlld1BvcnRJbnN0cnVjdGlvbi5sYXlvdXRJbnN0cnVjdGlvbiA9IGxheW91dEluc3RydWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdQb3J0Q29tcG9uZW50QmVoYXZpb3JJbnN0cnVjdGlvbiA9IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uZHluYW1pYyh0aGlzLmVsZW1lbnQsIHZpZXdNb2RlbCwgdmlld0ZhY3RvcnkpO1xyXG4gICAgICAgICAgICB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXIgPSBtZXRhZGF0YS5jcmVhdGUoY2hpbGRDb250YWluZXIsIHZpZXdQb3J0Q29tcG9uZW50QmVoYXZpb3JJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgICAgIGlmICh3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnN3YXAodmlld1BvcnRJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzd2FwKCR2aWV3UG9ydEluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgLy8gaGF2ZSBzdHJvbmcgdHlwaW5ncyB3aXRob3V0IGV4cG9zaW5nIGl0IGluIHB1YmxpYyB0eXBpbmdzLCB0aGlzIGlzIHRvIGVuc3VyZSBtYXhpbXVtIGJhY2t3YXJkIGNvbXBhdFxyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSAkdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgICAgICBjb25zdCB2aWV3UG9ydENvbnRyb2xsZXIgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXI7XHJcbiAgICAgICAgY29uc3QgbGF5b3V0SW5zdHJ1Y3Rpb24gPSB2aWV3UG9ydEluc3RydWN0aW9uLmxheW91dEluc3RydWN0aW9uO1xyXG4gICAgICAgIGNvbnN0IHByZXZpb3VzVmlldyA9IHRoaXMudmlldztcclxuICAgICAgICAvLyBGaW5hbCBzdGVwIG9mIHN3YXBwaW5nIGEgPHJvdXRlci12aWV3Lz4gVmlld1BvcnRDb21wb25lbnRcclxuICAgICAgICBjb25zdCB3b3JrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzd2FwU3RyYXRlZ3kgPSBTd2FwU3RyYXRlZ2llc1t0aGlzLnN3YXBPcmRlcl0gfHwgU3dhcFN0cmF0ZWdpZXMuYWZ0ZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdTbG90ID0gdGhpcy52aWV3U2xvdDtcclxuICAgICAgICAgICAgc3dhcFN0cmF0ZWd5KHZpZXdTbG90LCBwcmV2aW91c1ZpZXcsICgpID0+IFByb21pc2UucmVzb2x2ZSh2aWV3U2xvdC5hZGQodGhpcy52aWV3KSkpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gRW5zdXJlIGFsbCB1c2VycyBzZXR1cHMgaGF2ZSBiZWVuIGNvbXBsZXRlZFxyXG4gICAgICAgIGNvbnN0IHJlYWR5ID0gKG93bmluZ1ZpZXdfb3JfbGF5b3V0VmlldykgPT4ge1xyXG4gICAgICAgICAgICB2aWV3UG9ydENvbnRyb2xsZXIuYXV0b21hdGUodGhpcy5vdmVycmlkZUNvbnRleHQsIG93bmluZ1ZpZXdfb3JfbGF5b3V0Vmlldyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uT3duZXJTaGlwVG9rZW4gPSB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbjtcclxuICAgICAgICAgICAgLy8gaWYgdGhpcyByb3V0ZXItdmlldyBpcyB0aGUgcm9vdCA8cm91dGVyLXZpZXcvPiBvZiBhIG5vcm1hbCBzdGFydHVwIHZpYSBhdXJlbGlhLnNldFJvb3RcclxuICAgICAgICAgICAgLy8gYXR0ZW1wIHRvIHRha2UgY29udHJvbCBvZiB0aGUgdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgLy8gaWYgb3duZXJzaGlwIGNhbiBiZSB0YWtlblxyXG4gICAgICAgICAgICAvLyB3YWl0IGZvciB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZSBiZWZvcmUgc3dhcHBpbmdcclxuICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uT3duZXJTaGlwVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk93bmVyU2hpcFRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgLndhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlKClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB3b3JrKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBvdGhlcndpc2UsIGp1c3Qgc3dhcFxyXG4gICAgICAgICAgICByZXR1cm4gd29yaygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgbGF5b3V0IGluc3RydWN0aW9uLCBuZXcgdG8gY29tcG9zZSBsYXlvdXQgYmVmb3JlIHByb2Nlc3NpbmcgVmlld1BvcnRDb21wb25lbnRcclxuICAgICAgICAvLyBsYXlvdXQgY29udHJvbGxlci92aWV3L3ZpZXctbW9kZWwgaXMgY29tcG9zZWQgdXNpbmcgY29tcG9zaXRpb24gZW5naW5lIEFQSXNcclxuICAgICAgICBpZiAobGF5b3V0SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgaWYgKCFsYXlvdXRJbnN0cnVjdGlvbi52aWV3TW9kZWwpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZUNvbnRyb2xsZXIgY2hva2VzIGlmIHRoZXJlJ3Mgbm8gdmlld21vZGVsLCBzbyBjcmVhdGUgYSBkdW1teSBvbmVcclxuICAgICAgICAgICAgICAgIC8vIGJ1dCBhdm9pZCB1c2luZyBhIFBPSk8gYXMgaXQgY3JlYXRlcyB1bndhbnRlZCBtZXRhZGF0YSBpbiBPYmplY3QgY29uc3RydWN0b3JcclxuICAgICAgICAgICAgICAgIGxheW91dEluc3RydWN0aW9uLnZpZXdNb2RlbCA9IG5ldyBFbXB0eUxheW91dFZpZXdNb2RlbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHVzaW5nIGNvbXBvc2l0aW9uIGVuZ2luZSB0byBjcmVhdGUgY29tcG9zZSBsYXlvdXRcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9zaXRpb25FbmdpbmVcclxuICAgICAgICAgICAgICAgIC8vIGZpcnN0IGNyZWF0ZSBjb250cm9sbGVyIGZyb20gbGF5b3V0SW5zdHJ1Y3Rpb25cclxuICAgICAgICAgICAgICAgIC8vIGFuZCB0cmVhdCBpdCBhcyBDb21wb3NpdGlvbkNvbnRleHRcclxuICAgICAgICAgICAgICAgIC8vIHRoZW4gZW11bGF0ZSBzbG90IHByb2plY3Rpb24gd2l0aCBWaWV3UG9ydENvbXBvbmVudCB2aWV3XHJcbiAgICAgICAgICAgICAgICAuY3JlYXRlQ29udHJvbGxlcihsYXlvdXRJbnN0cnVjdGlvbilcclxuICAgICAgICAgICAgICAgIC50aGVuKChsYXlvdXRDb250cm9sbGVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsYXlvdXRWaWV3ID0gbGF5b3V0Q29udHJvbGxlci52aWV3O1xyXG4gICAgICAgICAgICAgICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHZpZXdQb3J0Q29udHJvbGxlci52aWV3LCBsYXlvdXRDb250cm9sbGVyLnNsb3RzIHx8IGxheW91dFZpZXcuc2xvdHMpO1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGVyZSBpcyBhIGxheW91dFxyXG4gICAgICAgICAgICAgICAgLy8gdmlldyBoaWVyYXJjaHkgaXM6IDxyb3V0ZXItdmlldy8+IG93bmVyIHZpZXcgLT4gbGF5b3V0IHZpZXcgLT4gVmlld1BvcnRDb21wb25lbnQgdmlld1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0Q29udHJvbGxlci5hdXRvbWF0ZShjcmVhdGVPdmVycmlkZUNvbnRleHQobGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsKSwgdGhpcy5vd25pbmdWaWV3KTtcclxuICAgICAgICAgICAgICAgIGxheW91dFZpZXcuY2hpbGRyZW4ucHVzaCh2aWV3UG9ydENvbnRyb2xsZXIudmlldyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGF5b3V0VmlldyB8fCBsYXlvdXRDb250cm9sbGVyO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKG5ld1ZpZXcpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldyA9IG5ld1ZpZXc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVhZHkobmV3Vmlldyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBsYXlvdXQsIHRoZW4gZ2V0IFZpZXdQb3J0Q29tcG9uZW50IHZpZXcgcmVhZHkgYXMgdmlldyBwcm9wZXJ0eVxyXG4gICAgICAgIC8vIGFuZCBwcm9jZXNzIGNvbnRyb2xsZXIvc3dhcHBpbmdcclxuICAgICAgICAvLyB3aGVuIHRoZXJlIGlzIG5vIGxheW91dFxyXG4gICAgICAgIC8vIHZpZXcgaGllcmFyY2h5IGlzOiA8cm91dGVyLXZpZXcvPiBvd25lciB2aWV3IC0+IFZpZXdQb3J0Q29tcG9uZW50IHZpZXdcclxuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3UG9ydENvbnRyb2xsZXIudmlldztcclxuICAgICAgICByZXR1cm4gcmVhZHkodGhpcy5vd25pbmdWaWV3KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTm90aWZ5IGNvbXBvc2l0aW9uIHRyYW5zYWN0aW9uIHRoYXQgdGhpcyByb3V0ZXIgaGFzIGZpbmlzaGVkIHByb2Nlc3NpbmdcclxuICAgICAqIEhhcHBlbnMgd2hlbiB0aGlzIDxyb3V0ZXItdmlldy8+IGlzIHRoZSByb290IHJvdXRlci12aWV3XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgX25vdGlmeSgpIHtcclxuICAgICAgICBjb25zdCBub3RpZmllciA9IHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyO1xyXG4gICAgICAgIGlmIChub3RpZmllcikge1xyXG4gICAgICAgICAgICBub3RpZmllci5kb25lKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEBpbnRlcm5hbCBBY3RpdmVseSBhdm9pZCB1c2luZyBkZWNvcmF0b3IgdG8gcmVkdWNlIHRoZSBhbW91bnQgb2YgY29kZSBnZW5lcmF0ZWRcclxuICpcclxuICogVGhlcmUgaXMgbm8gdmlldyB0byBjb21wb3NlIGJ5IGRlZmF1bHQgaW4gYSByb3V0ZXIgdmlld1xyXG4gKiBUaGlzIGN1c3RvbSBlbGVtZW50IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wb3NpbmcgaXRzIG93biB2aWV3LCBiYXNlZCBvbiBjdXJyZW50IGNvbmZpZ1xyXG4gKi9cclxuUm91dGVyVmlldy4kdmlldyA9IG51bGw7XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWwgQWN0aXZlbHkgYXZvaWQgdXNpbmcgZGVjb3JhdG9yIHRvIHJlZHVjZSB0aGUgYW1vdW50IG9mIGNvZGUgZ2VuZXJhdGVkXHJcbiAqL1xyXG5Sb3V0ZXJWaWV3LiRyZXNvdXJjZSA9IHtcclxuICAgIG5hbWU6ICdyb3V0ZXItdmlldycsXHJcbiAgICBiaW5kYWJsZXM6IFsnc3dhcE9yZGVyJywgJ2xheW91dFZpZXcnLCAnbGF5b3V0Vmlld01vZGVsJywgJ2xheW91dE1vZGVsJywgJ2luaGVyaXQtYmluZGluZy1jb250ZXh0J11cclxufTtcclxuLyoqXHJcbiogTG9jYXRvciB3aGljaCBmaW5kcyB0aGUgbmVhcmVzdCBSb3V0ZXJWaWV3LCByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBkZXBlbmRlbmN5IGluamVjdGlvbiBjb250YWluZXIuXHJcbiovXHJcbmNsYXNzIFJvdXRlclZpZXdMb2NhdG9yIHtcclxuICAgIC8qKlxyXG4gICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBSb3V0ZXJWaWV3TG9jYXRvciBjbGFzcy5cclxuICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gdGhpcy5yZXNvbHZlID0gcmVzb2x2ZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICogRmluZHMgdGhlIG5lYXJlc3QgUm91dGVyVmlldyBpbnN0YW5jZS5cclxuICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSBsb2NhdGVkIFJvdXRlclZpZXcgaW5zdGFuY2UuXHJcbiAgICAqL1xyXG4gICAgZmluZE5lYXJlc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTtcclxuICAgIH1cclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgX25vdGlmeShyb3V0ZXJWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlKHJvdXRlclZpZXcpO1xyXG4gICAgfVxyXG59XG5cbi8qKkBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nICovXHJcbmNsYXNzIEVtcHR5Q2xhc3Mge1xyXG59XHJcbmlubGluZVZpZXcoJzx0ZW1wbGF0ZT48L3RlbXBsYXRlPicpKEVtcHR5Q2xhc3MpO1xyXG4vKipcclxuICogRGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiBgUm91dGVMb2FkZXJgIHVzZWQgZm9yIGxvYWRpbmcgY29tcG9uZW50IGJhc2VkIG9uIGEgcm91dGUgY29uZmlnXHJcbiAqL1xyXG5jbGFzcyBUZW1wbGF0aW5nUm91dGVMb2FkZXIgZXh0ZW5kcyBSb3V0ZUxvYWRlciB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb21wb3NpdGlvbkVuZ2luZSkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNvbHZlIGEgdmlldyBtb2RlbCBmcm9tIGEgUm91dGVDb25maWdcclxuICAgICAqIFRocm93cyB3aGVuIHRoZXJlIGlzIG5laXRoZXIgXCJtb2R1bGVJZFwiIG5vciBcInZpZXdNb2RlbFwiIHByb3BlcnR5XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgcmVzb2x2ZVZpZXdNb2RlbChyb3V0ZXIsIGNvbmZpZykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3TW9kZWw7XHJcbiAgICAgICAgICAgIGlmICgnbW9kdWxlSWQnIGluIGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgbGV0IG1vZHVsZUlkID0gY29uZmlnLm1vZHVsZUlkO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1vZHVsZUlkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld01vZGVsID0gRW1wdHlDbGFzcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgcmVxdWlyZXMgY29udGFpbmVyIG9mIHJvdXRlciBoYXMgcGFzc2VzIGEgY2VydGFpbiBwb2ludFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZXJlIGEgdmlldyBtb2RlbCBoYXMgYmVlbiBzZXR1cCBvbiB0aGUgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBmYWlsIGluIGVuaGFuY2Ugc2NlbmFyaW8gYmVjYXVzZSBubyB2aWV3cG9ydCBoYXMgYmVlbiByZWdpc3RlcmVkXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlSWQgPSByZWxhdGl2ZVRvRmlsZShtb2R1bGVJZCwgT3JpZ2luLmdldChyb3V0ZXIuY29udGFpbmVyLnZpZXdNb2RlbC5jb25zdHJ1Y3RvcikubW9kdWxlSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgvXFwuaHRtbC9pLnRlc3QobW9kdWxlSWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdNb2RlbCA9IGNyZWF0ZUR5bmFtaWNDbGFzcyhtb2R1bGVJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3TW9kZWwgPSBtb2R1bGVJZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh2aWV3TW9kZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRvZG86IGFkZCBpZiAoJ3ZpZXdNb2RlbCcgaW4gY29uZmlnKSB0byBzdXBwb3J0IHN0YXRpYyB2aWV3IG1vZGVsIHJlc29sdXRpb25cclxuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignSW52YWxpZCByb3V0ZSBjb25maWcuIE5vIFwibW9kdWxlSWRcIiBmb3VuZC4nKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBjaGlsZCBjb250YWluZXIgYmFzZWQgb24gYSByb3V0ZXIgY29udGFpbmVyXHJcbiAgICAgKiBBbHNvIGVuc3VyZXMgdGhhdCBjaGlsZCByb3V0ZXIgYXJlIHByb3Blcmx5IGNvbnN0cnVjdGVkIGluIHRoZSBuZXdseSBjcmVhdGVkIGNoaWxkIGNvbnRhaW5lclxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZUNoaWxkQ29udGFpbmVyKHJvdXRlcikge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkQ29udGFpbmVyID0gcm91dGVyLmNvbnRhaW5lci5jcmVhdGVDaGlsZCgpO1xyXG4gICAgICAgIGNoaWxkQ29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFJvdXRlclZpZXdMb2NhdG9yKTtcclxuICAgICAgICBjaGlsZENvbnRhaW5lci5nZXRDaGlsZFJvdXRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IGNoaWxkUm91dGVyO1xyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lci5yZWdpc3RlckhhbmRsZXIoUm91dGVyLCAoKSA9PiBjaGlsZFJvdXRlciB8fCAoY2hpbGRSb3V0ZXIgPSByb3V0ZXIuY3JlYXRlQ2hpbGQoY2hpbGRDb250YWluZXIpKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lci5nZXQoUm91dGVyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lcjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCBjb3JyZXNwb25kaW5nIGNvbXBvbmVudCBvZiBhIHJvdXRlIGNvbmZpZyBvZiBhIG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb25cclxuICAgICAqL1xyXG4gICAgbG9hZFJvdXRlKHJvdXRlciwgY29uZmlnLCBfbmF2SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICAucmVzb2x2ZVZpZXdNb2RlbChyb3V0ZXIsIGNvbmZpZylcclxuICAgICAgICAgICAgLnRoZW4odmlld01vZGVsID0+IHRoaXMuY29tcG9zaXRpb25FbmdpbmUuZW5zdXJlVmlld01vZGVsKHtcclxuICAgICAgICAgICAgdmlld01vZGVsOiB2aWV3TW9kZWwsXHJcbiAgICAgICAgICAgIGNoaWxkQ29udGFpbmVyOiB0aGlzLmNyZWF0ZUNoaWxkQ29udGFpbmVyKHJvdXRlciksXHJcbiAgICAgICAgICAgIHZpZXc6IGNvbmZpZy52aWV3IHx8IGNvbmZpZy52aWV3U3RyYXRlZ3ksXHJcbiAgICAgICAgICAgIHJvdXRlcjogcm91dGVyXHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG59XHJcbi8qKkBpbnRlcm5hbCAqL1xyXG5UZW1wbGF0aW5nUm91dGVMb2FkZXIuaW5qZWN0ID0gW0NvbXBvc2l0aW9uRW5naW5lXTtcclxuLyoqQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmcgKi9cclxuZnVuY3Rpb24gY3JlYXRlRHluYW1pY0NsYXNzKG1vZHVsZUlkKSB7XHJcbiAgICBjb25zdCBuYW1lID0gLyhbXlxcL15cXD9dKylcXC5odG1sL2kuZXhlYyhtb2R1bGVJZClbMV07XHJcbiAgICBjbGFzcyBEeW5hbWljQ2xhc3Mge1xyXG4gICAgICAgIGJpbmQoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICAgICAgdGhpcy4kcGFyZW50ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY3VzdG9tRWxlbWVudChuYW1lKShEeW5hbWljQ2xhc3MpO1xyXG4gICAgdXNlVmlldyhtb2R1bGVJZCkoRHluYW1pY0NsYXNzKTtcclxuICAgIHJldHVybiBEeW5hbWljQ2xhc3M7XHJcbn1cblxuY29uc3QgbG9nZ2VyID0gZ2V0TG9nZ2VyKCdyb3V0ZS1ocmVmJyk7XHJcbi8qKlxyXG4gKiBIZWxwZXIgY3VzdG9tIGF0dHJpYnV0ZSB0byBoZWxwIGFzc29jaWF0ZSBhbiBlbGVtZW50IHdpdGggYSByb3V0ZSBieSBuYW1lXHJcbiAqL1xyXG5jbGFzcyBSb3V0ZUhyZWYge1xyXG4gICAgY29uc3RydWN0b3Iocm91dGVyLCBlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmF0dHJpYnV0ZSA9ICdocmVmJztcclxuICAgIH1cclxuICAgIC8qQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgaW5qZWN0KCkge1xyXG4gICAgICAgIHJldHVybiBbUm91dGVyLCBET00uRWxlbWVudF07XHJcbiAgICB9XHJcbiAgICBiaW5kKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc0NoYW5nZSgpO1xyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGF0dHJpYnV0ZUNoYW5nZWQodmFsdWUsIHByZXZpb3VzKSB7XHJcbiAgICAgICAgaWYgKHByZXZpb3VzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUocHJldmlvdXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzQ2hhbmdlKCk7XHJcbiAgICB9XHJcbiAgICBwcm9jZXNzQ2hhbmdlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvdXRlclxyXG4gICAgICAgICAgICAuZW5zdXJlQ29uZmlndXJlZCgpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm5pbmcgbnVsbCB0byBhdm9pZCBCbHVlYmlyZCB3YXJuaW5nXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBocmVmID0gdGhpcy5yb3V0ZXIuZ2VuZXJhdGUodGhpcy5yb3V0ZSwgdGhpcy5wYXJhbXMpO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5hdS5jb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmF1LmNvbnRyb2xsZXIudmlld01vZGVsW3RoaXMuYXR0cmlidXRlXSA9IGhyZWY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZSwgaHJlZik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcmV0dXJuaW5nIG51bGwgdG8gYXZvaWQgQmx1ZWJpcmQgd2FybmluZ1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQGludGVybmFsIEFjdGl2ZWx5IGF2b2lkIHVzaW5nIGRlY29yYXRvciB0byByZWR1Y2UgdGhlIGFtb3VudCBvZiBjb2RlIGdlbmVyYXRlZFxyXG4gKi9cclxuUm91dGVIcmVmLiRyZXNvdXJjZSA9IHtcclxuICAgIHR5cGU6ICdhdHRyaWJ1dGUnLFxyXG4gICAgbmFtZTogJ3JvdXRlLWhyZWYnLFxyXG4gICAgYmluZGFibGVzOiBbXHJcbiAgICAgICAgeyBuYW1lOiAncm91dGUnLCBjaGFuZ2VIYW5kbGVyOiAncHJvY2Vzc0NoYW5nZScsIHByaW1hcnlQcm9wZXJ0eTogdHJ1ZSB9LFxyXG4gICAgICAgIHsgbmFtZTogJ3BhcmFtcycsIGNoYW5nZUhhbmRsZXI6ICdwcm9jZXNzQ2hhbmdlJyB9LFxyXG4gICAgICAgICdhdHRyaWJ1dGUnXHJcbiAgICBdIC8vIHR5cGUgZGVmaW5pdGlvbiBvZiBBdXJlbGlhIHRlbXBsYXRpbmcgaXMgd3JvbmdcclxufTtcblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xyXG4gICAgY29uZmlnXHJcbiAgICAgICAgLnNpbmdsZXRvbihSb3V0ZUxvYWRlciwgVGVtcGxhdGluZ1JvdXRlTG9hZGVyKVxyXG4gICAgICAgIC5zaW5nbGV0b24oUm91dGVyLCBBcHBSb3V0ZXIpXHJcbiAgICAgICAgLmdsb2JhbFJlc291cmNlcyhSb3V0ZXJWaWV3LCBSb3V0ZUhyZWYpO1xyXG4gICAgY29uZmlnLmNvbnRhaW5lci5yZWdpc3RlckFsaWFzKFJvdXRlciwgQXBwUm91dGVyKTtcclxufVxuXG5leHBvcnQgeyBSb3V0ZUhyZWYsIFJvdXRlclZpZXcsIFRlbXBsYXRpbmdSb3V0ZUxvYWRlciwgY29uZmlndXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///aurelia-templating-router\n");

/***/ })

}]);