<template>
  <require from="./examplecard.css"></require>
  <require from="./slider.css"></require>
  <require from="./examplecard"></require>
  <require from="hljs"></require>
  <require from="highlight.js/styles/dracula.css"></require>
  <require from="./pickers.css"></require>
  

  <div
    class="content"
    style="bottom: unset; top: 0px; background-color: rgb(3, 131, 135);">
    <h1 class="pageTitle">Picker</h1>
    <div
      role="presentation"
      class="ms-FocusZone"
      
    ></div>
  </div>
  <div class="PageSection">
      <examplecard title="Controlled Tag Picker, anything but blue.">
          <div slot="code">
            <hljs language="html" linenumbers="true">
  &#x3C;du-tag-picker  
  on-resolve-suggestions.bind=&#x22;onFilterChanged&#x22; 
  on-item-selected.bind=&#x22;onItemSelected&#x22;
  get-text-from-item.bind=&#x22;getTextFromItem&#x22;
  picker-suggestions-props.one-time=&#x22;{
    suggestionsHeaderText: &#x27;Suggested Tags&#x27;,
    noResultsFoundText: &#x27;No Color Tags Found&#x27;
  }&#x22;
  item-limit=&#x22;8&#x22;
  input-props.bind=&#x22;inputProps&#x22;&#x3E;&#x3C;/du-tag-picker&#x3E;
            </hljs>
            <hljs language="javascript" linenumbers="true">
  import { ITag } from 'office-ui-fabric-react/lib/Pickers';

  const _testTags: ITag[] = [
      'black',
      'blue',
      'brown',
      'cyan',
      'green',
      'magenta',
      'mauve',
      'orange',
      'pink',
      'purple',
      'red',
      'rose',
      'violet',
      'white',
      'yellow'
    ].map(item => ({ key: item, name: item }));

  export class pickers
  {
    public inputProps = {
        onBlur: (ev: any) => console.log('onBlur called'),
        onFocus: (ev: any) => console.log('onFocus called'),
        'aria-label': 'Tag Picker'
      };

    public onFilterChanged( args:any[]): ITag[] 
    {
        let filterText: string = args[0];
        let tagList: ITag[] = args[1];

        let retValue =  filterText
            ? _testTags
                .filter(tag => tag.name.toLowerCase().indexOf(filterText.toLowerCase()) === 0)
                //@ts-ignore
                .filter(tag => !this.parent.listContainsDocument(tag, tagList))
            : [];

        return retValue;
    }

    private listContainsDocument(tag: ITag, tagList?: ITag[]) 
    {
        if (!tagList || !tagList.length || tagList.length === 0) 
        {
            return false;
        }
        return tagList.filter(compareTag => compareTag.key === tag.key).length > 0;
    }



    private onItemSelected(args:any[]): ITag | null
    {
        console.log(this);
        let item: ITag = args[0];

        if(item.key == "blue")
        {
            return null;
        }
        return item;
    }    
  }
            </hljs>
          </div>
          <div slot="example">
            <du-tag-picker  
            on-resolve-suggestions.bind="onFilterChanged" 
            on-item-selected.bind="onItemSelected"
            get-text-from-item.bind="getTextFromItem"
            picker-suggestions-props.one-time="{
              suggestionsHeaderText: 'Suggested Tags',
              noResultsFoundText: 'No Color Tags Found'
            }"
            item-limit="8"
            input-props.bind="inputProps"></du-tag-picker>
          </div>  
    </examplecard>

        <examplecard title="Controlled and items bound Tag Picker, anything but blue.">
                <div slot="code">
                  <hljs language="html" linenumbers="true">
  &#x3C;du-tag-picker  items.bind=&#x22;selectedItems&#x22;
  on-resolve-suggestions.bind=&#x22;onFilterChanged&#x22; on-change.bind=&#x22;onChange&#x22;
  on-item-selected.bind=&#x22;onItemSelected&#x22;
  get-text-from-item.bind=&#x22;getTextFromItem&#x22;
  picker-suggestions-props.one-time=&#x22;{
  suggestionsHeaderText: &#x27;Suggested Tags&#x27;,
  noResultsFoundText: &#x27;No Color Tags Found&#x27;
  }&#x22;
  item-limit=&#x22;8&#x22;
  input-props.bind=&#x22;inputProps&#x22;&#x3E;&#x3C;/du-tag-picker&#x3E;
                  </hljs>
                  <hljs language="javascript">
  public selectedItems: any[] = [];

  public onChange(args:any[])
  {
      this.selectedItems = args[0];
  }
                  </hljs>
                </div>
                <div slot="example">
                  <du-tag-picker  items.bind="selectedItems"
                  on-resolve-suggestions.bind="onFilterChanged" on-change.bind="onChange"
                  on-item-selected.bind="onItemSelected"
          get-text-from-item.bind="getTextFromItem"
          picker-suggestions-props.one-time="{
            suggestionsHeaderText: 'Suggested Tags',
            noResultsFoundText: 'No Color Tags Found'
          }"
          item-limit="8"
          input-props.bind="inputProps"></du-tag-picker>
                </div>  
          </examplecard>


  </div>
</template>
